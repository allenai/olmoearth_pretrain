nohup: ignoring input
Matplotlib is building the font cache; this may take a moment.
2025-08-17 13:29:29.770	saturn-cs-aus-233.reviz.ai2.in:0	olmo_core.utils:200	INFO	Setting env var 'OMP_NUM_THREADS' to '8'
2025-08-17 13:29:29.770	saturn-cs-aus-233.reviz.ai2.in:0	olmo_core.utils:200	INFO	Setting env var 'TOKENIZERS_PARALLELISM' to 'false'
2025-08-17 13:29:29.770	saturn-cs-aus-233.reviz.ai2.in:0	helios.internal.experiment:135	INFO	Common overrides: []
2025-08-17 13:29:29.790	saturn-cs-aus-233.reviz.ai2.in:0	helios.internal.experiment:137	INFO	Common: CommonComponents(run_name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.0001', save_folder='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.0001', launch=HeliosBeakerLaunchConfig(name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.0001-train-b34c4289', cmd=['scripts/2025_07_21_add_era5/eval.py', 'train', 'latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.0001', 'ai2/saturn-cirrascale', '--launch.priority=high', '--trainer.callbacks.downstream_evaluator.tasks.m-cashew-plant.probe_lr=0.0001', '--trainer.callbacks.downstream_evaluator.tasks.mados.probe_lr=0.0001', '--trainer.callbacks.downstream_evaluator.tasks.sen1floods11.probe_lr=0.0001', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel2.probe_lr=0.0001', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1.probe_lr=0.0001', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1_sentinel2.probe_lr=0.0001', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1.probe_lr=0.0001', '--trainer.callbacks.downstream_evaluator.tasks.sickle_landsat.probe_lr=0.0001', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1_landsat.probe_lr=0.0001', '--trainer.callbacks.downstream_evaluator.tasks.breizhcrops.probe_lr=0.0001', '--trainer.load_path=/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets/step200000', '--launch.task_name=eval'], budget='ai2/es-platform', task_name='train', workspace='ai2/earth-systems', description=None, setup_steps=['echo "$GCP_CREDENTIALS" > $GOOGLE_APPLICATION_CREDENTIALS', 'conda install gh --channel conda-forge', 'gh auth status', 'gh repo clone $REPO_URL .', 'git checkout "$GIT_REF"', 'git submodule update --init --recursive', 'conda shell.bash activate base', "pip install -e '.[all]'", '', 'pip freeze'], beaker_image='petew/olmo-core-tch270cu128', num_nodes=1, num_gpus=1, shared_memory='256GiB', clusters=['ai2/saturn-cirrascale'], shared_filesystem=True, priority=<Priority.high: 'high'>, preemptible=True, retries=None, env_vars=[BeakerEnvVar(name='NCCL_DEBUG', value='WARN'), BeakerEnvVar(name='TORCH_NCCL_TRACE_BUFFER_SIZE', value='0'), BeakerEnvVar(name='NCCL_BLOCKING_WAIT', value='0'), BeakerEnvVar(name='GOOGLE_APPLICATION_CREDENTIALS', value='/etc/gcp_credentials.json')], env_secrets=[BeakerEnvSecret(name='BEAKER_TOKEN', secret='yawenzzzz_BEAKER_TOKEN'), BeakerEnvSecret(name='WANDB_API_KEY', secret='yawenzzzz_WANDB_API_KEY'), BeakerEnvSecret(name='GITHUB_TOKEN', secret='yawenzzzz_GITHUB_TOKEN'), BeakerEnvSecret(name='GCP_CREDENTIALS', secret='HELIOS_GCP_CREDENTIALS')], nfs=False, weka_buckets=[BeakerWekaBucket(bucket='dfive-default', mount='/weka/dfive-default')], allow_dirty=False, host_networking=None, git=GitConfig(repo_url='https://github.com/allenai/helios', ref='ad34f8d9cc3af2794e41b5c6cdddefdba216e57d', branch=None), hostnames=None), training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dataset_percentage=1.0, nccl_debug=False)
2025-08-17 13:29:29.792	saturn-cs-aus-233.reviz.ai2.in:0	helios.internal.experiment:156	INFO	Overrides: ['--launch.priority=high', '--trainer.callbacks.downstream_evaluator.tasks.m-cashew-plant.probe_lr=0.0001', '--trainer.callbacks.downstream_evaluator.tasks.mados.probe_lr=0.0001', '--trainer.callbacks.downstream_evaluator.tasks.sen1floods11.probe_lr=0.0001', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel2.probe_lr=0.0001', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1.probe_lr=0.0001', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1_sentinel2.probe_lr=0.0001', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1.probe_lr=0.0001', '--trainer.callbacks.downstream_evaluator.tasks.sickle_landsat.probe_lr=0.0001', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1_landsat.probe_lr=0.0001', '--trainer.callbacks.downstream_evaluator.tasks.breizhcrops.probe_lr=0.0001', '--trainer.load_path=/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets/step200000', '--launch.task_name=eval']
HeliosExperimentConfig(run_name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.0001', launch=HeliosBeakerLaunchConfig(name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.0001-train-b34c4289', cmd=['scripts/2025_07_21_add_era5/eval.py', 'train', 'latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.0001', 'ai2/saturn-cirrascale', '--launch.priority=high', '--trainer.callbacks.downstream_evaluator.tasks.m-cashew-plant.probe_lr=0.0001', '--trainer.callbacks.downstream_evaluator.tasks.mados.probe_lr=0.0001', '--trainer.callbacks.downstream_evaluator.tasks.sen1floods11.probe_lr=0.0001', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel2.probe_lr=0.0001', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1.probe_lr=0.0001', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1_sentinel2.probe_lr=0.0001', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1.probe_lr=0.0001', '--trainer.callbacks.downstream_evaluator.tasks.sickle_landsat.probe_lr=0.0001', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1_landsat.probe_lr=0.0001', '--trainer.callbacks.downstream_evaluator.tasks.breizhcrops.probe_lr=0.0001', '--trainer.load_path=/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets/step200000', '--launch.task_name=eval'], budget='ai2/es-platform', task_name='eval', workspace='ai2/earth-systems', description=None, setup_steps=['echo "$GCP_CREDENTIALS" > $GOOGLE_APPLICATION_CREDENTIALS', 'conda install gh --channel conda-forge', 'gh auth status', 'gh repo clone $REPO_URL .', 'git checkout "$GIT_REF"', 'git submodule update --init --recursive', 'conda shell.bash activate base', "pip install -e '.[all]'", '', 'pip freeze'], beaker_image='petew/olmo-core-tch270cu128', num_nodes=1, num_gpus=1, shared_memory='256GiB', clusters=['ai2/saturn-cirrascale'], shared_filesystem=True, priority=<Priority.high: 'high'>, preemptible=True, retries=None, env_vars=[BeakerEnvVar(name='NCCL_DEBUG', value='WARN'), BeakerEnvVar(name='TORCH_NCCL_TRACE_BUFFER_SIZE', value='0'), BeakerEnvVar(name='NCCL_BLOCKING_WAIT', value='0'), BeakerEnvVar(name='GOOGLE_APPLICATION_CREDENTIALS', value='/etc/gcp_credentials.json')], env_secrets=[BeakerEnvSecret(name='BEAKER_TOKEN', secret='yawenzzzz_BEAKER_TOKEN'), BeakerEnvSecret(name='WANDB_API_KEY', secret='yawenzzzz_WANDB_API_KEY'), BeakerEnvSecret(name='GITHUB_TOKEN', secret='yawenzzzz_GITHUB_TOKEN'), BeakerEnvSecret(name='GCP_CREDENTIALS', secret='HELIOS_GCP_CREDENTIALS')], nfs=False, weka_buckets=[BeakerWekaBucket(bucket='dfive-default', mount='/weka/dfive-default')], allow_dirty=False, host_networking=None, git=GitConfig(repo_url='https://github.com/allenai/helios', ref='ad34f8d9cc3af2794e41b5c6cdddefdba216e57d', branch=None), hostnames=None), model=LatentMIMConfig(encoder_config=EncoderConfig(supported_modality_names=['sentinel2_l2a', 'sentinel1', 'landsat'], embedding_size=768, max_patch_size=8, min_patch_size=1, num_heads=12, mlp_ratio=4.0, depth=12, drop_path=0.1, max_sequence_length=12, learnable_channel_embeddings=True, random_channel_embeddings=False, num_projection_layers=1, aggregate_then_project=True, use_flash_attn=False, frozen_patch_embeddings=False, qk_norm=False), decoder_config=PredictorConfig(supported_modality_names=['sentinel2_l2a', 'sentinel1', 'landsat'], encoder_embedding_size=768, decoder_embedding_size=768, depth=4, mlp_ratio=4.0, num_heads=12, max_sequence_length=12, drop_path=0.0, learnable_channel_embeddings=True, random_channel_embeddings=False, output_embedding_size=None, use_flash_attn=False, qk_norm=False), reconstructor_config=None), dataset=HeliosConcatDatasetConfig(dataset_configs=[HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/presto/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/469728', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/osm_sampling/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/1138828', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/osmbig/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/1291656', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/presto_neighbor/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/3507008', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/worldcover_sampling/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/5662848', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0)]), data_loader=HeliosDataLoaderConfig(work_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.0001', global_batch_size=512, min_patch_size=1, max_patch_size=8, sampled_hw_p_list=[5, 6, 7, 8, 9, 10, 11, 12], seed=3622, token_budget=1500, shuffle=True, num_workers=16, prefetch_factor=4, target_device_type=None, drop_last=True, num_dataset_repeats_per_epoch=1), train_module=ContrastiveLatentMIMTrainModuleConfig(optim_config=AdamWConfig(group_overrides=None, compile=False, fixed_fields=['initial_lr'], lr=0.0001, betas=[0.9, 0.999], eps=1e-08, weight_decay=0.02, foreach=None, fused=True), rank_microbatch_size=64, transform_config=TransformConfig(transform_type='flip_and_rotate', transform_kwargs={}), compile_model=False, dp_config=DataParallelConfig(name='fsdp', param_dtype='bfloat16', reduce_dtype='float32', num_replicas=None, shard_degree=None), compile_loss=False, autocast_precision=None, max_grad_norm=1.0, scheduler=CosWithWarmup(lr_field='lr', initial_lr_field='initial_lr', warmup_steps=8000, warmup_fraction=None, alpha_f=0.1, t_max=None, warmup_min_lr=0.0), find_unused_parameters=True, state_dict_save_opts=None, state_dict_load_opts=None, regularizer_config=None, loss_config=LossConfig(loss_config={'type': 'modality_patch_discrimination_new', 'tau': 0.1}), mae_loss_config=None, masking_config=MaskingConfig(strategy_config={'type': 'modality_cross_random', 'encode_ratio': 0.5, 'decode_ratio': 0.5, 'allow_encoding_decoding_same_bandset': True}), token_exit_cfg={'sentinel2_l2a': 0, 'sentinel1': 0, 'landsat': 0}, ema_decay=[1.0, 1.0], contrastive_config=LossConfig(loss_config={'type': 'InfoNCE', 'weight': 0.1})), trainer=TrainerConfig(save_folder='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.0001', work_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.0001', load_path='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets/step200000', load_strategy='if_available', checkpointer=CheckpointerConfig(work_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.0001', save_overwrite=None, pre_download=False, save_thread_count=None, load_thread_count=None, throttle_uploads=False), device=None, save_overwrite=False, max_duration=Duration(value=300, unit='epochs'), cancel_check_interval=1, hard_stop=None, metrics_collect_interval=10, callbacks={'wandb': HeliosWandBCallback(enabled=True, name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.0001', project='2025_08_17_contrastive_eval', entity='eai-ai2', group=None, tags=None, notes=None, config=None, cancel_tags=['cancel', 'canceled', 'cancelled'], cancel_check_interval=None, upload_dataset_distribution_pre_train=True, upload_modality_data_band_distribution_pre_train=False, restart_on_same_run=True), 'speed_monitor': HeliosSpeedMonitorCallback(num_flops_per_token=None, device_peak_flops=None, _total_steps=0, _total_tokens=0, _start_time=0.0, _first_step=True, _step_last_logged=0.0, _batch_load_start=0.0, _batch_load_time=0.0, _step_tokens=0, _step_seq_len=0, _parallel_degree=1, _bps_avg=None), 'gpu_memory_monitor': GPUMemoryMonitorCallback(device_id=None, _num_alloc_retries=0), 'config_saver': ConfigSaverCallback(config=None, fname='config.json', save_data_paths=None, data_paths_fname=None), 'downstream_evaluator': DownstreamEvaluatorCallbackConfig(tasks={'m-eurosat': DownstreamTaskConfig(dataset='m-eurosat', embedding_batch_size=128, num_workers=0, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm-bigearthnet': DownstreamTaskConfig(dataset='m-bigearthnet', embedding_batch_size=64, num_workers=4, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm-so2sat': DownstreamTaskConfig(dataset='m-so2sat', embedding_batch_size=128, num_workers=4, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm-brick-kiln': DownstreamTaskConfig(dataset='m-brick-kiln', embedding_batch_size=128, num_workers=4, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'mados': DownstreamTaskConfig(dataset='mados', embedding_batch_size=128, num_workers=8, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=False, input_modalities=[], probe_lr=0.0001, patch_size=4, probe_batch_size=128, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sen1floods11': DownstreamTaskConfig(dataset='sen1floods11', embedding_batch_size=128, num_workers=8, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.0001, patch_size=4, probe_batch_size=128, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sickle_sentinel1': DownstreamTaskConfig(dataset='sickle', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1'], probe_lr=0.0001, patch_size=4, probe_batch_size=16, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sickle_landsat': DownstreamTaskConfig(dataset='sickle', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['landsat'], probe_lr=0.0001, patch_size=4, probe_batch_size=16, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sickle_sentinel1_landsat': DownstreamTaskConfig(dataset='sickle', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1', 'landsat'], probe_lr=0.0001, patch_size=4, probe_batch_size=16, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm_sa_crop_type': DownstreamTaskConfig(dataset='m-sa-crop-type', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.1, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm_cashew_plant': DownstreamTaskConfig(dataset='m-cashew-plant', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.0001, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'pastis_sentinel2': DownstreamTaskConfig(dataset='pastis', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel2_l2a'], probe_lr=0.0001, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=50, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'pastis_sentinel1': DownstreamTaskConfig(dataset='pastis', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1'], probe_lr=0.0001, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=50, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'pastis_sentinel1_sentinel2': DownstreamTaskConfig(dataset='pastis', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1', 'sentinel2_l2a'], probe_lr=0.0001, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=20, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'breizhcrops': DownstreamTaskConfig(dataset='breizhcrops', embedding_batch_size=128, num_workers=8, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.0001, patch_size=1, probe_batch_size=128, epochs=50, eval_interval=Duration(value=50, unit='epochs'), eval_mode='linear_probe', probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP')}, enabled=True, eval_on_startup=True, cancel_after_first_eval=True), 'garbage_collector': GarbageCollectorCallback(gc_interval=1, enabled=True, _start_state=None), 'beaker': BeakerCallback(experiment_id=None, update_interval=None, description=None, enabled=None, _last_update=None), 'checkpointer': CheckpointerCallback(save_interval=5000, ephemeral_save_interval=250, pre_train_checkpoint=None, save_async=None, remove='ephemeral_only', enabled=True, _latest_checkpoint_step=-1, _latest_checkpoint_path='', _checkpoints=[], _ephemeral_checkpoints=[], _checkpoints_to_remove=[])}, async_bookkeeping=None, no_checkpoints=False, no_evals=False), visualize=HeliosVisualizeConfig(output_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.0001/visualizations', num_samples=None, global_step=None, std_multiplier=2.0), init_seed=12536)
2025-08-17 13:29:29.931	saturn-cs-aus-233.reviz.ai2.in:0	helios.internal.experiment:210	INFO	Launching the experiment
2025-08-17 13:29:29.931	saturn-cs-aus-233.reviz.ai2.in:0	helios.internal.experiment:211	INFO	HeliosExperimentConfig(run_name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.0001', launch=HeliosBeakerLaunchConfig(name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.0001-train-b34c4289', cmd=['scripts/2025_07_21_add_era5/eval.py', 'train', 'latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.0001', 'ai2/saturn-cirrascale', '--launch.priority=high', '--trainer.callbacks.downstream_evaluator.tasks.m-cashew-plant.probe_lr=0.0001', '--trainer.callbacks.downstream_evaluator.tasks.mados.probe_lr=0.0001', '--trainer.callbacks.downstream_evaluator.tasks.sen1floods11.probe_lr=0.0001', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel2.probe_lr=0.0001', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1.probe_lr=0.0001', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1_sentinel2.probe_lr=0.0001', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1.probe_lr=0.0001', '--trainer.callbacks.downstream_evaluator.tasks.sickle_landsat.probe_lr=0.0001', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1_landsat.probe_lr=0.0001', '--trainer.callbacks.downstream_evaluator.tasks.breizhcrops.probe_lr=0.0001', '--trainer.load_path=/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets/step200000', '--launch.task_name=eval'], budget='ai2/es-platform', task_name='eval', workspace='ai2/earth-systems', description=None, setup_steps=['echo "$GCP_CREDENTIALS" > $GOOGLE_APPLICATION_CREDENTIALS', 'conda install gh --channel conda-forge', 'gh auth status', 'gh repo clone $REPO_URL .', 'git checkout "$GIT_REF"', 'git submodule update --init --recursive', 'conda shell.bash activate base', "pip install -e '.[all]'", '', 'pip freeze'], beaker_image='petew/olmo-core-tch270cu128', num_nodes=1, num_gpus=1, shared_memory='256GiB', clusters=['ai2/saturn-cirrascale'], shared_filesystem=True, priority=<Priority.high: 'high'>, preemptible=True, retries=None, env_vars=[BeakerEnvVar(name='NCCL_DEBUG', value='WARN'), BeakerEnvVar(name='TORCH_NCCL_TRACE_BUFFER_SIZE', value='0'), BeakerEnvVar(name='NCCL_BLOCKING_WAIT', value='0'), BeakerEnvVar(name='GOOGLE_APPLICATION_CREDENTIALS', value='/etc/gcp_credentials.json')], env_secrets=[BeakerEnvSecret(name='BEAKER_TOKEN', secret='yawenzzzz_BEAKER_TOKEN'), BeakerEnvSecret(name='WANDB_API_KEY', secret='yawenzzzz_WANDB_API_KEY'), BeakerEnvSecret(name='GITHUB_TOKEN', secret='yawenzzzz_GITHUB_TOKEN'), BeakerEnvSecret(name='GCP_CREDENTIALS', secret='HELIOS_GCP_CREDENTIALS')], nfs=False, weka_buckets=[BeakerWekaBucket(bucket='dfive-default', mount='/weka/dfive-default')], allow_dirty=False, host_networking=None, git=GitConfig(repo_url='https://github.com/allenai/helios', ref='ad34f8d9cc3af2794e41b5c6cdddefdba216e57d', branch=None), hostnames=None), model=LatentMIMConfig(encoder_config=EncoderConfig(supported_modality_names=['sentinel2_l2a', 'sentinel1', 'landsat'], embedding_size=768, max_patch_size=8, min_patch_size=1, num_heads=12, mlp_ratio=4.0, depth=12, drop_path=0.1, max_sequence_length=12, learnable_channel_embeddings=True, random_channel_embeddings=False, num_projection_layers=1, aggregate_then_project=True, use_flash_attn=False, frozen_patch_embeddings=False, qk_norm=False), decoder_config=PredictorConfig(supported_modality_names=['sentinel2_l2a', 'sentinel1', 'landsat'], encoder_embedding_size=768, decoder_embedding_size=768, depth=4, mlp_ratio=4.0, num_heads=12, max_sequence_length=12, drop_path=0.0, learnable_channel_embeddings=True, random_channel_embeddings=False, output_embedding_size=None, use_flash_attn=False, qk_norm=False), reconstructor_config=None), dataset=HeliosConcatDatasetConfig(dataset_configs=[HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/presto/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/469728', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/osm_sampling/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/1138828', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/osmbig/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/1291656', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/presto_neighbor/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/3507008', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/worldcover_sampling/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/5662848', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0)]), data_loader=HeliosDataLoaderConfig(work_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.0001', global_batch_size=512, min_patch_size=1, max_patch_size=8, sampled_hw_p_list=[5, 6, 7, 8, 9, 10, 11, 12], seed=3622, token_budget=1500, shuffle=True, num_workers=16, prefetch_factor=4, target_device_type=None, drop_last=True, num_dataset_repeats_per_epoch=1), train_module=ContrastiveLatentMIMTrainModuleConfig(optim_config=AdamWConfig(group_overrides=None, compile=False, fixed_fields=['initial_lr'], lr=0.0001, betas=[0.9, 0.999], eps=1e-08, weight_decay=0.02, foreach=None, fused=True), rank_microbatch_size=64, transform_config=TransformConfig(transform_type='flip_and_rotate', transform_kwargs={}), compile_model=False, dp_config=DataParallelConfig(name='fsdp', param_dtype='bfloat16', reduce_dtype='float32', num_replicas=None, shard_degree=None), compile_loss=False, autocast_precision=None, max_grad_norm=1.0, scheduler=CosWithWarmup(lr_field='lr', initial_lr_field='initial_lr', warmup_steps=8000, warmup_fraction=None, alpha_f=0.1, t_max=None, warmup_min_lr=0.0), find_unused_parameters=True, state_dict_save_opts=None, state_dict_load_opts=None, regularizer_config=None, loss_config=LossConfig(loss_config={'type': 'modality_patch_discrimination_new', 'tau': 0.1}), mae_loss_config=None, masking_config=MaskingConfig(strategy_config={'type': 'modality_cross_random', 'encode_ratio': 0.5, 'decode_ratio': 0.5, 'allow_encoding_decoding_same_bandset': True}), token_exit_cfg={'sentinel2_l2a': 0, 'sentinel1': 0, 'landsat': 0}, ema_decay=[1.0, 1.0], contrastive_config=LossConfig(loss_config={'type': 'InfoNCE', 'weight': 0.1})), trainer=TrainerConfig(save_folder='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.0001', work_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.0001', load_path='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets/step200000', load_strategy='if_available', checkpointer=CheckpointerConfig(work_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.0001', save_overwrite=None, pre_download=False, save_thread_count=None, load_thread_count=None, throttle_uploads=False), device=None, save_overwrite=False, max_duration=Duration(value=300, unit='epochs'), cancel_check_interval=1, hard_stop=None, metrics_collect_interval=10, callbacks={'wandb': HeliosWandBCallback(enabled=True, name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.0001', project='2025_08_17_contrastive_eval', entity='eai-ai2', group=None, tags=None, notes=None, config=None, cancel_tags=['cancel', 'canceled', 'cancelled'], cancel_check_interval=None, upload_dataset_distribution_pre_train=True, upload_modality_data_band_distribution_pre_train=False, restart_on_same_run=True), 'speed_monitor': HeliosSpeedMonitorCallback(num_flops_per_token=None, device_peak_flops=None, _total_steps=0, _total_tokens=0, _start_time=0.0, _first_step=True, _step_last_logged=0.0, _batch_load_start=0.0, _batch_load_time=0.0, _step_tokens=0, _step_seq_len=0, _parallel_degree=1, _bps_avg=None), 'gpu_memory_monitor': GPUMemoryMonitorCallback(device_id=None, _num_alloc_retries=0), 'config_saver': ConfigSaverCallback(config=None, fname='config.json', save_data_paths=None, data_paths_fname=None), 'downstream_evaluator': DownstreamEvaluatorCallbackConfig(tasks={'m-eurosat': DownstreamTaskConfig(dataset='m-eurosat', embedding_batch_size=128, num_workers=0, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm-bigearthnet': DownstreamTaskConfig(dataset='m-bigearthnet', embedding_batch_size=64, num_workers=4, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm-so2sat': DownstreamTaskConfig(dataset='m-so2sat', embedding_batch_size=128, num_workers=4, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm-brick-kiln': DownstreamTaskConfig(dataset='m-brick-kiln', embedding_batch_size=128, num_workers=4, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'mados': DownstreamTaskConfig(dataset='mados', embedding_batch_size=128, num_workers=8, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=False, input_modalities=[], probe_lr=0.0001, patch_size=4, probe_batch_size=128, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sen1floods11': DownstreamTaskConfig(dataset='sen1floods11', embedding_batch_size=128, num_workers=8, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.0001, patch_size=4, probe_batch_size=128, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sickle_sentinel1': DownstreamTaskConfig(dataset='sickle', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1'], probe_lr=0.0001, patch_size=4, probe_batch_size=16, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sickle_landsat': DownstreamTaskConfig(dataset='sickle', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['landsat'], probe_lr=0.0001, patch_size=4, probe_batch_size=16, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sickle_sentinel1_landsat': DownstreamTaskConfig(dataset='sickle', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1', 'landsat'], probe_lr=0.0001, patch_size=4, probe_batch_size=16, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm_sa_crop_type': DownstreamTaskConfig(dataset='m-sa-crop-type', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.1, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm_cashew_plant': DownstreamTaskConfig(dataset='m-cashew-plant', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.0001, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'pastis_sentinel2': DownstreamTaskConfig(dataset='pastis', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel2_l2a'], probe_lr=0.0001, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=50, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'pastis_sentinel1': DownstreamTaskConfig(dataset='pastis', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1'], probe_lr=0.0001, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=50, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'pastis_sentinel1_sentinel2': DownstreamTaskConfig(dataset='pastis', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1', 'sentinel2_l2a'], probe_lr=0.0001, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=20, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'breizhcrops': DownstreamTaskConfig(dataset='breizhcrops', embedding_batch_size=128, num_workers=8, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.0001, patch_size=1, probe_batch_size=128, epochs=50, eval_interval=Duration(value=50, unit='epochs'), eval_mode='linear_probe', probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP')}, enabled=True, eval_on_startup=True, cancel_after_first_eval=True), 'garbage_collector': GarbageCollectorCallback(gc_interval=1, enabled=True, _start_state=None), 'beaker': BeakerCallback(experiment_id=None, update_interval=None, description=None, enabled=None, _last_update=None), 'checkpointer': CheckpointerCallback(save_interval=5000, ephemeral_save_interval=250, pre_train_checkpoint=None, save_async=None, remove='ephemeral_only', enabled=True, _latest_checkpoint_step=-1, _latest_checkpoint_path='', _checkpoints=[], _ephemeral_checkpoints=[], _checkpoints_to_remove=[])}, async_bookkeeping=None, no_checkpoints=False, no_evals=False), visualize=HeliosVisualizeConfig(output_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.0001/visualizations', num_samples=None, global_step=None, std_multiplier=2.0), init_seed=12536)
2025-08-17 13:29:31.275	saturn-cs-aus-233.reviz.ai2.in:0	py.warnings:109	WARNING	/weka/dfive-default/yawenz/.venv-helios-py310/lib/python3.10/site-packages/beaker/util.py:25: RuntimeWarning: Found unknown field 'budget: 01HPM52AQC6C0TZV32E7WDDGDJ' for data model 'Workspace'. This may be a newly added field that hasn't been defined in beaker-py yet. Please submit an issue report about this here:
https://github.com/allenai/beaker-py/issues/new?assignees=&labels=bug&template=bug_report.yml
  warnings.warn(

2025-08-17 13:29:32.915	saturn-cs-aus-233.reviz.ai2.in:0	py.warnings:109	WARNING	/weka/dfive-default/yawenz/.venv-helios-py310/lib/python3.10/site-packages/beaker/client.py:163: UserWarning: You're using beaker-py v1.34.1, but a newer version (v1.36.4) is available.

Please upgrade with `pip install --upgrade beaker-py`.

You can find the release notes for v1.36.4 at https://github.com/allenai/beaker-py/releases/tag/v1.36.4

  warnings.warn(

2025-08-17 13:29:36.568	saturn-cs-aus-233.reviz.ai2.in:0	olmo_core.launch.beaker:513	INFO	Experiment submitted, see progress at https://beaker.org/ex/01K2WVJA0RZ83SSJG9RJ79FX54
2025-08-17 13:29:48.404	saturn-cs-aus-233.reviz.ai2.in:0	olmo_core.utils:200	INFO	Setting env var 'OMP_NUM_THREADS' to '8'
2025-08-17 13:29:48.404	saturn-cs-aus-233.reviz.ai2.in:0	olmo_core.utils:200	INFO	Setting env var 'TOKENIZERS_PARALLELISM' to 'false'
2025-08-17 13:29:48.404	saturn-cs-aus-233.reviz.ai2.in:0	helios.internal.experiment:135	INFO	Common overrides: []
2025-08-17 13:29:48.423	saturn-cs-aus-233.reviz.ai2.in:0	helios.internal.experiment:137	INFO	Common: CommonComponents(run_name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.0005', save_folder='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.0005', launch=HeliosBeakerLaunchConfig(name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.0005-train-87c52ff4', cmd=['scripts/2025_07_21_add_era5/eval.py', 'train', 'latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.0005', 'ai2/saturn-cirrascale', '--launch.priority=high', '--trainer.callbacks.downstream_evaluator.tasks.m-cashew-plant.probe_lr=0.0005', '--trainer.callbacks.downstream_evaluator.tasks.mados.probe_lr=0.0005', '--trainer.callbacks.downstream_evaluator.tasks.sen1floods11.probe_lr=0.0005', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel2.probe_lr=0.0005', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1.probe_lr=0.0005', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1_sentinel2.probe_lr=0.0005', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1.probe_lr=0.0005', '--trainer.callbacks.downstream_evaluator.tasks.sickle_landsat.probe_lr=0.0005', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1_landsat.probe_lr=0.0005', '--trainer.callbacks.downstream_evaluator.tasks.breizhcrops.probe_lr=0.0005', '--trainer.load_path=/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets/step200000', '--launch.task_name=eval'], budget='ai2/es-platform', task_name='train', workspace='ai2/earth-systems', description=None, setup_steps=['echo "$GCP_CREDENTIALS" > $GOOGLE_APPLICATION_CREDENTIALS', 'conda install gh --channel conda-forge', 'gh auth status', 'gh repo clone $REPO_URL .', 'git checkout "$GIT_REF"', 'git submodule update --init --recursive', 'conda shell.bash activate base', "pip install -e '.[all]'", '', 'pip freeze'], beaker_image='petew/olmo-core-tch270cu128', num_nodes=1, num_gpus=1, shared_memory='256GiB', clusters=['ai2/saturn-cirrascale'], shared_filesystem=True, priority=<Priority.high: 'high'>, preemptible=True, retries=None, env_vars=[BeakerEnvVar(name='NCCL_DEBUG', value='WARN'), BeakerEnvVar(name='TORCH_NCCL_TRACE_BUFFER_SIZE', value='0'), BeakerEnvVar(name='NCCL_BLOCKING_WAIT', value='0'), BeakerEnvVar(name='GOOGLE_APPLICATION_CREDENTIALS', value='/etc/gcp_credentials.json')], env_secrets=[BeakerEnvSecret(name='BEAKER_TOKEN', secret='yawenzzzz_BEAKER_TOKEN'), BeakerEnvSecret(name='WANDB_API_KEY', secret='yawenzzzz_WANDB_API_KEY'), BeakerEnvSecret(name='GITHUB_TOKEN', secret='yawenzzzz_GITHUB_TOKEN'), BeakerEnvSecret(name='GCP_CREDENTIALS', secret='HELIOS_GCP_CREDENTIALS')], nfs=False, weka_buckets=[BeakerWekaBucket(bucket='dfive-default', mount='/weka/dfive-default')], allow_dirty=False, host_networking=None, git=GitConfig(repo_url='https://github.com/allenai/helios', ref='ad34f8d9cc3af2794e41b5c6cdddefdba216e57d', branch=None), hostnames=None), training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dataset_percentage=1.0, nccl_debug=False)
2025-08-17 13:29:48.428	saturn-cs-aus-233.reviz.ai2.in:0	helios.internal.experiment:156	INFO	Overrides: ['--launch.priority=high', '--trainer.callbacks.downstream_evaluator.tasks.m-cashew-plant.probe_lr=0.0005', '--trainer.callbacks.downstream_evaluator.tasks.mados.probe_lr=0.0005', '--trainer.callbacks.downstream_evaluator.tasks.sen1floods11.probe_lr=0.0005', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel2.probe_lr=0.0005', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1.probe_lr=0.0005', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1_sentinel2.probe_lr=0.0005', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1.probe_lr=0.0005', '--trainer.callbacks.downstream_evaluator.tasks.sickle_landsat.probe_lr=0.0005', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1_landsat.probe_lr=0.0005', '--trainer.callbacks.downstream_evaluator.tasks.breizhcrops.probe_lr=0.0005', '--trainer.load_path=/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets/step200000', '--launch.task_name=eval']
HeliosExperimentConfig(run_name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.0005', launch=HeliosBeakerLaunchConfig(name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.0005-train-87c52ff4', cmd=['scripts/2025_07_21_add_era5/eval.py', 'train', 'latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.0005', 'ai2/saturn-cirrascale', '--launch.priority=high', '--trainer.callbacks.downstream_evaluator.tasks.m-cashew-plant.probe_lr=0.0005', '--trainer.callbacks.downstream_evaluator.tasks.mados.probe_lr=0.0005', '--trainer.callbacks.downstream_evaluator.tasks.sen1floods11.probe_lr=0.0005', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel2.probe_lr=0.0005', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1.probe_lr=0.0005', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1_sentinel2.probe_lr=0.0005', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1.probe_lr=0.0005', '--trainer.callbacks.downstream_evaluator.tasks.sickle_landsat.probe_lr=0.0005', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1_landsat.probe_lr=0.0005', '--trainer.callbacks.downstream_evaluator.tasks.breizhcrops.probe_lr=0.0005', '--trainer.load_path=/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets/step200000', '--launch.task_name=eval'], budget='ai2/es-platform', task_name='eval', workspace='ai2/earth-systems', description=None, setup_steps=['echo "$GCP_CREDENTIALS" > $GOOGLE_APPLICATION_CREDENTIALS', 'conda install gh --channel conda-forge', 'gh auth status', 'gh repo clone $REPO_URL .', 'git checkout "$GIT_REF"', 'git submodule update --init --recursive', 'conda shell.bash activate base', "pip install -e '.[all]'", '', 'pip freeze'], beaker_image='petew/olmo-core-tch270cu128', num_nodes=1, num_gpus=1, shared_memory='256GiB', clusters=['ai2/saturn-cirrascale'], shared_filesystem=True, priority=<Priority.high: 'high'>, preemptible=True, retries=None, env_vars=[BeakerEnvVar(name='NCCL_DEBUG', value='WARN'), BeakerEnvVar(name='TORCH_NCCL_TRACE_BUFFER_SIZE', value='0'), BeakerEnvVar(name='NCCL_BLOCKING_WAIT', value='0'), BeakerEnvVar(name='GOOGLE_APPLICATION_CREDENTIALS', value='/etc/gcp_credentials.json')], env_secrets=[BeakerEnvSecret(name='BEAKER_TOKEN', secret='yawenzzzz_BEAKER_TOKEN'), BeakerEnvSecret(name='WANDB_API_KEY', secret='yawenzzzz_WANDB_API_KEY'), BeakerEnvSecret(name='GITHUB_TOKEN', secret='yawenzzzz_GITHUB_TOKEN'), BeakerEnvSecret(name='GCP_CREDENTIALS', secret='HELIOS_GCP_CREDENTIALS')], nfs=False, weka_buckets=[BeakerWekaBucket(bucket='dfive-default', mount='/weka/dfive-default')], allow_dirty=False, host_networking=None, git=GitConfig(repo_url='https://github.com/allenai/helios', ref='ad34f8d9cc3af2794e41b5c6cdddefdba216e57d', branch=None), hostnames=None), model=LatentMIMConfig(encoder_config=EncoderConfig(supported_modality_names=['sentinel2_l2a', 'sentinel1', 'landsat'], embedding_size=768, max_patch_size=8, min_patch_size=1, num_heads=12, mlp_ratio=4.0, depth=12, drop_path=0.1, max_sequence_length=12, learnable_channel_embeddings=True, random_channel_embeddings=False, num_projection_layers=1, aggregate_then_project=True, use_flash_attn=False, frozen_patch_embeddings=False, qk_norm=False), decoder_config=PredictorConfig(supported_modality_names=['sentinel2_l2a', 'sentinel1', 'landsat'], encoder_embedding_size=768, decoder_embedding_size=768, depth=4, mlp_ratio=4.0, num_heads=12, max_sequence_length=12, drop_path=0.0, learnable_channel_embeddings=True, random_channel_embeddings=False, output_embedding_size=None, use_flash_attn=False, qk_norm=False), reconstructor_config=None), dataset=HeliosConcatDatasetConfig(dataset_configs=[HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/presto/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/469728', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/osm_sampling/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/1138828', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/osmbig/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/1291656', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/presto_neighbor/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/3507008', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/worldcover_sampling/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/5662848', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0)]), data_loader=HeliosDataLoaderConfig(work_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.0005', global_batch_size=512, min_patch_size=1, max_patch_size=8, sampled_hw_p_list=[5, 6, 7, 8, 9, 10, 11, 12], seed=3622, token_budget=1500, shuffle=True, num_workers=16, prefetch_factor=4, target_device_type=None, drop_last=True, num_dataset_repeats_per_epoch=1), train_module=ContrastiveLatentMIMTrainModuleConfig(optim_config=AdamWConfig(group_overrides=None, compile=False, fixed_fields=['initial_lr'], lr=0.0001, betas=[0.9, 0.999], eps=1e-08, weight_decay=0.02, foreach=None, fused=True), rank_microbatch_size=64, transform_config=TransformConfig(transform_type='flip_and_rotate', transform_kwargs={}), compile_model=False, dp_config=DataParallelConfig(name='fsdp', param_dtype='bfloat16', reduce_dtype='float32', num_replicas=None, shard_degree=None), compile_loss=False, autocast_precision=None, max_grad_norm=1.0, scheduler=CosWithWarmup(lr_field='lr', initial_lr_field='initial_lr', warmup_steps=8000, warmup_fraction=None, alpha_f=0.1, t_max=None, warmup_min_lr=0.0), find_unused_parameters=True, state_dict_save_opts=None, state_dict_load_opts=None, regularizer_config=None, loss_config=LossConfig(loss_config={'type': 'modality_patch_discrimination_new', 'tau': 0.1}), mae_loss_config=None, masking_config=MaskingConfig(strategy_config={'type': 'modality_cross_random', 'encode_ratio': 0.5, 'decode_ratio': 0.5, 'allow_encoding_decoding_same_bandset': True}), token_exit_cfg={'sentinel2_l2a': 0, 'sentinel1': 0, 'landsat': 0}, ema_decay=[1.0, 1.0], contrastive_config=LossConfig(loss_config={'type': 'InfoNCE', 'weight': 0.1})), trainer=TrainerConfig(save_folder='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.0005', work_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.0005', load_path='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets/step200000', load_strategy='if_available', checkpointer=CheckpointerConfig(work_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.0005', save_overwrite=None, pre_download=False, save_thread_count=None, load_thread_count=None, throttle_uploads=False), device=None, save_overwrite=False, max_duration=Duration(value=300, unit='epochs'), cancel_check_interval=1, hard_stop=None, metrics_collect_interval=10, callbacks={'wandb': HeliosWandBCallback(enabled=True, name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.0005', project='2025_08_17_contrastive_eval', entity='eai-ai2', group=None, tags=None, notes=None, config=None, cancel_tags=['cancel', 'canceled', 'cancelled'], cancel_check_interval=None, upload_dataset_distribution_pre_train=True, upload_modality_data_band_distribution_pre_train=False, restart_on_same_run=True), 'speed_monitor': HeliosSpeedMonitorCallback(num_flops_per_token=None, device_peak_flops=None, _total_steps=0, _total_tokens=0, _start_time=0.0, _first_step=True, _step_last_logged=0.0, _batch_load_start=0.0, _batch_load_time=0.0, _step_tokens=0, _step_seq_len=0, _parallel_degree=1, _bps_avg=None), 'gpu_memory_monitor': GPUMemoryMonitorCallback(device_id=None, _num_alloc_retries=0), 'config_saver': ConfigSaverCallback(config=None, fname='config.json', save_data_paths=None, data_paths_fname=None), 'downstream_evaluator': DownstreamEvaluatorCallbackConfig(tasks={'m-eurosat': DownstreamTaskConfig(dataset='m-eurosat', embedding_batch_size=128, num_workers=0, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm-bigearthnet': DownstreamTaskConfig(dataset='m-bigearthnet', embedding_batch_size=64, num_workers=4, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm-so2sat': DownstreamTaskConfig(dataset='m-so2sat', embedding_batch_size=128, num_workers=4, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm-brick-kiln': DownstreamTaskConfig(dataset='m-brick-kiln', embedding_batch_size=128, num_workers=4, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'mados': DownstreamTaskConfig(dataset='mados', embedding_batch_size=128, num_workers=8, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=False, input_modalities=[], probe_lr=0.0005, patch_size=4, probe_batch_size=128, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sen1floods11': DownstreamTaskConfig(dataset='sen1floods11', embedding_batch_size=128, num_workers=8, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.0005, patch_size=4, probe_batch_size=128, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sickle_sentinel1': DownstreamTaskConfig(dataset='sickle', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1'], probe_lr=0.0005, patch_size=4, probe_batch_size=16, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sickle_landsat': DownstreamTaskConfig(dataset='sickle', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['landsat'], probe_lr=0.0005, patch_size=4, probe_batch_size=16, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sickle_sentinel1_landsat': DownstreamTaskConfig(dataset='sickle', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1', 'landsat'], probe_lr=0.0005, patch_size=4, probe_batch_size=16, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm_sa_crop_type': DownstreamTaskConfig(dataset='m-sa-crop-type', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.1, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm_cashew_plant': DownstreamTaskConfig(dataset='m-cashew-plant', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.0005, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'pastis_sentinel2': DownstreamTaskConfig(dataset='pastis', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel2_l2a'], probe_lr=0.0005, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=50, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'pastis_sentinel1': DownstreamTaskConfig(dataset='pastis', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1'], probe_lr=0.0005, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=50, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'pastis_sentinel1_sentinel2': DownstreamTaskConfig(dataset='pastis', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1', 'sentinel2_l2a'], probe_lr=0.0005, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=20, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'breizhcrops': DownstreamTaskConfig(dataset='breizhcrops', embedding_batch_size=128, num_workers=8, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.0005, patch_size=1, probe_batch_size=128, epochs=50, eval_interval=Duration(value=50, unit='epochs'), eval_mode='linear_probe', probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP')}, enabled=True, eval_on_startup=True, cancel_after_first_eval=True), 'garbage_collector': GarbageCollectorCallback(gc_interval=1, enabled=True, _start_state=None), 'beaker': BeakerCallback(experiment_id=None, update_interval=None, description=None, enabled=None, _last_update=None), 'checkpointer': CheckpointerCallback(save_interval=5000, ephemeral_save_interval=250, pre_train_checkpoint=None, save_async=None, remove='ephemeral_only', enabled=True, _latest_checkpoint_step=-1, _latest_checkpoint_path='', _checkpoints=[], _ephemeral_checkpoints=[], _checkpoints_to_remove=[])}, async_bookkeeping=None, no_checkpoints=False, no_evals=False), visualize=HeliosVisualizeConfig(output_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.0005/visualizations', num_samples=None, global_step=None, std_multiplier=2.0), init_seed=12536)
2025-08-17 13:29:48.567	saturn-cs-aus-233.reviz.ai2.in:0	helios.internal.experiment:210	INFO	Launching the experiment
2025-08-17 13:29:48.567	saturn-cs-aus-233.reviz.ai2.in:0	helios.internal.experiment:211	INFO	HeliosExperimentConfig(run_name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.0005', launch=HeliosBeakerLaunchConfig(name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.0005-train-87c52ff4', cmd=['scripts/2025_07_21_add_era5/eval.py', 'train', 'latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.0005', 'ai2/saturn-cirrascale', '--launch.priority=high', '--trainer.callbacks.downstream_evaluator.tasks.m-cashew-plant.probe_lr=0.0005', '--trainer.callbacks.downstream_evaluator.tasks.mados.probe_lr=0.0005', '--trainer.callbacks.downstream_evaluator.tasks.sen1floods11.probe_lr=0.0005', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel2.probe_lr=0.0005', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1.probe_lr=0.0005', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1_sentinel2.probe_lr=0.0005', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1.probe_lr=0.0005', '--trainer.callbacks.downstream_evaluator.tasks.sickle_landsat.probe_lr=0.0005', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1_landsat.probe_lr=0.0005', '--trainer.callbacks.downstream_evaluator.tasks.breizhcrops.probe_lr=0.0005', '--trainer.load_path=/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets/step200000', '--launch.task_name=eval'], budget='ai2/es-platform', task_name='eval', workspace='ai2/earth-systems', description=None, setup_steps=['echo "$GCP_CREDENTIALS" > $GOOGLE_APPLICATION_CREDENTIALS', 'conda install gh --channel conda-forge', 'gh auth status', 'gh repo clone $REPO_URL .', 'git checkout "$GIT_REF"', 'git submodule update --init --recursive', 'conda shell.bash activate base', "pip install -e '.[all]'", '', 'pip freeze'], beaker_image='petew/olmo-core-tch270cu128', num_nodes=1, num_gpus=1, shared_memory='256GiB', clusters=['ai2/saturn-cirrascale'], shared_filesystem=True, priority=<Priority.high: 'high'>, preemptible=True, retries=None, env_vars=[BeakerEnvVar(name='NCCL_DEBUG', value='WARN'), BeakerEnvVar(name='TORCH_NCCL_TRACE_BUFFER_SIZE', value='0'), BeakerEnvVar(name='NCCL_BLOCKING_WAIT', value='0'), BeakerEnvVar(name='GOOGLE_APPLICATION_CREDENTIALS', value='/etc/gcp_credentials.json')], env_secrets=[BeakerEnvSecret(name='BEAKER_TOKEN', secret='yawenzzzz_BEAKER_TOKEN'), BeakerEnvSecret(name='WANDB_API_KEY', secret='yawenzzzz_WANDB_API_KEY'), BeakerEnvSecret(name='GITHUB_TOKEN', secret='yawenzzzz_GITHUB_TOKEN'), BeakerEnvSecret(name='GCP_CREDENTIALS', secret='HELIOS_GCP_CREDENTIALS')], nfs=False, weka_buckets=[BeakerWekaBucket(bucket='dfive-default', mount='/weka/dfive-default')], allow_dirty=False, host_networking=None, git=GitConfig(repo_url='https://github.com/allenai/helios', ref='ad34f8d9cc3af2794e41b5c6cdddefdba216e57d', branch=None), hostnames=None), model=LatentMIMConfig(encoder_config=EncoderConfig(supported_modality_names=['sentinel2_l2a', 'sentinel1', 'landsat'], embedding_size=768, max_patch_size=8, min_patch_size=1, num_heads=12, mlp_ratio=4.0, depth=12, drop_path=0.1, max_sequence_length=12, learnable_channel_embeddings=True, random_channel_embeddings=False, num_projection_layers=1, aggregate_then_project=True, use_flash_attn=False, frozen_patch_embeddings=False, qk_norm=False), decoder_config=PredictorConfig(supported_modality_names=['sentinel2_l2a', 'sentinel1', 'landsat'], encoder_embedding_size=768, decoder_embedding_size=768, depth=4, mlp_ratio=4.0, num_heads=12, max_sequence_length=12, drop_path=0.0, learnable_channel_embeddings=True, random_channel_embeddings=False, output_embedding_size=None, use_flash_attn=False, qk_norm=False), reconstructor_config=None), dataset=HeliosConcatDatasetConfig(dataset_configs=[HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/presto/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/469728', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/osm_sampling/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/1138828', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/osmbig/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/1291656', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/presto_neighbor/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/3507008', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/worldcover_sampling/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/5662848', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0)]), data_loader=HeliosDataLoaderConfig(work_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.0005', global_batch_size=512, min_patch_size=1, max_patch_size=8, sampled_hw_p_list=[5, 6, 7, 8, 9, 10, 11, 12], seed=3622, token_budget=1500, shuffle=True, num_workers=16, prefetch_factor=4, target_device_type=None, drop_last=True, num_dataset_repeats_per_epoch=1), train_module=ContrastiveLatentMIMTrainModuleConfig(optim_config=AdamWConfig(group_overrides=None, compile=False, fixed_fields=['initial_lr'], lr=0.0001, betas=[0.9, 0.999], eps=1e-08, weight_decay=0.02, foreach=None, fused=True), rank_microbatch_size=64, transform_config=TransformConfig(transform_type='flip_and_rotate', transform_kwargs={}), compile_model=False, dp_config=DataParallelConfig(name='fsdp', param_dtype='bfloat16', reduce_dtype='float32', num_replicas=None, shard_degree=None), compile_loss=False, autocast_precision=None, max_grad_norm=1.0, scheduler=CosWithWarmup(lr_field='lr', initial_lr_field='initial_lr', warmup_steps=8000, warmup_fraction=None, alpha_f=0.1, t_max=None, warmup_min_lr=0.0), find_unused_parameters=True, state_dict_save_opts=None, state_dict_load_opts=None, regularizer_config=None, loss_config=LossConfig(loss_config={'type': 'modality_patch_discrimination_new', 'tau': 0.1}), mae_loss_config=None, masking_config=MaskingConfig(strategy_config={'type': 'modality_cross_random', 'encode_ratio': 0.5, 'decode_ratio': 0.5, 'allow_encoding_decoding_same_bandset': True}), token_exit_cfg={'sentinel2_l2a': 0, 'sentinel1': 0, 'landsat': 0}, ema_decay=[1.0, 1.0], contrastive_config=LossConfig(loss_config={'type': 'InfoNCE', 'weight': 0.1})), trainer=TrainerConfig(save_folder='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.0005', work_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.0005', load_path='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets/step200000', load_strategy='if_available', checkpointer=CheckpointerConfig(work_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.0005', save_overwrite=None, pre_download=False, save_thread_count=None, load_thread_count=None, throttle_uploads=False), device=None, save_overwrite=False, max_duration=Duration(value=300, unit='epochs'), cancel_check_interval=1, hard_stop=None, metrics_collect_interval=10, callbacks={'wandb': HeliosWandBCallback(enabled=True, name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.0005', project='2025_08_17_contrastive_eval', entity='eai-ai2', group=None, tags=None, notes=None, config=None, cancel_tags=['cancel', 'canceled', 'cancelled'], cancel_check_interval=None, upload_dataset_distribution_pre_train=True, upload_modality_data_band_distribution_pre_train=False, restart_on_same_run=True), 'speed_monitor': HeliosSpeedMonitorCallback(num_flops_per_token=None, device_peak_flops=None, _total_steps=0, _total_tokens=0, _start_time=0.0, _first_step=True, _step_last_logged=0.0, _batch_load_start=0.0, _batch_load_time=0.0, _step_tokens=0, _step_seq_len=0, _parallel_degree=1, _bps_avg=None), 'gpu_memory_monitor': GPUMemoryMonitorCallback(device_id=None, _num_alloc_retries=0), 'config_saver': ConfigSaverCallback(config=None, fname='config.json', save_data_paths=None, data_paths_fname=None), 'downstream_evaluator': DownstreamEvaluatorCallbackConfig(tasks={'m-eurosat': DownstreamTaskConfig(dataset='m-eurosat', embedding_batch_size=128, num_workers=0, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm-bigearthnet': DownstreamTaskConfig(dataset='m-bigearthnet', embedding_batch_size=64, num_workers=4, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm-so2sat': DownstreamTaskConfig(dataset='m-so2sat', embedding_batch_size=128, num_workers=4, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm-brick-kiln': DownstreamTaskConfig(dataset='m-brick-kiln', embedding_batch_size=128, num_workers=4, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'mados': DownstreamTaskConfig(dataset='mados', embedding_batch_size=128, num_workers=8, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=False, input_modalities=[], probe_lr=0.0005, patch_size=4, probe_batch_size=128, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sen1floods11': DownstreamTaskConfig(dataset='sen1floods11', embedding_batch_size=128, num_workers=8, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.0005, patch_size=4, probe_batch_size=128, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sickle_sentinel1': DownstreamTaskConfig(dataset='sickle', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1'], probe_lr=0.0005, patch_size=4, probe_batch_size=16, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sickle_landsat': DownstreamTaskConfig(dataset='sickle', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['landsat'], probe_lr=0.0005, patch_size=4, probe_batch_size=16, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sickle_sentinel1_landsat': DownstreamTaskConfig(dataset='sickle', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1', 'landsat'], probe_lr=0.0005, patch_size=4, probe_batch_size=16, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm_sa_crop_type': DownstreamTaskConfig(dataset='m-sa-crop-type', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.1, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm_cashew_plant': DownstreamTaskConfig(dataset='m-cashew-plant', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.0005, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'pastis_sentinel2': DownstreamTaskConfig(dataset='pastis', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel2_l2a'], probe_lr=0.0005, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=50, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'pastis_sentinel1': DownstreamTaskConfig(dataset='pastis', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1'], probe_lr=0.0005, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=50, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'pastis_sentinel1_sentinel2': DownstreamTaskConfig(dataset='pastis', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1', 'sentinel2_l2a'], probe_lr=0.0005, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=20, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'breizhcrops': DownstreamTaskConfig(dataset='breizhcrops', embedding_batch_size=128, num_workers=8, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.0005, patch_size=1, probe_batch_size=128, epochs=50, eval_interval=Duration(value=50, unit='epochs'), eval_mode='linear_probe', probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP')}, enabled=True, eval_on_startup=True, cancel_after_first_eval=True), 'garbage_collector': GarbageCollectorCallback(gc_interval=1, enabled=True, _start_state=None), 'beaker': BeakerCallback(experiment_id=None, update_interval=None, description=None, enabled=None, _last_update=None), 'checkpointer': CheckpointerCallback(save_interval=5000, ephemeral_save_interval=250, pre_train_checkpoint=None, save_async=None, remove='ephemeral_only', enabled=True, _latest_checkpoint_step=-1, _latest_checkpoint_path='', _checkpoints=[], _ephemeral_checkpoints=[], _checkpoints_to_remove=[])}, async_bookkeeping=None, no_checkpoints=False, no_evals=False), visualize=HeliosVisualizeConfig(output_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.0005/visualizations', num_samples=None, global_step=None, std_multiplier=2.0), init_seed=12536)
2025-08-17 13:29:49.551	saturn-cs-aus-233.reviz.ai2.in:0	py.warnings:109	WARNING	/weka/dfive-default/yawenz/.venv-helios-py310/lib/python3.10/site-packages/beaker/util.py:25: RuntimeWarning: Found unknown field 'budget: 01HPM52AQC6C0TZV32E7WDDGDJ' for data model 'Workspace'. This may be a newly added field that hasn't been defined in beaker-py yet. Please submit an issue report about this here:
https://github.com/allenai/beaker-py/issues/new?assignees=&labels=bug&template=bug_report.yml
  warnings.warn(

2025-08-17 13:29:53.344	saturn-cs-aus-233.reviz.ai2.in:0	olmo_core.launch.beaker:513	INFO	Experiment submitted, see progress at https://beaker.org/ex/01K2WVJTDSMBGNE2AN69AWHQQ0
2025-08-17 13:30:04.086	saturn-cs-aus-233.reviz.ai2.in:0	olmo_core.utils:200	INFO	Setting env var 'OMP_NUM_THREADS' to '8'
2025-08-17 13:30:04.086	saturn-cs-aus-233.reviz.ai2.in:0	olmo_core.utils:200	INFO	Setting env var 'TOKENIZERS_PARALLELISM' to 'false'
2025-08-17 13:30:04.086	saturn-cs-aus-233.reviz.ai2.in:0	helios.internal.experiment:135	INFO	Common overrides: []
2025-08-17 13:30:04.104	saturn-cs-aus-233.reviz.ai2.in:0	helios.internal.experiment:137	INFO	Common: CommonComponents(run_name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.001', save_folder='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.001', launch=HeliosBeakerLaunchConfig(name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.001-train-f9e3d395', cmd=['scripts/2025_07_21_add_era5/eval.py', 'train', 'latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.001', 'ai2/saturn-cirrascale', '--launch.priority=high', '--trainer.callbacks.downstream_evaluator.tasks.m-cashew-plant.probe_lr=0.001', '--trainer.callbacks.downstream_evaluator.tasks.mados.probe_lr=0.001', '--trainer.callbacks.downstream_evaluator.tasks.sen1floods11.probe_lr=0.001', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel2.probe_lr=0.001', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1.probe_lr=0.001', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1_sentinel2.probe_lr=0.001', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1.probe_lr=0.001', '--trainer.callbacks.downstream_evaluator.tasks.sickle_landsat.probe_lr=0.001', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1_landsat.probe_lr=0.001', '--trainer.callbacks.downstream_evaluator.tasks.breizhcrops.probe_lr=0.001', '--trainer.load_path=/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets/step200000', '--launch.task_name=eval'], budget='ai2/es-platform', task_name='train', workspace='ai2/earth-systems', description=None, setup_steps=['echo "$GCP_CREDENTIALS" > $GOOGLE_APPLICATION_CREDENTIALS', 'conda install gh --channel conda-forge', 'gh auth status', 'gh repo clone $REPO_URL .', 'git checkout "$GIT_REF"', 'git submodule update --init --recursive', 'conda shell.bash activate base', "pip install -e '.[all]'", '', 'pip freeze'], beaker_image='petew/olmo-core-tch270cu128', num_nodes=1, num_gpus=1, shared_memory='256GiB', clusters=['ai2/saturn-cirrascale'], shared_filesystem=True, priority=<Priority.high: 'high'>, preemptible=True, retries=None, env_vars=[BeakerEnvVar(name='NCCL_DEBUG', value='WARN'), BeakerEnvVar(name='TORCH_NCCL_TRACE_BUFFER_SIZE', value='0'), BeakerEnvVar(name='NCCL_BLOCKING_WAIT', value='0'), BeakerEnvVar(name='GOOGLE_APPLICATION_CREDENTIALS', value='/etc/gcp_credentials.json')], env_secrets=[BeakerEnvSecret(name='BEAKER_TOKEN', secret='yawenzzzz_BEAKER_TOKEN'), BeakerEnvSecret(name='WANDB_API_KEY', secret='yawenzzzz_WANDB_API_KEY'), BeakerEnvSecret(name='GITHUB_TOKEN', secret='yawenzzzz_GITHUB_TOKEN'), BeakerEnvSecret(name='GCP_CREDENTIALS', secret='HELIOS_GCP_CREDENTIALS')], nfs=False, weka_buckets=[BeakerWekaBucket(bucket='dfive-default', mount='/weka/dfive-default')], allow_dirty=False, host_networking=None, git=GitConfig(repo_url='https://github.com/allenai/helios', ref='ad34f8d9cc3af2794e41b5c6cdddefdba216e57d', branch=None), hostnames=None), training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dataset_percentage=1.0, nccl_debug=False)
2025-08-17 13:30:04.108	saturn-cs-aus-233.reviz.ai2.in:0	helios.internal.experiment:156	INFO	Overrides: ['--launch.priority=high', '--trainer.callbacks.downstream_evaluator.tasks.m-cashew-plant.probe_lr=0.001', '--trainer.callbacks.downstream_evaluator.tasks.mados.probe_lr=0.001', '--trainer.callbacks.downstream_evaluator.tasks.sen1floods11.probe_lr=0.001', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel2.probe_lr=0.001', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1.probe_lr=0.001', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1_sentinel2.probe_lr=0.001', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1.probe_lr=0.001', '--trainer.callbacks.downstream_evaluator.tasks.sickle_landsat.probe_lr=0.001', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1_landsat.probe_lr=0.001', '--trainer.callbacks.downstream_evaluator.tasks.breizhcrops.probe_lr=0.001', '--trainer.load_path=/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets/step200000', '--launch.task_name=eval']
HeliosExperimentConfig(run_name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.001', launch=HeliosBeakerLaunchConfig(name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.001-train-f9e3d395', cmd=['scripts/2025_07_21_add_era5/eval.py', 'train', 'latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.001', 'ai2/saturn-cirrascale', '--launch.priority=high', '--trainer.callbacks.downstream_evaluator.tasks.m-cashew-plant.probe_lr=0.001', '--trainer.callbacks.downstream_evaluator.tasks.mados.probe_lr=0.001', '--trainer.callbacks.downstream_evaluator.tasks.sen1floods11.probe_lr=0.001', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel2.probe_lr=0.001', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1.probe_lr=0.001', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1_sentinel2.probe_lr=0.001', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1.probe_lr=0.001', '--trainer.callbacks.downstream_evaluator.tasks.sickle_landsat.probe_lr=0.001', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1_landsat.probe_lr=0.001', '--trainer.callbacks.downstream_evaluator.tasks.breizhcrops.probe_lr=0.001', '--trainer.load_path=/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets/step200000', '--launch.task_name=eval'], budget='ai2/es-platform', task_name='eval', workspace='ai2/earth-systems', description=None, setup_steps=['echo "$GCP_CREDENTIALS" > $GOOGLE_APPLICATION_CREDENTIALS', 'conda install gh --channel conda-forge', 'gh auth status', 'gh repo clone $REPO_URL .', 'git checkout "$GIT_REF"', 'git submodule update --init --recursive', 'conda shell.bash activate base', "pip install -e '.[all]'", '', 'pip freeze'], beaker_image='petew/olmo-core-tch270cu128', num_nodes=1, num_gpus=1, shared_memory='256GiB', clusters=['ai2/saturn-cirrascale'], shared_filesystem=True, priority=<Priority.high: 'high'>, preemptible=True, retries=None, env_vars=[BeakerEnvVar(name='NCCL_DEBUG', value='WARN'), BeakerEnvVar(name='TORCH_NCCL_TRACE_BUFFER_SIZE', value='0'), BeakerEnvVar(name='NCCL_BLOCKING_WAIT', value='0'), BeakerEnvVar(name='GOOGLE_APPLICATION_CREDENTIALS', value='/etc/gcp_credentials.json')], env_secrets=[BeakerEnvSecret(name='BEAKER_TOKEN', secret='yawenzzzz_BEAKER_TOKEN'), BeakerEnvSecret(name='WANDB_API_KEY', secret='yawenzzzz_WANDB_API_KEY'), BeakerEnvSecret(name='GITHUB_TOKEN', secret='yawenzzzz_GITHUB_TOKEN'), BeakerEnvSecret(name='GCP_CREDENTIALS', secret='HELIOS_GCP_CREDENTIALS')], nfs=False, weka_buckets=[BeakerWekaBucket(bucket='dfive-default', mount='/weka/dfive-default')], allow_dirty=False, host_networking=None, git=GitConfig(repo_url='https://github.com/allenai/helios', ref='ad34f8d9cc3af2794e41b5c6cdddefdba216e57d', branch=None), hostnames=None), model=LatentMIMConfig(encoder_config=EncoderConfig(supported_modality_names=['sentinel2_l2a', 'sentinel1', 'landsat'], embedding_size=768, max_patch_size=8, min_patch_size=1, num_heads=12, mlp_ratio=4.0, depth=12, drop_path=0.1, max_sequence_length=12, learnable_channel_embeddings=True, random_channel_embeddings=False, num_projection_layers=1, aggregate_then_project=True, use_flash_attn=False, frozen_patch_embeddings=False, qk_norm=False), decoder_config=PredictorConfig(supported_modality_names=['sentinel2_l2a', 'sentinel1', 'landsat'], encoder_embedding_size=768, decoder_embedding_size=768, depth=4, mlp_ratio=4.0, num_heads=12, max_sequence_length=12, drop_path=0.0, learnable_channel_embeddings=True, random_channel_embeddings=False, output_embedding_size=None, use_flash_attn=False, qk_norm=False), reconstructor_config=None), dataset=HeliosConcatDatasetConfig(dataset_configs=[HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/presto/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/469728', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/osm_sampling/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/1138828', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/osmbig/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/1291656', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/presto_neighbor/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/3507008', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/worldcover_sampling/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/5662848', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0)]), data_loader=HeliosDataLoaderConfig(work_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.001', global_batch_size=512, min_patch_size=1, max_patch_size=8, sampled_hw_p_list=[5, 6, 7, 8, 9, 10, 11, 12], seed=3622, token_budget=1500, shuffle=True, num_workers=16, prefetch_factor=4, target_device_type=None, drop_last=True, num_dataset_repeats_per_epoch=1), train_module=ContrastiveLatentMIMTrainModuleConfig(optim_config=AdamWConfig(group_overrides=None, compile=False, fixed_fields=['initial_lr'], lr=0.0001, betas=[0.9, 0.999], eps=1e-08, weight_decay=0.02, foreach=None, fused=True), rank_microbatch_size=64, transform_config=TransformConfig(transform_type='flip_and_rotate', transform_kwargs={}), compile_model=False, dp_config=DataParallelConfig(name='fsdp', param_dtype='bfloat16', reduce_dtype='float32', num_replicas=None, shard_degree=None), compile_loss=False, autocast_precision=None, max_grad_norm=1.0, scheduler=CosWithWarmup(lr_field='lr', initial_lr_field='initial_lr', warmup_steps=8000, warmup_fraction=None, alpha_f=0.1, t_max=None, warmup_min_lr=0.0), find_unused_parameters=True, state_dict_save_opts=None, state_dict_load_opts=None, regularizer_config=None, loss_config=LossConfig(loss_config={'type': 'modality_patch_discrimination_new', 'tau': 0.1}), mae_loss_config=None, masking_config=MaskingConfig(strategy_config={'type': 'modality_cross_random', 'encode_ratio': 0.5, 'decode_ratio': 0.5, 'allow_encoding_decoding_same_bandset': True}), token_exit_cfg={'sentinel2_l2a': 0, 'sentinel1': 0, 'landsat': 0}, ema_decay=[1.0, 1.0], contrastive_config=LossConfig(loss_config={'type': 'InfoNCE', 'weight': 0.1})), trainer=TrainerConfig(save_folder='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.001', work_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.001', load_path='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets/step200000', load_strategy='if_available', checkpointer=CheckpointerConfig(work_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.001', save_overwrite=None, pre_download=False, save_thread_count=None, load_thread_count=None, throttle_uploads=False), device=None, save_overwrite=False, max_duration=Duration(value=300, unit='epochs'), cancel_check_interval=1, hard_stop=None, metrics_collect_interval=10, callbacks={'wandb': HeliosWandBCallback(enabled=True, name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.001', project='2025_08_17_contrastive_eval', entity='eai-ai2', group=None, tags=None, notes=None, config=None, cancel_tags=['cancel', 'canceled', 'cancelled'], cancel_check_interval=None, upload_dataset_distribution_pre_train=True, upload_modality_data_band_distribution_pre_train=False, restart_on_same_run=True), 'speed_monitor': HeliosSpeedMonitorCallback(num_flops_per_token=None, device_peak_flops=None, _total_steps=0, _total_tokens=0, _start_time=0.0, _first_step=True, _step_last_logged=0.0, _batch_load_start=0.0, _batch_load_time=0.0, _step_tokens=0, _step_seq_len=0, _parallel_degree=1, _bps_avg=None), 'gpu_memory_monitor': GPUMemoryMonitorCallback(device_id=None, _num_alloc_retries=0), 'config_saver': ConfigSaverCallback(config=None, fname='config.json', save_data_paths=None, data_paths_fname=None), 'downstream_evaluator': DownstreamEvaluatorCallbackConfig(tasks={'m-eurosat': DownstreamTaskConfig(dataset='m-eurosat', embedding_batch_size=128, num_workers=0, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm-bigearthnet': DownstreamTaskConfig(dataset='m-bigearthnet', embedding_batch_size=64, num_workers=4, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm-so2sat': DownstreamTaskConfig(dataset='m-so2sat', embedding_batch_size=128, num_workers=4, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm-brick-kiln': DownstreamTaskConfig(dataset='m-brick-kiln', embedding_batch_size=128, num_workers=4, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'mados': DownstreamTaskConfig(dataset='mados', embedding_batch_size=128, num_workers=8, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=False, input_modalities=[], probe_lr=0.001, patch_size=4, probe_batch_size=128, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sen1floods11': DownstreamTaskConfig(dataset='sen1floods11', embedding_batch_size=128, num_workers=8, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.001, patch_size=4, probe_batch_size=128, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sickle_sentinel1': DownstreamTaskConfig(dataset='sickle', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1'], probe_lr=0.001, patch_size=4, probe_batch_size=16, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sickle_landsat': DownstreamTaskConfig(dataset='sickle', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['landsat'], probe_lr=0.001, patch_size=4, probe_batch_size=16, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sickle_sentinel1_landsat': DownstreamTaskConfig(dataset='sickle', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1', 'landsat'], probe_lr=0.001, patch_size=4, probe_batch_size=16, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm_sa_crop_type': DownstreamTaskConfig(dataset='m-sa-crop-type', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.1, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm_cashew_plant': DownstreamTaskConfig(dataset='m-cashew-plant', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.001, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'pastis_sentinel2': DownstreamTaskConfig(dataset='pastis', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel2_l2a'], probe_lr=0.001, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=50, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'pastis_sentinel1': DownstreamTaskConfig(dataset='pastis', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1'], probe_lr=0.001, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=50, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'pastis_sentinel1_sentinel2': DownstreamTaskConfig(dataset='pastis', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1', 'sentinel2_l2a'], probe_lr=0.001, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=20, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'breizhcrops': DownstreamTaskConfig(dataset='breizhcrops', embedding_batch_size=128, num_workers=8, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.001, patch_size=1, probe_batch_size=128, epochs=50, eval_interval=Duration(value=50, unit='epochs'), eval_mode='linear_probe', probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP')}, enabled=True, eval_on_startup=True, cancel_after_first_eval=True), 'garbage_collector': GarbageCollectorCallback(gc_interval=1, enabled=True, _start_state=None), 'beaker': BeakerCallback(experiment_id=None, update_interval=None, description=None, enabled=None, _last_update=None), 'checkpointer': CheckpointerCallback(save_interval=5000, ephemeral_save_interval=250, pre_train_checkpoint=None, save_async=None, remove='ephemeral_only', enabled=True, _latest_checkpoint_step=-1, _latest_checkpoint_path='', _checkpoints=[], _ephemeral_checkpoints=[], _checkpoints_to_remove=[])}, async_bookkeeping=None, no_checkpoints=False, no_evals=False), visualize=HeliosVisualizeConfig(output_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.001/visualizations', num_samples=None, global_step=None, std_multiplier=2.0), init_seed=12536)
2025-08-17 13:30:04.254	saturn-cs-aus-233.reviz.ai2.in:0	helios.internal.experiment:210	INFO	Launching the experiment
2025-08-17 13:30:04.254	saturn-cs-aus-233.reviz.ai2.in:0	helios.internal.experiment:211	INFO	HeliosExperimentConfig(run_name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.001', launch=HeliosBeakerLaunchConfig(name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.001-train-f9e3d395', cmd=['scripts/2025_07_21_add_era5/eval.py', 'train', 'latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.001', 'ai2/saturn-cirrascale', '--launch.priority=high', '--trainer.callbacks.downstream_evaluator.tasks.m-cashew-plant.probe_lr=0.001', '--trainer.callbacks.downstream_evaluator.tasks.mados.probe_lr=0.001', '--trainer.callbacks.downstream_evaluator.tasks.sen1floods11.probe_lr=0.001', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel2.probe_lr=0.001', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1.probe_lr=0.001', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1_sentinel2.probe_lr=0.001', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1.probe_lr=0.001', '--trainer.callbacks.downstream_evaluator.tasks.sickle_landsat.probe_lr=0.001', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1_landsat.probe_lr=0.001', '--trainer.callbacks.downstream_evaluator.tasks.breizhcrops.probe_lr=0.001', '--trainer.load_path=/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets/step200000', '--launch.task_name=eval'], budget='ai2/es-platform', task_name='eval', workspace='ai2/earth-systems', description=None, setup_steps=['echo "$GCP_CREDENTIALS" > $GOOGLE_APPLICATION_CREDENTIALS', 'conda install gh --channel conda-forge', 'gh auth status', 'gh repo clone $REPO_URL .', 'git checkout "$GIT_REF"', 'git submodule update --init --recursive', 'conda shell.bash activate base', "pip install -e '.[all]'", '', 'pip freeze'], beaker_image='petew/olmo-core-tch270cu128', num_nodes=1, num_gpus=1, shared_memory='256GiB', clusters=['ai2/saturn-cirrascale'], shared_filesystem=True, priority=<Priority.high: 'high'>, preemptible=True, retries=None, env_vars=[BeakerEnvVar(name='NCCL_DEBUG', value='WARN'), BeakerEnvVar(name='TORCH_NCCL_TRACE_BUFFER_SIZE', value='0'), BeakerEnvVar(name='NCCL_BLOCKING_WAIT', value='0'), BeakerEnvVar(name='GOOGLE_APPLICATION_CREDENTIALS', value='/etc/gcp_credentials.json')], env_secrets=[BeakerEnvSecret(name='BEAKER_TOKEN', secret='yawenzzzz_BEAKER_TOKEN'), BeakerEnvSecret(name='WANDB_API_KEY', secret='yawenzzzz_WANDB_API_KEY'), BeakerEnvSecret(name='GITHUB_TOKEN', secret='yawenzzzz_GITHUB_TOKEN'), BeakerEnvSecret(name='GCP_CREDENTIALS', secret='HELIOS_GCP_CREDENTIALS')], nfs=False, weka_buckets=[BeakerWekaBucket(bucket='dfive-default', mount='/weka/dfive-default')], allow_dirty=False, host_networking=None, git=GitConfig(repo_url='https://github.com/allenai/helios', ref='ad34f8d9cc3af2794e41b5c6cdddefdba216e57d', branch=None), hostnames=None), model=LatentMIMConfig(encoder_config=EncoderConfig(supported_modality_names=['sentinel2_l2a', 'sentinel1', 'landsat'], embedding_size=768, max_patch_size=8, min_patch_size=1, num_heads=12, mlp_ratio=4.0, depth=12, drop_path=0.1, max_sequence_length=12, learnable_channel_embeddings=True, random_channel_embeddings=False, num_projection_layers=1, aggregate_then_project=True, use_flash_attn=False, frozen_patch_embeddings=False, qk_norm=False), decoder_config=PredictorConfig(supported_modality_names=['sentinel2_l2a', 'sentinel1', 'landsat'], encoder_embedding_size=768, decoder_embedding_size=768, depth=4, mlp_ratio=4.0, num_heads=12, max_sequence_length=12, drop_path=0.0, learnable_channel_embeddings=True, random_channel_embeddings=False, output_embedding_size=None, use_flash_attn=False, qk_norm=False), reconstructor_config=None), dataset=HeliosConcatDatasetConfig(dataset_configs=[HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/presto/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/469728', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/osm_sampling/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/1138828', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/osmbig/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/1291656', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/presto_neighbor/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/3507008', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/worldcover_sampling/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/5662848', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0)]), data_loader=HeliosDataLoaderConfig(work_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.001', global_batch_size=512, min_patch_size=1, max_patch_size=8, sampled_hw_p_list=[5, 6, 7, 8, 9, 10, 11, 12], seed=3622, token_budget=1500, shuffle=True, num_workers=16, prefetch_factor=4, target_device_type=None, drop_last=True, num_dataset_repeats_per_epoch=1), train_module=ContrastiveLatentMIMTrainModuleConfig(optim_config=AdamWConfig(group_overrides=None, compile=False, fixed_fields=['initial_lr'], lr=0.0001, betas=[0.9, 0.999], eps=1e-08, weight_decay=0.02, foreach=None, fused=True), rank_microbatch_size=64, transform_config=TransformConfig(transform_type='flip_and_rotate', transform_kwargs={}), compile_model=False, dp_config=DataParallelConfig(name='fsdp', param_dtype='bfloat16', reduce_dtype='float32', num_replicas=None, shard_degree=None), compile_loss=False, autocast_precision=None, max_grad_norm=1.0, scheduler=CosWithWarmup(lr_field='lr', initial_lr_field='initial_lr', warmup_steps=8000, warmup_fraction=None, alpha_f=0.1, t_max=None, warmup_min_lr=0.0), find_unused_parameters=True, state_dict_save_opts=None, state_dict_load_opts=None, regularizer_config=None, loss_config=LossConfig(loss_config={'type': 'modality_patch_discrimination_new', 'tau': 0.1}), mae_loss_config=None, masking_config=MaskingConfig(strategy_config={'type': 'modality_cross_random', 'encode_ratio': 0.5, 'decode_ratio': 0.5, 'allow_encoding_decoding_same_bandset': True}), token_exit_cfg={'sentinel2_l2a': 0, 'sentinel1': 0, 'landsat': 0}, ema_decay=[1.0, 1.0], contrastive_config=LossConfig(loss_config={'type': 'InfoNCE', 'weight': 0.1})), trainer=TrainerConfig(save_folder='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.001', work_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.001', load_path='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets/step200000', load_strategy='if_available', checkpointer=CheckpointerConfig(work_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.001', save_overwrite=None, pre_download=False, save_thread_count=None, load_thread_count=None, throttle_uploads=False), device=None, save_overwrite=False, max_duration=Duration(value=300, unit='epochs'), cancel_check_interval=1, hard_stop=None, metrics_collect_interval=10, callbacks={'wandb': HeliosWandBCallback(enabled=True, name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.001', project='2025_08_17_contrastive_eval', entity='eai-ai2', group=None, tags=None, notes=None, config=None, cancel_tags=['cancel', 'canceled', 'cancelled'], cancel_check_interval=None, upload_dataset_distribution_pre_train=True, upload_modality_data_band_distribution_pre_train=False, restart_on_same_run=True), 'speed_monitor': HeliosSpeedMonitorCallback(num_flops_per_token=None, device_peak_flops=None, _total_steps=0, _total_tokens=0, _start_time=0.0, _first_step=True, _step_last_logged=0.0, _batch_load_start=0.0, _batch_load_time=0.0, _step_tokens=0, _step_seq_len=0, _parallel_degree=1, _bps_avg=None), 'gpu_memory_monitor': GPUMemoryMonitorCallback(device_id=None, _num_alloc_retries=0), 'config_saver': ConfigSaverCallback(config=None, fname='config.json', save_data_paths=None, data_paths_fname=None), 'downstream_evaluator': DownstreamEvaluatorCallbackConfig(tasks={'m-eurosat': DownstreamTaskConfig(dataset='m-eurosat', embedding_batch_size=128, num_workers=0, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm-bigearthnet': DownstreamTaskConfig(dataset='m-bigearthnet', embedding_batch_size=64, num_workers=4, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm-so2sat': DownstreamTaskConfig(dataset='m-so2sat', embedding_batch_size=128, num_workers=4, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm-brick-kiln': DownstreamTaskConfig(dataset='m-brick-kiln', embedding_batch_size=128, num_workers=4, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'mados': DownstreamTaskConfig(dataset='mados', embedding_batch_size=128, num_workers=8, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=False, input_modalities=[], probe_lr=0.001, patch_size=4, probe_batch_size=128, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sen1floods11': DownstreamTaskConfig(dataset='sen1floods11', embedding_batch_size=128, num_workers=8, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.001, patch_size=4, probe_batch_size=128, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sickle_sentinel1': DownstreamTaskConfig(dataset='sickle', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1'], probe_lr=0.001, patch_size=4, probe_batch_size=16, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sickle_landsat': DownstreamTaskConfig(dataset='sickle', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['landsat'], probe_lr=0.001, patch_size=4, probe_batch_size=16, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sickle_sentinel1_landsat': DownstreamTaskConfig(dataset='sickle', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1', 'landsat'], probe_lr=0.001, patch_size=4, probe_batch_size=16, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm_sa_crop_type': DownstreamTaskConfig(dataset='m-sa-crop-type', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.1, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm_cashew_plant': DownstreamTaskConfig(dataset='m-cashew-plant', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.001, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'pastis_sentinel2': DownstreamTaskConfig(dataset='pastis', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel2_l2a'], probe_lr=0.001, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=50, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'pastis_sentinel1': DownstreamTaskConfig(dataset='pastis', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1'], probe_lr=0.001, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=50, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'pastis_sentinel1_sentinel2': DownstreamTaskConfig(dataset='pastis', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1', 'sentinel2_l2a'], probe_lr=0.001, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=20, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'breizhcrops': DownstreamTaskConfig(dataset='breizhcrops', embedding_batch_size=128, num_workers=8, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.001, patch_size=1, probe_batch_size=128, epochs=50, eval_interval=Duration(value=50, unit='epochs'), eval_mode='linear_probe', probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP')}, enabled=True, eval_on_startup=True, cancel_after_first_eval=True), 'garbage_collector': GarbageCollectorCallback(gc_interval=1, enabled=True, _start_state=None), 'beaker': BeakerCallback(experiment_id=None, update_interval=None, description=None, enabled=None, _last_update=None), 'checkpointer': CheckpointerCallback(save_interval=5000, ephemeral_save_interval=250, pre_train_checkpoint=None, save_async=None, remove='ephemeral_only', enabled=True, _latest_checkpoint_step=-1, _latest_checkpoint_path='', _checkpoints=[], _ephemeral_checkpoints=[], _checkpoints_to_remove=[])}, async_bookkeeping=None, no_checkpoints=False, no_evals=False), visualize=HeliosVisualizeConfig(output_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.001/visualizations', num_samples=None, global_step=None, std_multiplier=2.0), init_seed=12536)
2025-08-17 13:30:05.231	saturn-cs-aus-233.reviz.ai2.in:0	py.warnings:109	WARNING	/weka/dfive-default/yawenz/.venv-helios-py310/lib/python3.10/site-packages/beaker/util.py:25: RuntimeWarning: Found unknown field 'budget: 01HPM52AQC6C0TZV32E7WDDGDJ' for data model 'Workspace'. This may be a newly added field that hasn't been defined in beaker-py yet. Please submit an issue report about this here:
https://github.com/allenai/beaker-py/issues/new?assignees=&labels=bug&template=bug_report.yml
  warnings.warn(

2025-08-17 13:30:09.276	saturn-cs-aus-233.reviz.ai2.in:0	olmo_core.launch.beaker:513	INFO	Experiment submitted, see progress at https://beaker.org/ex/01K2WVKA0WQ4GX3Z2680NF8K5V
2025-08-17 13:30:19.674	saturn-cs-aus-233.reviz.ai2.in:0	olmo_core.utils:200	INFO	Setting env var 'OMP_NUM_THREADS' to '8'
2025-08-17 13:30:19.675	saturn-cs-aus-233.reviz.ai2.in:0	olmo_core.utils:200	INFO	Setting env var 'TOKENIZERS_PARALLELISM' to 'false'
2025-08-17 13:30:19.675	saturn-cs-aus-233.reviz.ai2.in:0	helios.internal.experiment:135	INFO	Common overrides: []
2025-08-17 13:30:19.693	saturn-cs-aus-233.reviz.ai2.in:0	helios.internal.experiment:137	INFO	Common: CommonComponents(run_name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.005', save_folder='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.005', launch=HeliosBeakerLaunchConfig(name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.005-train-bbb7c6d4', cmd=['scripts/2025_07_21_add_era5/eval.py', 'train', 'latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.005', 'ai2/saturn-cirrascale', '--launch.priority=high', '--trainer.callbacks.downstream_evaluator.tasks.m-cashew-plant.probe_lr=0.005', '--trainer.callbacks.downstream_evaluator.tasks.mados.probe_lr=0.005', '--trainer.callbacks.downstream_evaluator.tasks.sen1floods11.probe_lr=0.005', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel2.probe_lr=0.005', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1.probe_lr=0.005', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1_sentinel2.probe_lr=0.005', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1.probe_lr=0.005', '--trainer.callbacks.downstream_evaluator.tasks.sickle_landsat.probe_lr=0.005', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1_landsat.probe_lr=0.005', '--trainer.callbacks.downstream_evaluator.tasks.breizhcrops.probe_lr=0.005', '--trainer.load_path=/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets/step200000', '--launch.task_name=eval'], budget='ai2/es-platform', task_name='train', workspace='ai2/earth-systems', description=None, setup_steps=['echo "$GCP_CREDENTIALS" > $GOOGLE_APPLICATION_CREDENTIALS', 'conda install gh --channel conda-forge', 'gh auth status', 'gh repo clone $REPO_URL .', 'git checkout "$GIT_REF"', 'git submodule update --init --recursive', 'conda shell.bash activate base', "pip install -e '.[all]'", '', 'pip freeze'], beaker_image='petew/olmo-core-tch270cu128', num_nodes=1, num_gpus=1, shared_memory='256GiB', clusters=['ai2/saturn-cirrascale'], shared_filesystem=True, priority=<Priority.high: 'high'>, preemptible=True, retries=None, env_vars=[BeakerEnvVar(name='NCCL_DEBUG', value='WARN'), BeakerEnvVar(name='TORCH_NCCL_TRACE_BUFFER_SIZE', value='0'), BeakerEnvVar(name='NCCL_BLOCKING_WAIT', value='0'), BeakerEnvVar(name='GOOGLE_APPLICATION_CREDENTIALS', value='/etc/gcp_credentials.json')], env_secrets=[BeakerEnvSecret(name='BEAKER_TOKEN', secret='yawenzzzz_BEAKER_TOKEN'), BeakerEnvSecret(name='WANDB_API_KEY', secret='yawenzzzz_WANDB_API_KEY'), BeakerEnvSecret(name='GITHUB_TOKEN', secret='yawenzzzz_GITHUB_TOKEN'), BeakerEnvSecret(name='GCP_CREDENTIALS', secret='HELIOS_GCP_CREDENTIALS')], nfs=False, weka_buckets=[BeakerWekaBucket(bucket='dfive-default', mount='/weka/dfive-default')], allow_dirty=False, host_networking=None, git=GitConfig(repo_url='https://github.com/allenai/helios', ref='ad34f8d9cc3af2794e41b5c6cdddefdba216e57d', branch=None), hostnames=None), training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dataset_percentage=1.0, nccl_debug=False)
2025-08-17 13:30:19.698	saturn-cs-aus-233.reviz.ai2.in:0	helios.internal.experiment:156	INFO	Overrides: ['--launch.priority=high', '--trainer.callbacks.downstream_evaluator.tasks.m-cashew-plant.probe_lr=0.005', '--trainer.callbacks.downstream_evaluator.tasks.mados.probe_lr=0.005', '--trainer.callbacks.downstream_evaluator.tasks.sen1floods11.probe_lr=0.005', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel2.probe_lr=0.005', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1.probe_lr=0.005', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1_sentinel2.probe_lr=0.005', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1.probe_lr=0.005', '--trainer.callbacks.downstream_evaluator.tasks.sickle_landsat.probe_lr=0.005', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1_landsat.probe_lr=0.005', '--trainer.callbacks.downstream_evaluator.tasks.breizhcrops.probe_lr=0.005', '--trainer.load_path=/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets/step200000', '--launch.task_name=eval']
HeliosExperimentConfig(run_name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.005', launch=HeliosBeakerLaunchConfig(name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.005-train-bbb7c6d4', cmd=['scripts/2025_07_21_add_era5/eval.py', 'train', 'latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.005', 'ai2/saturn-cirrascale', '--launch.priority=high', '--trainer.callbacks.downstream_evaluator.tasks.m-cashew-plant.probe_lr=0.005', '--trainer.callbacks.downstream_evaluator.tasks.mados.probe_lr=0.005', '--trainer.callbacks.downstream_evaluator.tasks.sen1floods11.probe_lr=0.005', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel2.probe_lr=0.005', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1.probe_lr=0.005', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1_sentinel2.probe_lr=0.005', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1.probe_lr=0.005', '--trainer.callbacks.downstream_evaluator.tasks.sickle_landsat.probe_lr=0.005', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1_landsat.probe_lr=0.005', '--trainer.callbacks.downstream_evaluator.tasks.breizhcrops.probe_lr=0.005', '--trainer.load_path=/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets/step200000', '--launch.task_name=eval'], budget='ai2/es-platform', task_name='eval', workspace='ai2/earth-systems', description=None, setup_steps=['echo "$GCP_CREDENTIALS" > $GOOGLE_APPLICATION_CREDENTIALS', 'conda install gh --channel conda-forge', 'gh auth status', 'gh repo clone $REPO_URL .', 'git checkout "$GIT_REF"', 'git submodule update --init --recursive', 'conda shell.bash activate base', "pip install -e '.[all]'", '', 'pip freeze'], beaker_image='petew/olmo-core-tch270cu128', num_nodes=1, num_gpus=1, shared_memory='256GiB', clusters=['ai2/saturn-cirrascale'], shared_filesystem=True, priority=<Priority.high: 'high'>, preemptible=True, retries=None, env_vars=[BeakerEnvVar(name='NCCL_DEBUG', value='WARN'), BeakerEnvVar(name='TORCH_NCCL_TRACE_BUFFER_SIZE', value='0'), BeakerEnvVar(name='NCCL_BLOCKING_WAIT', value='0'), BeakerEnvVar(name='GOOGLE_APPLICATION_CREDENTIALS', value='/etc/gcp_credentials.json')], env_secrets=[BeakerEnvSecret(name='BEAKER_TOKEN', secret='yawenzzzz_BEAKER_TOKEN'), BeakerEnvSecret(name='WANDB_API_KEY', secret='yawenzzzz_WANDB_API_KEY'), BeakerEnvSecret(name='GITHUB_TOKEN', secret='yawenzzzz_GITHUB_TOKEN'), BeakerEnvSecret(name='GCP_CREDENTIALS', secret='HELIOS_GCP_CREDENTIALS')], nfs=False, weka_buckets=[BeakerWekaBucket(bucket='dfive-default', mount='/weka/dfive-default')], allow_dirty=False, host_networking=None, git=GitConfig(repo_url='https://github.com/allenai/helios', ref='ad34f8d9cc3af2794e41b5c6cdddefdba216e57d', branch=None), hostnames=None), model=LatentMIMConfig(encoder_config=EncoderConfig(supported_modality_names=['sentinel2_l2a', 'sentinel1', 'landsat'], embedding_size=768, max_patch_size=8, min_patch_size=1, num_heads=12, mlp_ratio=4.0, depth=12, drop_path=0.1, max_sequence_length=12, learnable_channel_embeddings=True, random_channel_embeddings=False, num_projection_layers=1, aggregate_then_project=True, use_flash_attn=False, frozen_patch_embeddings=False, qk_norm=False), decoder_config=PredictorConfig(supported_modality_names=['sentinel2_l2a', 'sentinel1', 'landsat'], encoder_embedding_size=768, decoder_embedding_size=768, depth=4, mlp_ratio=4.0, num_heads=12, max_sequence_length=12, drop_path=0.0, learnable_channel_embeddings=True, random_channel_embeddings=False, output_embedding_size=None, use_flash_attn=False, qk_norm=False), reconstructor_config=None), dataset=HeliosConcatDatasetConfig(dataset_configs=[HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/presto/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/469728', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/osm_sampling/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/1138828', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/osmbig/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/1291656', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/presto_neighbor/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/3507008', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/worldcover_sampling/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/5662848', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0)]), data_loader=HeliosDataLoaderConfig(work_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.005', global_batch_size=512, min_patch_size=1, max_patch_size=8, sampled_hw_p_list=[5, 6, 7, 8, 9, 10, 11, 12], seed=3622, token_budget=1500, shuffle=True, num_workers=16, prefetch_factor=4, target_device_type=None, drop_last=True, num_dataset_repeats_per_epoch=1), train_module=ContrastiveLatentMIMTrainModuleConfig(optim_config=AdamWConfig(group_overrides=None, compile=False, fixed_fields=['initial_lr'], lr=0.0001, betas=[0.9, 0.999], eps=1e-08, weight_decay=0.02, foreach=None, fused=True), rank_microbatch_size=64, transform_config=TransformConfig(transform_type='flip_and_rotate', transform_kwargs={}), compile_model=False, dp_config=DataParallelConfig(name='fsdp', param_dtype='bfloat16', reduce_dtype='float32', num_replicas=None, shard_degree=None), compile_loss=False, autocast_precision=None, max_grad_norm=1.0, scheduler=CosWithWarmup(lr_field='lr', initial_lr_field='initial_lr', warmup_steps=8000, warmup_fraction=None, alpha_f=0.1, t_max=None, warmup_min_lr=0.0), find_unused_parameters=True, state_dict_save_opts=None, state_dict_load_opts=None, regularizer_config=None, loss_config=LossConfig(loss_config={'type': 'modality_patch_discrimination_new', 'tau': 0.1}), mae_loss_config=None, masking_config=MaskingConfig(strategy_config={'type': 'modality_cross_random', 'encode_ratio': 0.5, 'decode_ratio': 0.5, 'allow_encoding_decoding_same_bandset': True}), token_exit_cfg={'sentinel2_l2a': 0, 'sentinel1': 0, 'landsat': 0}, ema_decay=[1.0, 1.0], contrastive_config=LossConfig(loss_config={'type': 'InfoNCE', 'weight': 0.1})), trainer=TrainerConfig(save_folder='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.005', work_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.005', load_path='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets/step200000', load_strategy='if_available', checkpointer=CheckpointerConfig(work_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.005', save_overwrite=None, pre_download=False, save_thread_count=None, load_thread_count=None, throttle_uploads=False), device=None, save_overwrite=False, max_duration=Duration(value=300, unit='epochs'), cancel_check_interval=1, hard_stop=None, metrics_collect_interval=10, callbacks={'wandb': HeliosWandBCallback(enabled=True, name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.005', project='2025_08_17_contrastive_eval', entity='eai-ai2', group=None, tags=None, notes=None, config=None, cancel_tags=['cancel', 'canceled', 'cancelled'], cancel_check_interval=None, upload_dataset_distribution_pre_train=True, upload_modality_data_band_distribution_pre_train=False, restart_on_same_run=True), 'speed_monitor': HeliosSpeedMonitorCallback(num_flops_per_token=None, device_peak_flops=None, _total_steps=0, _total_tokens=0, _start_time=0.0, _first_step=True, _step_last_logged=0.0, _batch_load_start=0.0, _batch_load_time=0.0, _step_tokens=0, _step_seq_len=0, _parallel_degree=1, _bps_avg=None), 'gpu_memory_monitor': GPUMemoryMonitorCallback(device_id=None, _num_alloc_retries=0), 'config_saver': ConfigSaverCallback(config=None, fname='config.json', save_data_paths=None, data_paths_fname=None), 'downstream_evaluator': DownstreamEvaluatorCallbackConfig(tasks={'m-eurosat': DownstreamTaskConfig(dataset='m-eurosat', embedding_batch_size=128, num_workers=0, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm-bigearthnet': DownstreamTaskConfig(dataset='m-bigearthnet', embedding_batch_size=64, num_workers=4, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm-so2sat': DownstreamTaskConfig(dataset='m-so2sat', embedding_batch_size=128, num_workers=4, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm-brick-kiln': DownstreamTaskConfig(dataset='m-brick-kiln', embedding_batch_size=128, num_workers=4, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'mados': DownstreamTaskConfig(dataset='mados', embedding_batch_size=128, num_workers=8, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=False, input_modalities=[], probe_lr=0.005, patch_size=4, probe_batch_size=128, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sen1floods11': DownstreamTaskConfig(dataset='sen1floods11', embedding_batch_size=128, num_workers=8, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.005, patch_size=4, probe_batch_size=128, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sickle_sentinel1': DownstreamTaskConfig(dataset='sickle', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1'], probe_lr=0.005, patch_size=4, probe_batch_size=16, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sickle_landsat': DownstreamTaskConfig(dataset='sickle', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['landsat'], probe_lr=0.005, patch_size=4, probe_batch_size=16, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sickle_sentinel1_landsat': DownstreamTaskConfig(dataset='sickle', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1', 'landsat'], probe_lr=0.005, patch_size=4, probe_batch_size=16, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm_sa_crop_type': DownstreamTaskConfig(dataset='m-sa-crop-type', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.1, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm_cashew_plant': DownstreamTaskConfig(dataset='m-cashew-plant', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.005, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'pastis_sentinel2': DownstreamTaskConfig(dataset='pastis', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel2_l2a'], probe_lr=0.005, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=50, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'pastis_sentinel1': DownstreamTaskConfig(dataset='pastis', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1'], probe_lr=0.005, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=50, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'pastis_sentinel1_sentinel2': DownstreamTaskConfig(dataset='pastis', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1', 'sentinel2_l2a'], probe_lr=0.005, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=20, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'breizhcrops': DownstreamTaskConfig(dataset='breizhcrops', embedding_batch_size=128, num_workers=8, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.005, patch_size=1, probe_batch_size=128, epochs=50, eval_interval=Duration(value=50, unit='epochs'), eval_mode='linear_probe', probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP')}, enabled=True, eval_on_startup=True, cancel_after_first_eval=True), 'garbage_collector': GarbageCollectorCallback(gc_interval=1, enabled=True, _start_state=None), 'beaker': BeakerCallback(experiment_id=None, update_interval=None, description=None, enabled=None, _last_update=None), 'checkpointer': CheckpointerCallback(save_interval=5000, ephemeral_save_interval=250, pre_train_checkpoint=None, save_async=None, remove='ephemeral_only', enabled=True, _latest_checkpoint_step=-1, _latest_checkpoint_path='', _checkpoints=[], _ephemeral_checkpoints=[], _checkpoints_to_remove=[])}, async_bookkeeping=None, no_checkpoints=False, no_evals=False), visualize=HeliosVisualizeConfig(output_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.005/visualizations', num_samples=None, global_step=None, std_multiplier=2.0), init_seed=12536)
2025-08-17 13:30:19.837	saturn-cs-aus-233.reviz.ai2.in:0	helios.internal.experiment:210	INFO	Launching the experiment
2025-08-17 13:30:19.837	saturn-cs-aus-233.reviz.ai2.in:0	helios.internal.experiment:211	INFO	HeliosExperimentConfig(run_name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.005', launch=HeliosBeakerLaunchConfig(name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.005-train-bbb7c6d4', cmd=['scripts/2025_07_21_add_era5/eval.py', 'train', 'latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.005', 'ai2/saturn-cirrascale', '--launch.priority=high', '--trainer.callbacks.downstream_evaluator.tasks.m-cashew-plant.probe_lr=0.005', '--trainer.callbacks.downstream_evaluator.tasks.mados.probe_lr=0.005', '--trainer.callbacks.downstream_evaluator.tasks.sen1floods11.probe_lr=0.005', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel2.probe_lr=0.005', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1.probe_lr=0.005', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1_sentinel2.probe_lr=0.005', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1.probe_lr=0.005', '--trainer.callbacks.downstream_evaluator.tasks.sickle_landsat.probe_lr=0.005', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1_landsat.probe_lr=0.005', '--trainer.callbacks.downstream_evaluator.tasks.breizhcrops.probe_lr=0.005', '--trainer.load_path=/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets/step200000', '--launch.task_name=eval'], budget='ai2/es-platform', task_name='eval', workspace='ai2/earth-systems', description=None, setup_steps=['echo "$GCP_CREDENTIALS" > $GOOGLE_APPLICATION_CREDENTIALS', 'conda install gh --channel conda-forge', 'gh auth status', 'gh repo clone $REPO_URL .', 'git checkout "$GIT_REF"', 'git submodule update --init --recursive', 'conda shell.bash activate base', "pip install -e '.[all]'", '', 'pip freeze'], beaker_image='petew/olmo-core-tch270cu128', num_nodes=1, num_gpus=1, shared_memory='256GiB', clusters=['ai2/saturn-cirrascale'], shared_filesystem=True, priority=<Priority.high: 'high'>, preemptible=True, retries=None, env_vars=[BeakerEnvVar(name='NCCL_DEBUG', value='WARN'), BeakerEnvVar(name='TORCH_NCCL_TRACE_BUFFER_SIZE', value='0'), BeakerEnvVar(name='NCCL_BLOCKING_WAIT', value='0'), BeakerEnvVar(name='GOOGLE_APPLICATION_CREDENTIALS', value='/etc/gcp_credentials.json')], env_secrets=[BeakerEnvSecret(name='BEAKER_TOKEN', secret='yawenzzzz_BEAKER_TOKEN'), BeakerEnvSecret(name='WANDB_API_KEY', secret='yawenzzzz_WANDB_API_KEY'), BeakerEnvSecret(name='GITHUB_TOKEN', secret='yawenzzzz_GITHUB_TOKEN'), BeakerEnvSecret(name='GCP_CREDENTIALS', secret='HELIOS_GCP_CREDENTIALS')], nfs=False, weka_buckets=[BeakerWekaBucket(bucket='dfive-default', mount='/weka/dfive-default')], allow_dirty=False, host_networking=None, git=GitConfig(repo_url='https://github.com/allenai/helios', ref='ad34f8d9cc3af2794e41b5c6cdddefdba216e57d', branch=None), hostnames=None), model=LatentMIMConfig(encoder_config=EncoderConfig(supported_modality_names=['sentinel2_l2a', 'sentinel1', 'landsat'], embedding_size=768, max_patch_size=8, min_patch_size=1, num_heads=12, mlp_ratio=4.0, depth=12, drop_path=0.1, max_sequence_length=12, learnable_channel_embeddings=True, random_channel_embeddings=False, num_projection_layers=1, aggregate_then_project=True, use_flash_attn=False, frozen_patch_embeddings=False, qk_norm=False), decoder_config=PredictorConfig(supported_modality_names=['sentinel2_l2a', 'sentinel1', 'landsat'], encoder_embedding_size=768, decoder_embedding_size=768, depth=4, mlp_ratio=4.0, num_heads=12, max_sequence_length=12, drop_path=0.0, learnable_channel_embeddings=True, random_channel_embeddings=False, output_embedding_size=None, use_flash_attn=False, qk_norm=False), reconstructor_config=None), dataset=HeliosConcatDatasetConfig(dataset_configs=[HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/presto/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/469728', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/osm_sampling/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/1138828', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/osmbig/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/1291656', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/presto_neighbor/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/3507008', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/worldcover_sampling/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/5662848', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0)]), data_loader=HeliosDataLoaderConfig(work_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.005', global_batch_size=512, min_patch_size=1, max_patch_size=8, sampled_hw_p_list=[5, 6, 7, 8, 9, 10, 11, 12], seed=3622, token_budget=1500, shuffle=True, num_workers=16, prefetch_factor=4, target_device_type=None, drop_last=True, num_dataset_repeats_per_epoch=1), train_module=ContrastiveLatentMIMTrainModuleConfig(optim_config=AdamWConfig(group_overrides=None, compile=False, fixed_fields=['initial_lr'], lr=0.0001, betas=[0.9, 0.999], eps=1e-08, weight_decay=0.02, foreach=None, fused=True), rank_microbatch_size=64, transform_config=TransformConfig(transform_type='flip_and_rotate', transform_kwargs={}), compile_model=False, dp_config=DataParallelConfig(name='fsdp', param_dtype='bfloat16', reduce_dtype='float32', num_replicas=None, shard_degree=None), compile_loss=False, autocast_precision=None, max_grad_norm=1.0, scheduler=CosWithWarmup(lr_field='lr', initial_lr_field='initial_lr', warmup_steps=8000, warmup_fraction=None, alpha_f=0.1, t_max=None, warmup_min_lr=0.0), find_unused_parameters=True, state_dict_save_opts=None, state_dict_load_opts=None, regularizer_config=None, loss_config=LossConfig(loss_config={'type': 'modality_patch_discrimination_new', 'tau': 0.1}), mae_loss_config=None, masking_config=MaskingConfig(strategy_config={'type': 'modality_cross_random', 'encode_ratio': 0.5, 'decode_ratio': 0.5, 'allow_encoding_decoding_same_bandset': True}), token_exit_cfg={'sentinel2_l2a': 0, 'sentinel1': 0, 'landsat': 0}, ema_decay=[1.0, 1.0], contrastive_config=LossConfig(loss_config={'type': 'InfoNCE', 'weight': 0.1})), trainer=TrainerConfig(save_folder='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.005', work_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.005', load_path='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets/step200000', load_strategy='if_available', checkpointer=CheckpointerConfig(work_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.005', save_overwrite=None, pre_download=False, save_thread_count=None, load_thread_count=None, throttle_uploads=False), device=None, save_overwrite=False, max_duration=Duration(value=300, unit='epochs'), cancel_check_interval=1, hard_stop=None, metrics_collect_interval=10, callbacks={'wandb': HeliosWandBCallback(enabled=True, name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.005', project='2025_08_17_contrastive_eval', entity='eai-ai2', group=None, tags=None, notes=None, config=None, cancel_tags=['cancel', 'canceled', 'cancelled'], cancel_check_interval=None, upload_dataset_distribution_pre_train=True, upload_modality_data_band_distribution_pre_train=False, restart_on_same_run=True), 'speed_monitor': HeliosSpeedMonitorCallback(num_flops_per_token=None, device_peak_flops=None, _total_steps=0, _total_tokens=0, _start_time=0.0, _first_step=True, _step_last_logged=0.0, _batch_load_start=0.0, _batch_load_time=0.0, _step_tokens=0, _step_seq_len=0, _parallel_degree=1, _bps_avg=None), 'gpu_memory_monitor': GPUMemoryMonitorCallback(device_id=None, _num_alloc_retries=0), 'config_saver': ConfigSaverCallback(config=None, fname='config.json', save_data_paths=None, data_paths_fname=None), 'downstream_evaluator': DownstreamEvaluatorCallbackConfig(tasks={'m-eurosat': DownstreamTaskConfig(dataset='m-eurosat', embedding_batch_size=128, num_workers=0, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm-bigearthnet': DownstreamTaskConfig(dataset='m-bigearthnet', embedding_batch_size=64, num_workers=4, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm-so2sat': DownstreamTaskConfig(dataset='m-so2sat', embedding_batch_size=128, num_workers=4, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm-brick-kiln': DownstreamTaskConfig(dataset='m-brick-kiln', embedding_batch_size=128, num_workers=4, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'mados': DownstreamTaskConfig(dataset='mados', embedding_batch_size=128, num_workers=8, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=False, input_modalities=[], probe_lr=0.005, patch_size=4, probe_batch_size=128, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sen1floods11': DownstreamTaskConfig(dataset='sen1floods11', embedding_batch_size=128, num_workers=8, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.005, patch_size=4, probe_batch_size=128, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sickle_sentinel1': DownstreamTaskConfig(dataset='sickle', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1'], probe_lr=0.005, patch_size=4, probe_batch_size=16, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sickle_landsat': DownstreamTaskConfig(dataset='sickle', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['landsat'], probe_lr=0.005, patch_size=4, probe_batch_size=16, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sickle_sentinel1_landsat': DownstreamTaskConfig(dataset='sickle', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1', 'landsat'], probe_lr=0.005, patch_size=4, probe_batch_size=16, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm_sa_crop_type': DownstreamTaskConfig(dataset='m-sa-crop-type', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.1, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm_cashew_plant': DownstreamTaskConfig(dataset='m-cashew-plant', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.005, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'pastis_sentinel2': DownstreamTaskConfig(dataset='pastis', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel2_l2a'], probe_lr=0.005, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=50, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'pastis_sentinel1': DownstreamTaskConfig(dataset='pastis', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1'], probe_lr=0.005, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=50, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'pastis_sentinel1_sentinel2': DownstreamTaskConfig(dataset='pastis', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1', 'sentinel2_l2a'], probe_lr=0.005, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=20, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'breizhcrops': DownstreamTaskConfig(dataset='breizhcrops', embedding_batch_size=128, num_workers=8, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.005, patch_size=1, probe_batch_size=128, epochs=50, eval_interval=Duration(value=50, unit='epochs'), eval_mode='linear_probe', probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP')}, enabled=True, eval_on_startup=True, cancel_after_first_eval=True), 'garbage_collector': GarbageCollectorCallback(gc_interval=1, enabled=True, _start_state=None), 'beaker': BeakerCallback(experiment_id=None, update_interval=None, description=None, enabled=None, _last_update=None), 'checkpointer': CheckpointerCallback(save_interval=5000, ephemeral_save_interval=250, pre_train_checkpoint=None, save_async=None, remove='ephemeral_only', enabled=True, _latest_checkpoint_step=-1, _latest_checkpoint_path='', _checkpoints=[], _ephemeral_checkpoints=[], _checkpoints_to_remove=[])}, async_bookkeeping=None, no_checkpoints=False, no_evals=False), visualize=HeliosVisualizeConfig(output_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.005/visualizations', num_samples=None, global_step=None, std_multiplier=2.0), init_seed=12536)
2025-08-17 13:30:20.780	saturn-cs-aus-233.reviz.ai2.in:0	py.warnings:109	WARNING	/weka/dfive-default/yawenz/.venv-helios-py310/lib/python3.10/site-packages/beaker/util.py:25: RuntimeWarning: Found unknown field 'budget: 01HPM52AQC6C0TZV32E7WDDGDJ' for data model 'Workspace'. This may be a newly added field that hasn't been defined in beaker-py yet. Please submit an issue report about this here:
https://github.com/allenai/beaker-py/issues/new?assignees=&labels=bug&template=bug_report.yml
  warnings.warn(

2025-08-17 13:30:24.490	saturn-cs-aus-233.reviz.ai2.in:0	olmo_core.launch.beaker:513	INFO	Experiment submitted, see progress at https://beaker.org/ex/01K2WVKRWH99ZD581V7A9QH3Y4
--trainer.callbacks.downstream_evaluator.tasks.m-cashew-plant.probe_lr=0.0001 --trainer.callbacks.downstream_evaluator.tasks.mados.probe_lr=0.0001 --trainer.callbacks.downstream_evaluator.tasks.sen1floods11.probe_lr=0.0001 --trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel2.probe_lr=0.0001 --trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1.probe_lr=0.0001 --trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1_sentinel2.probe_lr=0.0001 --trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1.probe_lr=0.0001 --trainer.callbacks.downstream_evaluator.tasks.sickle_landsat.probe_lr=0.0001 --trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1_landsat.probe_lr=0.0001 --trainer.callbacks.downstream_evaluator.tasks.breizhcrops.probe_lr=0.0001
python3 scripts/2025_07_21_add_era5/eval.py launch latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.0001 ai2/saturn-cirrascale --launch.priority=high --trainer.callbacks.downstream_evaluator.tasks.m-cashew-plant.probe_lr=0.0001 --trainer.callbacks.downstream_evaluator.tasks.mados.probe_lr=0.0001 --trainer.callbacks.downstream_evaluator.tasks.sen1floods11.probe_lr=0.0001 --trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel2.probe_lr=0.0001 --trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1.probe_lr=0.0001 --trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1_sentinel2.probe_lr=0.0001 --trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1.probe_lr=0.0001 --trainer.callbacks.downstream_evaluator.tasks.sickle_landsat.probe_lr=0.0001 --trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1_landsat.probe_lr=0.0001 --trainer.callbacks.downstream_evaluator.tasks.breizhcrops.probe_lr=0.0001 --trainer.load_path=/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets/step200000 --launch.task_name=eval
--trainer.callbacks.downstream_evaluator.tasks.m-cashew-plant.probe_lr=0.0005 --trainer.callbacks.downstream_evaluator.tasks.mados.probe_lr=0.0005 --trainer.callbacks.downstream_evaluator.tasks.sen1floods11.probe_lr=0.0005 --trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel2.probe_lr=0.0005 --trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1.probe_lr=0.0005 --trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1_sentinel2.probe_lr=0.0005 --trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1.probe_lr=0.0005 --trainer.callbacks.downstream_evaluator.tasks.sickle_landsat.probe_lr=0.0005 --trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1_landsat.probe_lr=0.0005 --trainer.callbacks.downstream_evaluator.tasks.breizhcrops.probe_lr=0.0005
python3 scripts/2025_07_21_add_era5/eval.py launch latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.0005 ai2/saturn-cirrascale --launch.priority=high --trainer.callbacks.downstream_evaluator.tasks.m-cashew-plant.probe_lr=0.0005 --trainer.callbacks.downstream_evaluator.tasks.mados.probe_lr=0.0005 --trainer.callbacks.downstream_evaluator.tasks.sen1floods11.probe_lr=0.0005 --trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel2.probe_lr=0.0005 --trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1.probe_lr=0.0005 --trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1_sentinel2.probe_lr=0.0005 --trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1.probe_lr=0.0005 --trainer.callbacks.downstream_evaluator.tasks.sickle_landsat.probe_lr=0.0005 --trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1_landsat.probe_lr=0.0005 --trainer.callbacks.downstream_evaluator.tasks.breizhcrops.probe_lr=0.0005 --trainer.load_path=/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets/step200000 --launch.task_name=eval
--trainer.callbacks.downstream_evaluator.tasks.m-cashew-plant.probe_lr=0.001 --trainer.callbacks.downstream_evaluator.tasks.mados.probe_lr=0.001 --trainer.callbacks.downstream_evaluator.tasks.sen1floods11.probe_lr=0.001 --trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel2.probe_lr=0.001 --trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1.probe_lr=0.001 --trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1_sentinel2.probe_lr=0.001 --trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1.probe_lr=0.001 --trainer.callbacks.downstream_evaluator.tasks.sickle_landsat.probe_lr=0.001 --trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1_landsat.probe_lr=0.001 --trainer.callbacks.downstream_evaluator.tasks.breizhcrops.probe_lr=0.001
python3 scripts/2025_07_21_add_era5/eval.py launch latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.001 ai2/saturn-cirrascale --launch.priority=high --trainer.callbacks.downstream_evaluator.tasks.m-cashew-plant.probe_lr=0.001 --trainer.callbacks.downstream_evaluator.tasks.mados.probe_lr=0.001 --trainer.callbacks.downstream_evaluator.tasks.sen1floods11.probe_lr=0.001 --trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel2.probe_lr=0.001 --trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1.probe_lr=0.001 --trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1_sentinel2.probe_lr=0.001 --trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1.probe_lr=0.001 --trainer.callbacks.downstream_evaluator.tasks.sickle_landsat.probe_lr=0.001 --trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1_landsat.probe_lr=0.001 --trainer.callbacks.downstream_evaluator.tasks.breizhcrops.probe_lr=0.001 --trainer.load_path=/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets/step200000 --launch.task_name=eval
--trainer.callbacks.downstream_evaluator.tasks.m-cashew-plant.probe_lr=0.005 --trainer.callbacks.downstream_evaluator.tasks.mados.probe_lr=0.005 --trainer.callbacks.downstream_evaluator.tasks.sen1floods11.probe_lr=0.005 --trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel2.probe_lr=0.005 --trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1.probe_lr=0.005 --trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1_sentinel2.probe_lr=0.005 --trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1.probe_lr=0.005 --trainer.callbacks.downstream_evaluator.tasks.sickle_landsat.probe_lr=0.005 --trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1_landsat.probe_lr=0.005 --trainer.callbacks.downstream_evaluator.tasks.breizhcrops.probe_lr=0.005
python3 scripts/2025_07_21_add_era5/eval.py launch latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.005 ai2/saturn-cirrascale --launch.priority=high --trainer.callbacks.downstream_evaluator.tasks.m-cashew-plant.probe_lr=0.005 --trainer.callbacks.downstream_evaluator.tasks.mados.probe_lr=0.005 --trainer.callbacks.downstream_evaluator.tasks.sen1floods11.probe_lr=0.005 --trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel2.probe_lr=0.005 --trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1.probe_lr=0.005 --trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1_sentinel2.probe_lr=0.005 --trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1.probe_lr=0.005 --trainer.callbacks.downstream_evaluator.tasks.sickle_landsat.probe_lr=0.005 --trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1_landsat.probe_lr=0.005 --trainer.callbacks.downstream_evaluator.tasks.breizhcrops.probe_lr=0.005 --trainer.load_path=/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets/step200000 --launch.task_name=eval
2025-08-17 13:30:35.209	saturn-cs-aus-233.reviz.ai2.in:0	olmo_core.utils:200	INFO	Setting env var 'OMP_NUM_THREADS' to '8'
2025-08-17 13:30:35.209	saturn-cs-aus-233.reviz.ai2.in:0	olmo_core.utils:200	INFO	Setting env var 'TOKENIZERS_PARALLELISM' to 'false'
2025-08-17 13:30:35.209	saturn-cs-aus-233.reviz.ai2.in:0	helios.internal.experiment:135	INFO	Common overrides: []
2025-08-17 13:30:35.226	saturn-cs-aus-233.reviz.ai2.in:0	helios.internal.experiment:137	INFO	Common: CommonComponents(run_name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.01', save_folder='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.01', launch=HeliosBeakerLaunchConfig(name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.01-train-b8e1b951', cmd=['scripts/2025_07_21_add_era5/eval.py', 'train', 'latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.01', 'ai2/saturn-cirrascale', '--launch.priority=high', '--trainer.callbacks.downstream_evaluator.tasks.m-cashew-plant.probe_lr=0.01', '--trainer.callbacks.downstream_evaluator.tasks.mados.probe_lr=0.01', '--trainer.callbacks.downstream_evaluator.tasks.sen1floods11.probe_lr=0.01', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel2.probe_lr=0.01', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1.probe_lr=0.01', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1_sentinel2.probe_lr=0.01', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1.probe_lr=0.01', '--trainer.callbacks.downstream_evaluator.tasks.sickle_landsat.probe_lr=0.01', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1_landsat.probe_lr=0.01', '--trainer.callbacks.downstream_evaluator.tasks.breizhcrops.probe_lr=0.01', '--trainer.load_path=/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets/step200000', '--launch.task_name=eval'], budget='ai2/es-platform', task_name='train', workspace='ai2/earth-systems', description=None, setup_steps=['echo "$GCP_CREDENTIALS" > $GOOGLE_APPLICATION_CREDENTIALS', 'conda install gh --channel conda-forge', 'gh auth status', 'gh repo clone $REPO_URL .', 'git checkout "$GIT_REF"', 'git submodule update --init --recursive', 'conda shell.bash activate base', "pip install -e '.[all]'", '', 'pip freeze'], beaker_image='petew/olmo-core-tch270cu128', num_nodes=1, num_gpus=1, shared_memory='256GiB', clusters=['ai2/saturn-cirrascale'], shared_filesystem=True, priority=<Priority.high: 'high'>, preemptible=True, retries=None, env_vars=[BeakerEnvVar(name='NCCL_DEBUG', value='WARN'), BeakerEnvVar(name='TORCH_NCCL_TRACE_BUFFER_SIZE', value='0'), BeakerEnvVar(name='NCCL_BLOCKING_WAIT', value='0'), BeakerEnvVar(name='GOOGLE_APPLICATION_CREDENTIALS', value='/etc/gcp_credentials.json')], env_secrets=[BeakerEnvSecret(name='BEAKER_TOKEN', secret='yawenzzzz_BEAKER_TOKEN'), BeakerEnvSecret(name='WANDB_API_KEY', secret='yawenzzzz_WANDB_API_KEY'), BeakerEnvSecret(name='GITHUB_TOKEN', secret='yawenzzzz_GITHUB_TOKEN'), BeakerEnvSecret(name='GCP_CREDENTIALS', secret='HELIOS_GCP_CREDENTIALS')], nfs=False, weka_buckets=[BeakerWekaBucket(bucket='dfive-default', mount='/weka/dfive-default')], allow_dirty=False, host_networking=None, git=GitConfig(repo_url='https://github.com/allenai/helios', ref='ad34f8d9cc3af2794e41b5c6cdddefdba216e57d', branch=None), hostnames=None), training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dataset_percentage=1.0, nccl_debug=False)
2025-08-17 13:30:35.231	saturn-cs-aus-233.reviz.ai2.in:0	helios.internal.experiment:156	INFO	Overrides: ['--launch.priority=high', '--trainer.callbacks.downstream_evaluator.tasks.m-cashew-plant.probe_lr=0.01', '--trainer.callbacks.downstream_evaluator.tasks.mados.probe_lr=0.01', '--trainer.callbacks.downstream_evaluator.tasks.sen1floods11.probe_lr=0.01', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel2.probe_lr=0.01', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1.probe_lr=0.01', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1_sentinel2.probe_lr=0.01', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1.probe_lr=0.01', '--trainer.callbacks.downstream_evaluator.tasks.sickle_landsat.probe_lr=0.01', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1_landsat.probe_lr=0.01', '--trainer.callbacks.downstream_evaluator.tasks.breizhcrops.probe_lr=0.01', '--trainer.load_path=/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets/step200000', '--launch.task_name=eval']
HeliosExperimentConfig(run_name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.01', launch=HeliosBeakerLaunchConfig(name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.01-train-b8e1b951', cmd=['scripts/2025_07_21_add_era5/eval.py', 'train', 'latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.01', 'ai2/saturn-cirrascale', '--launch.priority=high', '--trainer.callbacks.downstream_evaluator.tasks.m-cashew-plant.probe_lr=0.01', '--trainer.callbacks.downstream_evaluator.tasks.mados.probe_lr=0.01', '--trainer.callbacks.downstream_evaluator.tasks.sen1floods11.probe_lr=0.01', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel2.probe_lr=0.01', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1.probe_lr=0.01', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1_sentinel2.probe_lr=0.01', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1.probe_lr=0.01', '--trainer.callbacks.downstream_evaluator.tasks.sickle_landsat.probe_lr=0.01', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1_landsat.probe_lr=0.01', '--trainer.callbacks.downstream_evaluator.tasks.breizhcrops.probe_lr=0.01', '--trainer.load_path=/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets/step200000', '--launch.task_name=eval'], budget='ai2/es-platform', task_name='eval', workspace='ai2/earth-systems', description=None, setup_steps=['echo "$GCP_CREDENTIALS" > $GOOGLE_APPLICATION_CREDENTIALS', 'conda install gh --channel conda-forge', 'gh auth status', 'gh repo clone $REPO_URL .', 'git checkout "$GIT_REF"', 'git submodule update --init --recursive', 'conda shell.bash activate base', "pip install -e '.[all]'", '', 'pip freeze'], beaker_image='petew/olmo-core-tch270cu128', num_nodes=1, num_gpus=1, shared_memory='256GiB', clusters=['ai2/saturn-cirrascale'], shared_filesystem=True, priority=<Priority.high: 'high'>, preemptible=True, retries=None, env_vars=[BeakerEnvVar(name='NCCL_DEBUG', value='WARN'), BeakerEnvVar(name='TORCH_NCCL_TRACE_BUFFER_SIZE', value='0'), BeakerEnvVar(name='NCCL_BLOCKING_WAIT', value='0'), BeakerEnvVar(name='GOOGLE_APPLICATION_CREDENTIALS', value='/etc/gcp_credentials.json')], env_secrets=[BeakerEnvSecret(name='BEAKER_TOKEN', secret='yawenzzzz_BEAKER_TOKEN'), BeakerEnvSecret(name='WANDB_API_KEY', secret='yawenzzzz_WANDB_API_KEY'), BeakerEnvSecret(name='GITHUB_TOKEN', secret='yawenzzzz_GITHUB_TOKEN'), BeakerEnvSecret(name='GCP_CREDENTIALS', secret='HELIOS_GCP_CREDENTIALS')], nfs=False, weka_buckets=[BeakerWekaBucket(bucket='dfive-default', mount='/weka/dfive-default')], allow_dirty=False, host_networking=None, git=GitConfig(repo_url='https://github.com/allenai/helios', ref='ad34f8d9cc3af2794e41b5c6cdddefdba216e57d', branch=None), hostnames=None), model=LatentMIMConfig(encoder_config=EncoderConfig(supported_modality_names=['sentinel2_l2a', 'sentinel1', 'landsat'], embedding_size=768, max_patch_size=8, min_patch_size=1, num_heads=12, mlp_ratio=4.0, depth=12, drop_path=0.1, max_sequence_length=12, learnable_channel_embeddings=True, random_channel_embeddings=False, num_projection_layers=1, aggregate_then_project=True, use_flash_attn=False, frozen_patch_embeddings=False, qk_norm=False), decoder_config=PredictorConfig(supported_modality_names=['sentinel2_l2a', 'sentinel1', 'landsat'], encoder_embedding_size=768, decoder_embedding_size=768, depth=4, mlp_ratio=4.0, num_heads=12, max_sequence_length=12, drop_path=0.0, learnable_channel_embeddings=True, random_channel_embeddings=False, output_embedding_size=None, use_flash_attn=False, qk_norm=False), reconstructor_config=None), dataset=HeliosConcatDatasetConfig(dataset_configs=[HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/presto/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/469728', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/osm_sampling/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/1138828', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/osmbig/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/1291656', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/presto_neighbor/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/3507008', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/worldcover_sampling/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/5662848', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0)]), data_loader=HeliosDataLoaderConfig(work_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.01', global_batch_size=512, min_patch_size=1, max_patch_size=8, sampled_hw_p_list=[5, 6, 7, 8, 9, 10, 11, 12], seed=3622, token_budget=1500, shuffle=True, num_workers=16, prefetch_factor=4, target_device_type=None, drop_last=True, num_dataset_repeats_per_epoch=1), train_module=ContrastiveLatentMIMTrainModuleConfig(optim_config=AdamWConfig(group_overrides=None, compile=False, fixed_fields=['initial_lr'], lr=0.0001, betas=[0.9, 0.999], eps=1e-08, weight_decay=0.02, foreach=None, fused=True), rank_microbatch_size=64, transform_config=TransformConfig(transform_type='flip_and_rotate', transform_kwargs={}), compile_model=False, dp_config=DataParallelConfig(name='fsdp', param_dtype='bfloat16', reduce_dtype='float32', num_replicas=None, shard_degree=None), compile_loss=False, autocast_precision=None, max_grad_norm=1.0, scheduler=CosWithWarmup(lr_field='lr', initial_lr_field='initial_lr', warmup_steps=8000, warmup_fraction=None, alpha_f=0.1, t_max=None, warmup_min_lr=0.0), find_unused_parameters=True, state_dict_save_opts=None, state_dict_load_opts=None, regularizer_config=None, loss_config=LossConfig(loss_config={'type': 'modality_patch_discrimination_new', 'tau': 0.1}), mae_loss_config=None, masking_config=MaskingConfig(strategy_config={'type': 'modality_cross_random', 'encode_ratio': 0.5, 'decode_ratio': 0.5, 'allow_encoding_decoding_same_bandset': True}), token_exit_cfg={'sentinel2_l2a': 0, 'sentinel1': 0, 'landsat': 0}, ema_decay=[1.0, 1.0], contrastive_config=LossConfig(loss_config={'type': 'InfoNCE', 'weight': 0.1})), trainer=TrainerConfig(save_folder='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.01', work_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.01', load_path='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets/step200000', load_strategy='if_available', checkpointer=CheckpointerConfig(work_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.01', save_overwrite=None, pre_download=False, save_thread_count=None, load_thread_count=None, throttle_uploads=False), device=None, save_overwrite=False, max_duration=Duration(value=300, unit='epochs'), cancel_check_interval=1, hard_stop=None, metrics_collect_interval=10, callbacks={'wandb': HeliosWandBCallback(enabled=True, name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.01', project='2025_08_17_contrastive_eval', entity='eai-ai2', group=None, tags=None, notes=None, config=None, cancel_tags=['cancel', 'canceled', 'cancelled'], cancel_check_interval=None, upload_dataset_distribution_pre_train=True, upload_modality_data_band_distribution_pre_train=False, restart_on_same_run=True), 'speed_monitor': HeliosSpeedMonitorCallback(num_flops_per_token=None, device_peak_flops=None, _total_steps=0, _total_tokens=0, _start_time=0.0, _first_step=True, _step_last_logged=0.0, _batch_load_start=0.0, _batch_load_time=0.0, _step_tokens=0, _step_seq_len=0, _parallel_degree=1, _bps_avg=None), 'gpu_memory_monitor': GPUMemoryMonitorCallback(device_id=None, _num_alloc_retries=0), 'config_saver': ConfigSaverCallback(config=None, fname='config.json', save_data_paths=None, data_paths_fname=None), 'downstream_evaluator': DownstreamEvaluatorCallbackConfig(tasks={'m-eurosat': DownstreamTaskConfig(dataset='m-eurosat', embedding_batch_size=128, num_workers=0, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm-bigearthnet': DownstreamTaskConfig(dataset='m-bigearthnet', embedding_batch_size=64, num_workers=4, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm-so2sat': DownstreamTaskConfig(dataset='m-so2sat', embedding_batch_size=128, num_workers=4, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm-brick-kiln': DownstreamTaskConfig(dataset='m-brick-kiln', embedding_batch_size=128, num_workers=4, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'mados': DownstreamTaskConfig(dataset='mados', embedding_batch_size=128, num_workers=8, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=False, input_modalities=[], probe_lr=0.01, patch_size=4, probe_batch_size=128, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sen1floods11': DownstreamTaskConfig(dataset='sen1floods11', embedding_batch_size=128, num_workers=8, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.01, patch_size=4, probe_batch_size=128, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sickle_sentinel1': DownstreamTaskConfig(dataset='sickle', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1'], probe_lr=0.01, patch_size=4, probe_batch_size=16, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sickle_landsat': DownstreamTaskConfig(dataset='sickle', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['landsat'], probe_lr=0.01, patch_size=4, probe_batch_size=16, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sickle_sentinel1_landsat': DownstreamTaskConfig(dataset='sickle', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1', 'landsat'], probe_lr=0.01, patch_size=4, probe_batch_size=16, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm_sa_crop_type': DownstreamTaskConfig(dataset='m-sa-crop-type', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.1, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm_cashew_plant': DownstreamTaskConfig(dataset='m-cashew-plant', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.01, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'pastis_sentinel2': DownstreamTaskConfig(dataset='pastis', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel2_l2a'], probe_lr=0.01, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=50, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'pastis_sentinel1': DownstreamTaskConfig(dataset='pastis', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1'], probe_lr=0.01, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=50, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'pastis_sentinel1_sentinel2': DownstreamTaskConfig(dataset='pastis', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1', 'sentinel2_l2a'], probe_lr=0.01, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=20, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'breizhcrops': DownstreamTaskConfig(dataset='breizhcrops', embedding_batch_size=128, num_workers=8, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.01, patch_size=1, probe_batch_size=128, epochs=50, eval_interval=Duration(value=50, unit='epochs'), eval_mode='linear_probe', probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP')}, enabled=True, eval_on_startup=True, cancel_after_first_eval=True), 'garbage_collector': GarbageCollectorCallback(gc_interval=1, enabled=True, _start_state=None), 'beaker': BeakerCallback(experiment_id=None, update_interval=None, description=None, enabled=None, _last_update=None), 'checkpointer': CheckpointerCallback(save_interval=5000, ephemeral_save_interval=250, pre_train_checkpoint=None, save_async=None, remove='ephemeral_only', enabled=True, _latest_checkpoint_step=-1, _latest_checkpoint_path='', _checkpoints=[], _ephemeral_checkpoints=[], _checkpoints_to_remove=[])}, async_bookkeeping=None, no_checkpoints=False, no_evals=False), visualize=HeliosVisualizeConfig(output_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.01/visualizations', num_samples=None, global_step=None, std_multiplier=2.0), init_seed=12536)
2025-08-17 13:30:35.396	saturn-cs-aus-233.reviz.ai2.in:0	helios.internal.experiment:210	INFO	Launching the experiment
2025-08-17 13:30:35.397	saturn-cs-aus-233.reviz.ai2.in:0	helios.internal.experiment:211	INFO	HeliosExperimentConfig(run_name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.01', launch=HeliosBeakerLaunchConfig(name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.01-train-b8e1b951', cmd=['scripts/2025_07_21_add_era5/eval.py', 'train', 'latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.01', 'ai2/saturn-cirrascale', '--launch.priority=high', '--trainer.callbacks.downstream_evaluator.tasks.m-cashew-plant.probe_lr=0.01', '--trainer.callbacks.downstream_evaluator.tasks.mados.probe_lr=0.01', '--trainer.callbacks.downstream_evaluator.tasks.sen1floods11.probe_lr=0.01', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel2.probe_lr=0.01', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1.probe_lr=0.01', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1_sentinel2.probe_lr=0.01', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1.probe_lr=0.01', '--trainer.callbacks.downstream_evaluator.tasks.sickle_landsat.probe_lr=0.01', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1_landsat.probe_lr=0.01', '--trainer.callbacks.downstream_evaluator.tasks.breizhcrops.probe_lr=0.01', '--trainer.load_path=/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets/step200000', '--launch.task_name=eval'], budget='ai2/es-platform', task_name='eval', workspace='ai2/earth-systems', description=None, setup_steps=['echo "$GCP_CREDENTIALS" > $GOOGLE_APPLICATION_CREDENTIALS', 'conda install gh --channel conda-forge', 'gh auth status', 'gh repo clone $REPO_URL .', 'git checkout "$GIT_REF"', 'git submodule update --init --recursive', 'conda shell.bash activate base', "pip install -e '.[all]'", '', 'pip freeze'], beaker_image='petew/olmo-core-tch270cu128', num_nodes=1, num_gpus=1, shared_memory='256GiB', clusters=['ai2/saturn-cirrascale'], shared_filesystem=True, priority=<Priority.high: 'high'>, preemptible=True, retries=None, env_vars=[BeakerEnvVar(name='NCCL_DEBUG', value='WARN'), BeakerEnvVar(name='TORCH_NCCL_TRACE_BUFFER_SIZE', value='0'), BeakerEnvVar(name='NCCL_BLOCKING_WAIT', value='0'), BeakerEnvVar(name='GOOGLE_APPLICATION_CREDENTIALS', value='/etc/gcp_credentials.json')], env_secrets=[BeakerEnvSecret(name='BEAKER_TOKEN', secret='yawenzzzz_BEAKER_TOKEN'), BeakerEnvSecret(name='WANDB_API_KEY', secret='yawenzzzz_WANDB_API_KEY'), BeakerEnvSecret(name='GITHUB_TOKEN', secret='yawenzzzz_GITHUB_TOKEN'), BeakerEnvSecret(name='GCP_CREDENTIALS', secret='HELIOS_GCP_CREDENTIALS')], nfs=False, weka_buckets=[BeakerWekaBucket(bucket='dfive-default', mount='/weka/dfive-default')], allow_dirty=False, host_networking=None, git=GitConfig(repo_url='https://github.com/allenai/helios', ref='ad34f8d9cc3af2794e41b5c6cdddefdba216e57d', branch=None), hostnames=None), model=LatentMIMConfig(encoder_config=EncoderConfig(supported_modality_names=['sentinel2_l2a', 'sentinel1', 'landsat'], embedding_size=768, max_patch_size=8, min_patch_size=1, num_heads=12, mlp_ratio=4.0, depth=12, drop_path=0.1, max_sequence_length=12, learnable_channel_embeddings=True, random_channel_embeddings=False, num_projection_layers=1, aggregate_then_project=True, use_flash_attn=False, frozen_patch_embeddings=False, qk_norm=False), decoder_config=PredictorConfig(supported_modality_names=['sentinel2_l2a', 'sentinel1', 'landsat'], encoder_embedding_size=768, decoder_embedding_size=768, depth=4, mlp_ratio=4.0, num_heads=12, max_sequence_length=12, drop_path=0.0, learnable_channel_embeddings=True, random_channel_embeddings=False, output_embedding_size=None, use_flash_attn=False, qk_norm=False), reconstructor_config=None), dataset=HeliosConcatDatasetConfig(dataset_configs=[HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/presto/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/469728', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/osm_sampling/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/1138828', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/osmbig/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/1291656', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/presto_neighbor/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/3507008', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/worldcover_sampling/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/5662848', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0)]), data_loader=HeliosDataLoaderConfig(work_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.01', global_batch_size=512, min_patch_size=1, max_patch_size=8, sampled_hw_p_list=[5, 6, 7, 8, 9, 10, 11, 12], seed=3622, token_budget=1500, shuffle=True, num_workers=16, prefetch_factor=4, target_device_type=None, drop_last=True, num_dataset_repeats_per_epoch=1), train_module=ContrastiveLatentMIMTrainModuleConfig(optim_config=AdamWConfig(group_overrides=None, compile=False, fixed_fields=['initial_lr'], lr=0.0001, betas=[0.9, 0.999], eps=1e-08, weight_decay=0.02, foreach=None, fused=True), rank_microbatch_size=64, transform_config=TransformConfig(transform_type='flip_and_rotate', transform_kwargs={}), compile_model=False, dp_config=DataParallelConfig(name='fsdp', param_dtype='bfloat16', reduce_dtype='float32', num_replicas=None, shard_degree=None), compile_loss=False, autocast_precision=None, max_grad_norm=1.0, scheduler=CosWithWarmup(lr_field='lr', initial_lr_field='initial_lr', warmup_steps=8000, warmup_fraction=None, alpha_f=0.1, t_max=None, warmup_min_lr=0.0), find_unused_parameters=True, state_dict_save_opts=None, state_dict_load_opts=None, regularizer_config=None, loss_config=LossConfig(loss_config={'type': 'modality_patch_discrimination_new', 'tau': 0.1}), mae_loss_config=None, masking_config=MaskingConfig(strategy_config={'type': 'modality_cross_random', 'encode_ratio': 0.5, 'decode_ratio': 0.5, 'allow_encoding_decoding_same_bandset': True}), token_exit_cfg={'sentinel2_l2a': 0, 'sentinel1': 0, 'landsat': 0}, ema_decay=[1.0, 1.0], contrastive_config=LossConfig(loss_config={'type': 'InfoNCE', 'weight': 0.1})), trainer=TrainerConfig(save_folder='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.01', work_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.01', load_path='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets/step200000', load_strategy='if_available', checkpointer=CheckpointerConfig(work_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.01', save_overwrite=None, pre_download=False, save_thread_count=None, load_thread_count=None, throttle_uploads=False), device=None, save_overwrite=False, max_duration=Duration(value=300, unit='epochs'), cancel_check_interval=1, hard_stop=None, metrics_collect_interval=10, callbacks={'wandb': HeliosWandBCallback(enabled=True, name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.01', project='2025_08_17_contrastive_eval', entity='eai-ai2', group=None, tags=None, notes=None, config=None, cancel_tags=['cancel', 'canceled', 'cancelled'], cancel_check_interval=None, upload_dataset_distribution_pre_train=True, upload_modality_data_band_distribution_pre_train=False, restart_on_same_run=True), 'speed_monitor': HeliosSpeedMonitorCallback(num_flops_per_token=None, device_peak_flops=None, _total_steps=0, _total_tokens=0, _start_time=0.0, _first_step=True, _step_last_logged=0.0, _batch_load_start=0.0, _batch_load_time=0.0, _step_tokens=0, _step_seq_len=0, _parallel_degree=1, _bps_avg=None), 'gpu_memory_monitor': GPUMemoryMonitorCallback(device_id=None, _num_alloc_retries=0), 'config_saver': ConfigSaverCallback(config=None, fname='config.json', save_data_paths=None, data_paths_fname=None), 'downstream_evaluator': DownstreamEvaluatorCallbackConfig(tasks={'m-eurosat': DownstreamTaskConfig(dataset='m-eurosat', embedding_batch_size=128, num_workers=0, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm-bigearthnet': DownstreamTaskConfig(dataset='m-bigearthnet', embedding_batch_size=64, num_workers=4, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm-so2sat': DownstreamTaskConfig(dataset='m-so2sat', embedding_batch_size=128, num_workers=4, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm-brick-kiln': DownstreamTaskConfig(dataset='m-brick-kiln', embedding_batch_size=128, num_workers=4, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'mados': DownstreamTaskConfig(dataset='mados', embedding_batch_size=128, num_workers=8, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=False, input_modalities=[], probe_lr=0.01, patch_size=4, probe_batch_size=128, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sen1floods11': DownstreamTaskConfig(dataset='sen1floods11', embedding_batch_size=128, num_workers=8, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.01, patch_size=4, probe_batch_size=128, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sickle_sentinel1': DownstreamTaskConfig(dataset='sickle', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1'], probe_lr=0.01, patch_size=4, probe_batch_size=16, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sickle_landsat': DownstreamTaskConfig(dataset='sickle', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['landsat'], probe_lr=0.01, patch_size=4, probe_batch_size=16, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sickle_sentinel1_landsat': DownstreamTaskConfig(dataset='sickle', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1', 'landsat'], probe_lr=0.01, patch_size=4, probe_batch_size=16, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm_sa_crop_type': DownstreamTaskConfig(dataset='m-sa-crop-type', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.1, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm_cashew_plant': DownstreamTaskConfig(dataset='m-cashew-plant', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.01, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'pastis_sentinel2': DownstreamTaskConfig(dataset='pastis', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel2_l2a'], probe_lr=0.01, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=50, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'pastis_sentinel1': DownstreamTaskConfig(dataset='pastis', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1'], probe_lr=0.01, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=50, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'pastis_sentinel1_sentinel2': DownstreamTaskConfig(dataset='pastis', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1', 'sentinel2_l2a'], probe_lr=0.01, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=20, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'breizhcrops': DownstreamTaskConfig(dataset='breizhcrops', embedding_batch_size=128, num_workers=8, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.01, patch_size=1, probe_batch_size=128, epochs=50, eval_interval=Duration(value=50, unit='epochs'), eval_mode='linear_probe', probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP')}, enabled=True, eval_on_startup=True, cancel_after_first_eval=True), 'garbage_collector': GarbageCollectorCallback(gc_interval=1, enabled=True, _start_state=None), 'beaker': BeakerCallback(experiment_id=None, update_interval=None, description=None, enabled=None, _last_update=None), 'checkpointer': CheckpointerCallback(save_interval=5000, ephemeral_save_interval=250, pre_train_checkpoint=None, save_async=None, remove='ephemeral_only', enabled=True, _latest_checkpoint_step=-1, _latest_checkpoint_path='', _checkpoints=[], _ephemeral_checkpoints=[], _checkpoints_to_remove=[])}, async_bookkeeping=None, no_checkpoints=False, no_evals=False), visualize=HeliosVisualizeConfig(output_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.01/visualizations', num_samples=None, global_step=None, std_multiplier=2.0), init_seed=12536)
2025-08-17 13:30:36.353	saturn-cs-aus-233.reviz.ai2.in:0	py.warnings:109	WARNING	/weka/dfive-default/yawenz/.venv-helios-py310/lib/python3.10/site-packages/beaker/util.py:25: RuntimeWarning: Found unknown field 'budget: 01HPM52AQC6C0TZV32E7WDDGDJ' for data model 'Workspace'. This may be a newly added field that hasn't been defined in beaker-py yet. Please submit an issue report about this here:
https://github.com/allenai/beaker-py/issues/new?assignees=&labels=bug&template=bug_report.yml
  warnings.warn(

2025-08-17 13:30:40.009	saturn-cs-aus-233.reviz.ai2.in:0	olmo_core.launch.beaker:513	INFO	Experiment submitted, see progress at https://beaker.org/ex/01K2WVM81XFXFPNY6VSNGJKTJ0
2025-08-17 13:30:50.579	saturn-cs-aus-233.reviz.ai2.in:0	olmo_core.utils:200	INFO	Setting env var 'OMP_NUM_THREADS' to '8'
2025-08-17 13:30:50.579	saturn-cs-aus-233.reviz.ai2.in:0	olmo_core.utils:200	INFO	Setting env var 'TOKENIZERS_PARALLELISM' to 'false'
2025-08-17 13:30:50.579	saturn-cs-aus-233.reviz.ai2.in:0	helios.internal.experiment:135	INFO	Common overrides: []
2025-08-17 13:30:50.596	saturn-cs-aus-233.reviz.ai2.in:0	helios.internal.experiment:137	INFO	Common: CommonComponents(run_name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.05', save_folder='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.05', launch=HeliosBeakerLaunchConfig(name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.05-train-11ac6b6c', cmd=['scripts/2025_07_21_add_era5/eval.py', 'train', 'latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.05', 'ai2/saturn-cirrascale', '--launch.priority=high', '--trainer.callbacks.downstream_evaluator.tasks.m-cashew-plant.probe_lr=0.05', '--trainer.callbacks.downstream_evaluator.tasks.mados.probe_lr=0.05', '--trainer.callbacks.downstream_evaluator.tasks.sen1floods11.probe_lr=0.05', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel2.probe_lr=0.05', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1.probe_lr=0.05', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1_sentinel2.probe_lr=0.05', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1.probe_lr=0.05', '--trainer.callbacks.downstream_evaluator.tasks.sickle_landsat.probe_lr=0.05', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1_landsat.probe_lr=0.05', '--trainer.callbacks.downstream_evaluator.tasks.breizhcrops.probe_lr=0.05', '--trainer.load_path=/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets/step200000', '--launch.task_name=eval'], budget='ai2/es-platform', task_name='train', workspace='ai2/earth-systems', description=None, setup_steps=['echo "$GCP_CREDENTIALS" > $GOOGLE_APPLICATION_CREDENTIALS', 'conda install gh --channel conda-forge', 'gh auth status', 'gh repo clone $REPO_URL .', 'git checkout "$GIT_REF"', 'git submodule update --init --recursive', 'conda shell.bash activate base', "pip install -e '.[all]'", '', 'pip freeze'], beaker_image='petew/olmo-core-tch270cu128', num_nodes=1, num_gpus=1, shared_memory='256GiB', clusters=['ai2/saturn-cirrascale'], shared_filesystem=True, priority=<Priority.high: 'high'>, preemptible=True, retries=None, env_vars=[BeakerEnvVar(name='NCCL_DEBUG', value='WARN'), BeakerEnvVar(name='TORCH_NCCL_TRACE_BUFFER_SIZE', value='0'), BeakerEnvVar(name='NCCL_BLOCKING_WAIT', value='0'), BeakerEnvVar(name='GOOGLE_APPLICATION_CREDENTIALS', value='/etc/gcp_credentials.json')], env_secrets=[BeakerEnvSecret(name='BEAKER_TOKEN', secret='yawenzzzz_BEAKER_TOKEN'), BeakerEnvSecret(name='WANDB_API_KEY', secret='yawenzzzz_WANDB_API_KEY'), BeakerEnvSecret(name='GITHUB_TOKEN', secret='yawenzzzz_GITHUB_TOKEN'), BeakerEnvSecret(name='GCP_CREDENTIALS', secret='HELIOS_GCP_CREDENTIALS')], nfs=False, weka_buckets=[BeakerWekaBucket(bucket='dfive-default', mount='/weka/dfive-default')], allow_dirty=False, host_networking=None, git=GitConfig(repo_url='https://github.com/allenai/helios', ref='ad34f8d9cc3af2794e41b5c6cdddefdba216e57d', branch=None), hostnames=None), training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dataset_percentage=1.0, nccl_debug=False)
2025-08-17 13:30:50.601	saturn-cs-aus-233.reviz.ai2.in:0	helios.internal.experiment:156	INFO	Overrides: ['--launch.priority=high', '--trainer.callbacks.downstream_evaluator.tasks.m-cashew-plant.probe_lr=0.05', '--trainer.callbacks.downstream_evaluator.tasks.mados.probe_lr=0.05', '--trainer.callbacks.downstream_evaluator.tasks.sen1floods11.probe_lr=0.05', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel2.probe_lr=0.05', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1.probe_lr=0.05', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1_sentinel2.probe_lr=0.05', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1.probe_lr=0.05', '--trainer.callbacks.downstream_evaluator.tasks.sickle_landsat.probe_lr=0.05', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1_landsat.probe_lr=0.05', '--trainer.callbacks.downstream_evaluator.tasks.breizhcrops.probe_lr=0.05', '--trainer.load_path=/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets/step200000', '--launch.task_name=eval']
HeliosExperimentConfig(run_name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.05', launch=HeliosBeakerLaunchConfig(name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.05-train-11ac6b6c', cmd=['scripts/2025_07_21_add_era5/eval.py', 'train', 'latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.05', 'ai2/saturn-cirrascale', '--launch.priority=high', '--trainer.callbacks.downstream_evaluator.tasks.m-cashew-plant.probe_lr=0.05', '--trainer.callbacks.downstream_evaluator.tasks.mados.probe_lr=0.05', '--trainer.callbacks.downstream_evaluator.tasks.sen1floods11.probe_lr=0.05', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel2.probe_lr=0.05', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1.probe_lr=0.05', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1_sentinel2.probe_lr=0.05', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1.probe_lr=0.05', '--trainer.callbacks.downstream_evaluator.tasks.sickle_landsat.probe_lr=0.05', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1_landsat.probe_lr=0.05', '--trainer.callbacks.downstream_evaluator.tasks.breizhcrops.probe_lr=0.05', '--trainer.load_path=/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets/step200000', '--launch.task_name=eval'], budget='ai2/es-platform', task_name='eval', workspace='ai2/earth-systems', description=None, setup_steps=['echo "$GCP_CREDENTIALS" > $GOOGLE_APPLICATION_CREDENTIALS', 'conda install gh --channel conda-forge', 'gh auth status', 'gh repo clone $REPO_URL .', 'git checkout "$GIT_REF"', 'git submodule update --init --recursive', 'conda shell.bash activate base', "pip install -e '.[all]'", '', 'pip freeze'], beaker_image='petew/olmo-core-tch270cu128', num_nodes=1, num_gpus=1, shared_memory='256GiB', clusters=['ai2/saturn-cirrascale'], shared_filesystem=True, priority=<Priority.high: 'high'>, preemptible=True, retries=None, env_vars=[BeakerEnvVar(name='NCCL_DEBUG', value='WARN'), BeakerEnvVar(name='TORCH_NCCL_TRACE_BUFFER_SIZE', value='0'), BeakerEnvVar(name='NCCL_BLOCKING_WAIT', value='0'), BeakerEnvVar(name='GOOGLE_APPLICATION_CREDENTIALS', value='/etc/gcp_credentials.json')], env_secrets=[BeakerEnvSecret(name='BEAKER_TOKEN', secret='yawenzzzz_BEAKER_TOKEN'), BeakerEnvSecret(name='WANDB_API_KEY', secret='yawenzzzz_WANDB_API_KEY'), BeakerEnvSecret(name='GITHUB_TOKEN', secret='yawenzzzz_GITHUB_TOKEN'), BeakerEnvSecret(name='GCP_CREDENTIALS', secret='HELIOS_GCP_CREDENTIALS')], nfs=False, weka_buckets=[BeakerWekaBucket(bucket='dfive-default', mount='/weka/dfive-default')], allow_dirty=False, host_networking=None, git=GitConfig(repo_url='https://github.com/allenai/helios', ref='ad34f8d9cc3af2794e41b5c6cdddefdba216e57d', branch=None), hostnames=None), model=LatentMIMConfig(encoder_config=EncoderConfig(supported_modality_names=['sentinel2_l2a', 'sentinel1', 'landsat'], embedding_size=768, max_patch_size=8, min_patch_size=1, num_heads=12, mlp_ratio=4.0, depth=12, drop_path=0.1, max_sequence_length=12, learnable_channel_embeddings=True, random_channel_embeddings=False, num_projection_layers=1, aggregate_then_project=True, use_flash_attn=False, frozen_patch_embeddings=False, qk_norm=False), decoder_config=PredictorConfig(supported_modality_names=['sentinel2_l2a', 'sentinel1', 'landsat'], encoder_embedding_size=768, decoder_embedding_size=768, depth=4, mlp_ratio=4.0, num_heads=12, max_sequence_length=12, drop_path=0.0, learnable_channel_embeddings=True, random_channel_embeddings=False, output_embedding_size=None, use_flash_attn=False, qk_norm=False), reconstructor_config=None), dataset=HeliosConcatDatasetConfig(dataset_configs=[HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/presto/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/469728', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/osm_sampling/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/1138828', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/osmbig/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/1291656', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/presto_neighbor/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/3507008', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/worldcover_sampling/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/5662848', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0)]), data_loader=HeliosDataLoaderConfig(work_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.05', global_batch_size=512, min_patch_size=1, max_patch_size=8, sampled_hw_p_list=[5, 6, 7, 8, 9, 10, 11, 12], seed=3622, token_budget=1500, shuffle=True, num_workers=16, prefetch_factor=4, target_device_type=None, drop_last=True, num_dataset_repeats_per_epoch=1), train_module=ContrastiveLatentMIMTrainModuleConfig(optim_config=AdamWConfig(group_overrides=None, compile=False, fixed_fields=['initial_lr'], lr=0.0001, betas=[0.9, 0.999], eps=1e-08, weight_decay=0.02, foreach=None, fused=True), rank_microbatch_size=64, transform_config=TransformConfig(transform_type='flip_and_rotate', transform_kwargs={}), compile_model=False, dp_config=DataParallelConfig(name='fsdp', param_dtype='bfloat16', reduce_dtype='float32', num_replicas=None, shard_degree=None), compile_loss=False, autocast_precision=None, max_grad_norm=1.0, scheduler=CosWithWarmup(lr_field='lr', initial_lr_field='initial_lr', warmup_steps=8000, warmup_fraction=None, alpha_f=0.1, t_max=None, warmup_min_lr=0.0), find_unused_parameters=True, state_dict_save_opts=None, state_dict_load_opts=None, regularizer_config=None, loss_config=LossConfig(loss_config={'type': 'modality_patch_discrimination_new', 'tau': 0.1}), mae_loss_config=None, masking_config=MaskingConfig(strategy_config={'type': 'modality_cross_random', 'encode_ratio': 0.5, 'decode_ratio': 0.5, 'allow_encoding_decoding_same_bandset': True}), token_exit_cfg={'sentinel2_l2a': 0, 'sentinel1': 0, 'landsat': 0}, ema_decay=[1.0, 1.0], contrastive_config=LossConfig(loss_config={'type': 'InfoNCE', 'weight': 0.1})), trainer=TrainerConfig(save_folder='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.05', work_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.05', load_path='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets/step200000', load_strategy='if_available', checkpointer=CheckpointerConfig(work_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.05', save_overwrite=None, pre_download=False, save_thread_count=None, load_thread_count=None, throttle_uploads=False), device=None, save_overwrite=False, max_duration=Duration(value=300, unit='epochs'), cancel_check_interval=1, hard_stop=None, metrics_collect_interval=10, callbacks={'wandb': HeliosWandBCallback(enabled=True, name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.05', project='2025_08_17_contrastive_eval', entity='eai-ai2', group=None, tags=None, notes=None, config=None, cancel_tags=['cancel', 'canceled', 'cancelled'], cancel_check_interval=None, upload_dataset_distribution_pre_train=True, upload_modality_data_band_distribution_pre_train=False, restart_on_same_run=True), 'speed_monitor': HeliosSpeedMonitorCallback(num_flops_per_token=None, device_peak_flops=None, _total_steps=0, _total_tokens=0, _start_time=0.0, _first_step=True, _step_last_logged=0.0, _batch_load_start=0.0, _batch_load_time=0.0, _step_tokens=0, _step_seq_len=0, _parallel_degree=1, _bps_avg=None), 'gpu_memory_monitor': GPUMemoryMonitorCallback(device_id=None, _num_alloc_retries=0), 'config_saver': ConfigSaverCallback(config=None, fname='config.json', save_data_paths=None, data_paths_fname=None), 'downstream_evaluator': DownstreamEvaluatorCallbackConfig(tasks={'m-eurosat': DownstreamTaskConfig(dataset='m-eurosat', embedding_batch_size=128, num_workers=0, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm-bigearthnet': DownstreamTaskConfig(dataset='m-bigearthnet', embedding_batch_size=64, num_workers=4, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm-so2sat': DownstreamTaskConfig(dataset='m-so2sat', embedding_batch_size=128, num_workers=4, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm-brick-kiln': DownstreamTaskConfig(dataset='m-brick-kiln', embedding_batch_size=128, num_workers=4, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'mados': DownstreamTaskConfig(dataset='mados', embedding_batch_size=128, num_workers=8, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=False, input_modalities=[], probe_lr=0.05, patch_size=4, probe_batch_size=128, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sen1floods11': DownstreamTaskConfig(dataset='sen1floods11', embedding_batch_size=128, num_workers=8, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.05, patch_size=4, probe_batch_size=128, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sickle_sentinel1': DownstreamTaskConfig(dataset='sickle', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1'], probe_lr=0.05, patch_size=4, probe_batch_size=16, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sickle_landsat': DownstreamTaskConfig(dataset='sickle', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['landsat'], probe_lr=0.05, patch_size=4, probe_batch_size=16, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sickle_sentinel1_landsat': DownstreamTaskConfig(dataset='sickle', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1', 'landsat'], probe_lr=0.05, patch_size=4, probe_batch_size=16, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm_sa_crop_type': DownstreamTaskConfig(dataset='m-sa-crop-type', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.1, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm_cashew_plant': DownstreamTaskConfig(dataset='m-cashew-plant', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.05, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'pastis_sentinel2': DownstreamTaskConfig(dataset='pastis', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel2_l2a'], probe_lr=0.05, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=50, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'pastis_sentinel1': DownstreamTaskConfig(dataset='pastis', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1'], probe_lr=0.05, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=50, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'pastis_sentinel1_sentinel2': DownstreamTaskConfig(dataset='pastis', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1', 'sentinel2_l2a'], probe_lr=0.05, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=20, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'breizhcrops': DownstreamTaskConfig(dataset='breizhcrops', embedding_batch_size=128, num_workers=8, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.05, patch_size=1, probe_batch_size=128, epochs=50, eval_interval=Duration(value=50, unit='epochs'), eval_mode='linear_probe', probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP')}, enabled=True, eval_on_startup=True, cancel_after_first_eval=True), 'garbage_collector': GarbageCollectorCallback(gc_interval=1, enabled=True, _start_state=None), 'beaker': BeakerCallback(experiment_id=None, update_interval=None, description=None, enabled=None, _last_update=None), 'checkpointer': CheckpointerCallback(save_interval=5000, ephemeral_save_interval=250, pre_train_checkpoint=None, save_async=None, remove='ephemeral_only', enabled=True, _latest_checkpoint_step=-1, _latest_checkpoint_path='', _checkpoints=[], _ephemeral_checkpoints=[], _checkpoints_to_remove=[])}, async_bookkeeping=None, no_checkpoints=False, no_evals=False), visualize=HeliosVisualizeConfig(output_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.05/visualizations', num_samples=None, global_step=None, std_multiplier=2.0), init_seed=12536)
2025-08-17 13:30:50.745	saturn-cs-aus-233.reviz.ai2.in:0	helios.internal.experiment:210	INFO	Launching the experiment
2025-08-17 13:30:50.745	saturn-cs-aus-233.reviz.ai2.in:0	helios.internal.experiment:211	INFO	HeliosExperimentConfig(run_name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.05', launch=HeliosBeakerLaunchConfig(name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.05-train-11ac6b6c', cmd=['scripts/2025_07_21_add_era5/eval.py', 'train', 'latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.05', 'ai2/saturn-cirrascale', '--launch.priority=high', '--trainer.callbacks.downstream_evaluator.tasks.m-cashew-plant.probe_lr=0.05', '--trainer.callbacks.downstream_evaluator.tasks.mados.probe_lr=0.05', '--trainer.callbacks.downstream_evaluator.tasks.sen1floods11.probe_lr=0.05', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel2.probe_lr=0.05', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1.probe_lr=0.05', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1_sentinel2.probe_lr=0.05', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1.probe_lr=0.05', '--trainer.callbacks.downstream_evaluator.tasks.sickle_landsat.probe_lr=0.05', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1_landsat.probe_lr=0.05', '--trainer.callbacks.downstream_evaluator.tasks.breizhcrops.probe_lr=0.05', '--trainer.load_path=/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets/step200000', '--launch.task_name=eval'], budget='ai2/es-platform', task_name='eval', workspace='ai2/earth-systems', description=None, setup_steps=['echo "$GCP_CREDENTIALS" > $GOOGLE_APPLICATION_CREDENTIALS', 'conda install gh --channel conda-forge', 'gh auth status', 'gh repo clone $REPO_URL .', 'git checkout "$GIT_REF"', 'git submodule update --init --recursive', 'conda shell.bash activate base', "pip install -e '.[all]'", '', 'pip freeze'], beaker_image='petew/olmo-core-tch270cu128', num_nodes=1, num_gpus=1, shared_memory='256GiB', clusters=['ai2/saturn-cirrascale'], shared_filesystem=True, priority=<Priority.high: 'high'>, preemptible=True, retries=None, env_vars=[BeakerEnvVar(name='NCCL_DEBUG', value='WARN'), BeakerEnvVar(name='TORCH_NCCL_TRACE_BUFFER_SIZE', value='0'), BeakerEnvVar(name='NCCL_BLOCKING_WAIT', value='0'), BeakerEnvVar(name='GOOGLE_APPLICATION_CREDENTIALS', value='/etc/gcp_credentials.json')], env_secrets=[BeakerEnvSecret(name='BEAKER_TOKEN', secret='yawenzzzz_BEAKER_TOKEN'), BeakerEnvSecret(name='WANDB_API_KEY', secret='yawenzzzz_WANDB_API_KEY'), BeakerEnvSecret(name='GITHUB_TOKEN', secret='yawenzzzz_GITHUB_TOKEN'), BeakerEnvSecret(name='GCP_CREDENTIALS', secret='HELIOS_GCP_CREDENTIALS')], nfs=False, weka_buckets=[BeakerWekaBucket(bucket='dfive-default', mount='/weka/dfive-default')], allow_dirty=False, host_networking=None, git=GitConfig(repo_url='https://github.com/allenai/helios', ref='ad34f8d9cc3af2794e41b5c6cdddefdba216e57d', branch=None), hostnames=None), model=LatentMIMConfig(encoder_config=EncoderConfig(supported_modality_names=['sentinel2_l2a', 'sentinel1', 'landsat'], embedding_size=768, max_patch_size=8, min_patch_size=1, num_heads=12, mlp_ratio=4.0, depth=12, drop_path=0.1, max_sequence_length=12, learnable_channel_embeddings=True, random_channel_embeddings=False, num_projection_layers=1, aggregate_then_project=True, use_flash_attn=False, frozen_patch_embeddings=False, qk_norm=False), decoder_config=PredictorConfig(supported_modality_names=['sentinel2_l2a', 'sentinel1', 'landsat'], encoder_embedding_size=768, decoder_embedding_size=768, depth=4, mlp_ratio=4.0, num_heads=12, max_sequence_length=12, drop_path=0.0, learnable_channel_embeddings=True, random_channel_embeddings=False, output_embedding_size=None, use_flash_attn=False, qk_norm=False), reconstructor_config=None), dataset=HeliosConcatDatasetConfig(dataset_configs=[HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/presto/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/469728', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/osm_sampling/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/1138828', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/osmbig/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/1291656', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/presto_neighbor/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/3507008', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/worldcover_sampling/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/5662848', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0)]), data_loader=HeliosDataLoaderConfig(work_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.05', global_batch_size=512, min_patch_size=1, max_patch_size=8, sampled_hw_p_list=[5, 6, 7, 8, 9, 10, 11, 12], seed=3622, token_budget=1500, shuffle=True, num_workers=16, prefetch_factor=4, target_device_type=None, drop_last=True, num_dataset_repeats_per_epoch=1), train_module=ContrastiveLatentMIMTrainModuleConfig(optim_config=AdamWConfig(group_overrides=None, compile=False, fixed_fields=['initial_lr'], lr=0.0001, betas=[0.9, 0.999], eps=1e-08, weight_decay=0.02, foreach=None, fused=True), rank_microbatch_size=64, transform_config=TransformConfig(transform_type='flip_and_rotate', transform_kwargs={}), compile_model=False, dp_config=DataParallelConfig(name='fsdp', param_dtype='bfloat16', reduce_dtype='float32', num_replicas=None, shard_degree=None), compile_loss=False, autocast_precision=None, max_grad_norm=1.0, scheduler=CosWithWarmup(lr_field='lr', initial_lr_field='initial_lr', warmup_steps=8000, warmup_fraction=None, alpha_f=0.1, t_max=None, warmup_min_lr=0.0), find_unused_parameters=True, state_dict_save_opts=None, state_dict_load_opts=None, regularizer_config=None, loss_config=LossConfig(loss_config={'type': 'modality_patch_discrimination_new', 'tau': 0.1}), mae_loss_config=None, masking_config=MaskingConfig(strategy_config={'type': 'modality_cross_random', 'encode_ratio': 0.5, 'decode_ratio': 0.5, 'allow_encoding_decoding_same_bandset': True}), token_exit_cfg={'sentinel2_l2a': 0, 'sentinel1': 0, 'landsat': 0}, ema_decay=[1.0, 1.0], contrastive_config=LossConfig(loss_config={'type': 'InfoNCE', 'weight': 0.1})), trainer=TrainerConfig(save_folder='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.05', work_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.05', load_path='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets/step200000', load_strategy='if_available', checkpointer=CheckpointerConfig(work_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.05', save_overwrite=None, pre_download=False, save_thread_count=None, load_thread_count=None, throttle_uploads=False), device=None, save_overwrite=False, max_duration=Duration(value=300, unit='epochs'), cancel_check_interval=1, hard_stop=None, metrics_collect_interval=10, callbacks={'wandb': HeliosWandBCallback(enabled=True, name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.05', project='2025_08_17_contrastive_eval', entity='eai-ai2', group=None, tags=None, notes=None, config=None, cancel_tags=['cancel', 'canceled', 'cancelled'], cancel_check_interval=None, upload_dataset_distribution_pre_train=True, upload_modality_data_band_distribution_pre_train=False, restart_on_same_run=True), 'speed_monitor': HeliosSpeedMonitorCallback(num_flops_per_token=None, device_peak_flops=None, _total_steps=0, _total_tokens=0, _start_time=0.0, _first_step=True, _step_last_logged=0.0, _batch_load_start=0.0, _batch_load_time=0.0, _step_tokens=0, _step_seq_len=0, _parallel_degree=1, _bps_avg=None), 'gpu_memory_monitor': GPUMemoryMonitorCallback(device_id=None, _num_alloc_retries=0), 'config_saver': ConfigSaverCallback(config=None, fname='config.json', save_data_paths=None, data_paths_fname=None), 'downstream_evaluator': DownstreamEvaluatorCallbackConfig(tasks={'m-eurosat': DownstreamTaskConfig(dataset='m-eurosat', embedding_batch_size=128, num_workers=0, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm-bigearthnet': DownstreamTaskConfig(dataset='m-bigearthnet', embedding_batch_size=64, num_workers=4, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm-so2sat': DownstreamTaskConfig(dataset='m-so2sat', embedding_batch_size=128, num_workers=4, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm-brick-kiln': DownstreamTaskConfig(dataset='m-brick-kiln', embedding_batch_size=128, num_workers=4, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'mados': DownstreamTaskConfig(dataset='mados', embedding_batch_size=128, num_workers=8, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=False, input_modalities=[], probe_lr=0.05, patch_size=4, probe_batch_size=128, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sen1floods11': DownstreamTaskConfig(dataset='sen1floods11', embedding_batch_size=128, num_workers=8, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.05, patch_size=4, probe_batch_size=128, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sickle_sentinel1': DownstreamTaskConfig(dataset='sickle', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1'], probe_lr=0.05, patch_size=4, probe_batch_size=16, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sickle_landsat': DownstreamTaskConfig(dataset='sickle', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['landsat'], probe_lr=0.05, patch_size=4, probe_batch_size=16, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sickle_sentinel1_landsat': DownstreamTaskConfig(dataset='sickle', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1', 'landsat'], probe_lr=0.05, patch_size=4, probe_batch_size=16, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm_sa_crop_type': DownstreamTaskConfig(dataset='m-sa-crop-type', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.1, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm_cashew_plant': DownstreamTaskConfig(dataset='m-cashew-plant', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.05, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'pastis_sentinel2': DownstreamTaskConfig(dataset='pastis', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel2_l2a'], probe_lr=0.05, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=50, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'pastis_sentinel1': DownstreamTaskConfig(dataset='pastis', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1'], probe_lr=0.05, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=50, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'pastis_sentinel1_sentinel2': DownstreamTaskConfig(dataset='pastis', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1', 'sentinel2_l2a'], probe_lr=0.05, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=20, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'breizhcrops': DownstreamTaskConfig(dataset='breizhcrops', embedding_batch_size=128, num_workers=8, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.05, patch_size=1, probe_batch_size=128, epochs=50, eval_interval=Duration(value=50, unit='epochs'), eval_mode='linear_probe', probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP')}, enabled=True, eval_on_startup=True, cancel_after_first_eval=True), 'garbage_collector': GarbageCollectorCallback(gc_interval=1, enabled=True, _start_state=None), 'beaker': BeakerCallback(experiment_id=None, update_interval=None, description=None, enabled=None, _last_update=None), 'checkpointer': CheckpointerCallback(save_interval=5000, ephemeral_save_interval=250, pre_train_checkpoint=None, save_async=None, remove='ephemeral_only', enabled=True, _latest_checkpoint_step=-1, _latest_checkpoint_path='', _checkpoints=[], _ephemeral_checkpoints=[], _checkpoints_to_remove=[])}, async_bookkeeping=None, no_checkpoints=False, no_evals=False), visualize=HeliosVisualizeConfig(output_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.05/visualizations', num_samples=None, global_step=None, std_multiplier=2.0), init_seed=12536)
2025-08-17 13:30:51.763	saturn-cs-aus-233.reviz.ai2.in:0	py.warnings:109	WARNING	/weka/dfive-default/yawenz/.venv-helios-py310/lib/python3.10/site-packages/beaker/util.py:25: RuntimeWarning: Found unknown field 'budget: 01HPM52AQC6C0TZV32E7WDDGDJ' for data model 'Workspace'. This may be a newly added field that hasn't been defined in beaker-py yet. Please submit an issue report about this here:
https://github.com/allenai/beaker-py/issues/new?assignees=&labels=bug&template=bug_report.yml
  warnings.warn(

2025-08-17 13:30:55.562	saturn-cs-aus-233.reviz.ai2.in:0	olmo_core.launch.beaker:513	INFO	Experiment submitted, see progress at https://beaker.org/ex/01K2WVMQ6DYX9K09P21NNNWT6J
2025-08-17 13:31:07.199	saturn-cs-aus-233.reviz.ai2.in:0	olmo_core.utils:200	INFO	Setting env var 'OMP_NUM_THREADS' to '8'
2025-08-17 13:31:07.199	saturn-cs-aus-233.reviz.ai2.in:0	olmo_core.utils:200	INFO	Setting env var 'TOKENIZERS_PARALLELISM' to 'false'
2025-08-17 13:31:07.199	saturn-cs-aus-233.reviz.ai2.in:0	helios.internal.experiment:135	INFO	Common overrides: []
2025-08-17 13:31:07.217	saturn-cs-aus-233.reviz.ai2.in:0	helios.internal.experiment:137	INFO	Common: CommonComponents(run_name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.1', save_folder='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.1', launch=HeliosBeakerLaunchConfig(name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.1-train-cba97838', cmd=['scripts/2025_07_21_add_era5/eval.py', 'train', 'latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.1', 'ai2/saturn-cirrascale', '--launch.priority=high', '--trainer.callbacks.downstream_evaluator.tasks.m-cashew-plant.probe_lr=0.1', '--trainer.callbacks.downstream_evaluator.tasks.mados.probe_lr=0.1', '--trainer.callbacks.downstream_evaluator.tasks.sen1floods11.probe_lr=0.1', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel2.probe_lr=0.1', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1.probe_lr=0.1', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1_sentinel2.probe_lr=0.1', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1.probe_lr=0.1', '--trainer.callbacks.downstream_evaluator.tasks.sickle_landsat.probe_lr=0.1', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1_landsat.probe_lr=0.1', '--trainer.callbacks.downstream_evaluator.tasks.breizhcrops.probe_lr=0.1', '--trainer.load_path=/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets/step200000', '--launch.task_name=eval'], budget='ai2/es-platform', task_name='train', workspace='ai2/earth-systems', description=None, setup_steps=['echo "$GCP_CREDENTIALS" > $GOOGLE_APPLICATION_CREDENTIALS', 'conda install gh --channel conda-forge', 'gh auth status', 'gh repo clone $REPO_URL .', 'git checkout "$GIT_REF"', 'git submodule update --init --recursive', 'conda shell.bash activate base', "pip install -e '.[all]'", '', 'pip freeze'], beaker_image='petew/olmo-core-tch270cu128', num_nodes=1, num_gpus=1, shared_memory='256GiB', clusters=['ai2/saturn-cirrascale'], shared_filesystem=True, priority=<Priority.high: 'high'>, preemptible=True, retries=None, env_vars=[BeakerEnvVar(name='NCCL_DEBUG', value='WARN'), BeakerEnvVar(name='TORCH_NCCL_TRACE_BUFFER_SIZE', value='0'), BeakerEnvVar(name='NCCL_BLOCKING_WAIT', value='0'), BeakerEnvVar(name='GOOGLE_APPLICATION_CREDENTIALS', value='/etc/gcp_credentials.json')], env_secrets=[BeakerEnvSecret(name='BEAKER_TOKEN', secret='yawenzzzz_BEAKER_TOKEN'), BeakerEnvSecret(name='WANDB_API_KEY', secret='yawenzzzz_WANDB_API_KEY'), BeakerEnvSecret(name='GITHUB_TOKEN', secret='yawenzzzz_GITHUB_TOKEN'), BeakerEnvSecret(name='GCP_CREDENTIALS', secret='HELIOS_GCP_CREDENTIALS')], nfs=False, weka_buckets=[BeakerWekaBucket(bucket='dfive-default', mount='/weka/dfive-default')], allow_dirty=False, host_networking=None, git=GitConfig(repo_url='https://github.com/allenai/helios', ref='ad34f8d9cc3af2794e41b5c6cdddefdba216e57d', branch=None), hostnames=None), training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dataset_percentage=1.0, nccl_debug=False)
2025-08-17 13:31:07.222	saturn-cs-aus-233.reviz.ai2.in:0	helios.internal.experiment:156	INFO	Overrides: ['--launch.priority=high', '--trainer.callbacks.downstream_evaluator.tasks.m-cashew-plant.probe_lr=0.1', '--trainer.callbacks.downstream_evaluator.tasks.mados.probe_lr=0.1', '--trainer.callbacks.downstream_evaluator.tasks.sen1floods11.probe_lr=0.1', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel2.probe_lr=0.1', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1.probe_lr=0.1', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1_sentinel2.probe_lr=0.1', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1.probe_lr=0.1', '--trainer.callbacks.downstream_evaluator.tasks.sickle_landsat.probe_lr=0.1', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1_landsat.probe_lr=0.1', '--trainer.callbacks.downstream_evaluator.tasks.breizhcrops.probe_lr=0.1', '--trainer.load_path=/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets/step200000', '--launch.task_name=eval']
HeliosExperimentConfig(run_name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.1', launch=HeliosBeakerLaunchConfig(name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.1-train-cba97838', cmd=['scripts/2025_07_21_add_era5/eval.py', 'train', 'latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.1', 'ai2/saturn-cirrascale', '--launch.priority=high', '--trainer.callbacks.downstream_evaluator.tasks.m-cashew-plant.probe_lr=0.1', '--trainer.callbacks.downstream_evaluator.tasks.mados.probe_lr=0.1', '--trainer.callbacks.downstream_evaluator.tasks.sen1floods11.probe_lr=0.1', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel2.probe_lr=0.1', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1.probe_lr=0.1', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1_sentinel2.probe_lr=0.1', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1.probe_lr=0.1', '--trainer.callbacks.downstream_evaluator.tasks.sickle_landsat.probe_lr=0.1', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1_landsat.probe_lr=0.1', '--trainer.callbacks.downstream_evaluator.tasks.breizhcrops.probe_lr=0.1', '--trainer.load_path=/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets/step200000', '--launch.task_name=eval'], budget='ai2/es-platform', task_name='eval', workspace='ai2/earth-systems', description=None, setup_steps=['echo "$GCP_CREDENTIALS" > $GOOGLE_APPLICATION_CREDENTIALS', 'conda install gh --channel conda-forge', 'gh auth status', 'gh repo clone $REPO_URL .', 'git checkout "$GIT_REF"', 'git submodule update --init --recursive', 'conda shell.bash activate base', "pip install -e '.[all]'", '', 'pip freeze'], beaker_image='petew/olmo-core-tch270cu128', num_nodes=1, num_gpus=1, shared_memory='256GiB', clusters=['ai2/saturn-cirrascale'], shared_filesystem=True, priority=<Priority.high: 'high'>, preemptible=True, retries=None, env_vars=[BeakerEnvVar(name='NCCL_DEBUG', value='WARN'), BeakerEnvVar(name='TORCH_NCCL_TRACE_BUFFER_SIZE', value='0'), BeakerEnvVar(name='NCCL_BLOCKING_WAIT', value='0'), BeakerEnvVar(name='GOOGLE_APPLICATION_CREDENTIALS', value='/etc/gcp_credentials.json')], env_secrets=[BeakerEnvSecret(name='BEAKER_TOKEN', secret='yawenzzzz_BEAKER_TOKEN'), BeakerEnvSecret(name='WANDB_API_KEY', secret='yawenzzzz_WANDB_API_KEY'), BeakerEnvSecret(name='GITHUB_TOKEN', secret='yawenzzzz_GITHUB_TOKEN'), BeakerEnvSecret(name='GCP_CREDENTIALS', secret='HELIOS_GCP_CREDENTIALS')], nfs=False, weka_buckets=[BeakerWekaBucket(bucket='dfive-default', mount='/weka/dfive-default')], allow_dirty=False, host_networking=None, git=GitConfig(repo_url='https://github.com/allenai/helios', ref='ad34f8d9cc3af2794e41b5c6cdddefdba216e57d', branch=None), hostnames=None), model=LatentMIMConfig(encoder_config=EncoderConfig(supported_modality_names=['sentinel2_l2a', 'sentinel1', 'landsat'], embedding_size=768, max_patch_size=8, min_patch_size=1, num_heads=12, mlp_ratio=4.0, depth=12, drop_path=0.1, max_sequence_length=12, learnable_channel_embeddings=True, random_channel_embeddings=False, num_projection_layers=1, aggregate_then_project=True, use_flash_attn=False, frozen_patch_embeddings=False, qk_norm=False), decoder_config=PredictorConfig(supported_modality_names=['sentinel2_l2a', 'sentinel1', 'landsat'], encoder_embedding_size=768, decoder_embedding_size=768, depth=4, mlp_ratio=4.0, num_heads=12, max_sequence_length=12, drop_path=0.0, learnable_channel_embeddings=True, random_channel_embeddings=False, output_embedding_size=None, use_flash_attn=False, qk_norm=False), reconstructor_config=None), dataset=HeliosConcatDatasetConfig(dataset_configs=[HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/presto/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/469728', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/osm_sampling/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/1138828', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/osmbig/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/1291656', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/presto_neighbor/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/3507008', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/worldcover_sampling/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/5662848', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0)]), data_loader=HeliosDataLoaderConfig(work_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.1', global_batch_size=512, min_patch_size=1, max_patch_size=8, sampled_hw_p_list=[5, 6, 7, 8, 9, 10, 11, 12], seed=3622, token_budget=1500, shuffle=True, num_workers=16, prefetch_factor=4, target_device_type=None, drop_last=True, num_dataset_repeats_per_epoch=1), train_module=ContrastiveLatentMIMTrainModuleConfig(optim_config=AdamWConfig(group_overrides=None, compile=False, fixed_fields=['initial_lr'], lr=0.0001, betas=[0.9, 0.999], eps=1e-08, weight_decay=0.02, foreach=None, fused=True), rank_microbatch_size=64, transform_config=TransformConfig(transform_type='flip_and_rotate', transform_kwargs={}), compile_model=False, dp_config=DataParallelConfig(name='fsdp', param_dtype='bfloat16', reduce_dtype='float32', num_replicas=None, shard_degree=None), compile_loss=False, autocast_precision=None, max_grad_norm=1.0, scheduler=CosWithWarmup(lr_field='lr', initial_lr_field='initial_lr', warmup_steps=8000, warmup_fraction=None, alpha_f=0.1, t_max=None, warmup_min_lr=0.0), find_unused_parameters=True, state_dict_save_opts=None, state_dict_load_opts=None, regularizer_config=None, loss_config=LossConfig(loss_config={'type': 'modality_patch_discrimination_new', 'tau': 0.1}), mae_loss_config=None, masking_config=MaskingConfig(strategy_config={'type': 'modality_cross_random', 'encode_ratio': 0.5, 'decode_ratio': 0.5, 'allow_encoding_decoding_same_bandset': True}), token_exit_cfg={'sentinel2_l2a': 0, 'sentinel1': 0, 'landsat': 0}, ema_decay=[1.0, 1.0], contrastive_config=LossConfig(loss_config={'type': 'InfoNCE', 'weight': 0.1})), trainer=TrainerConfig(save_folder='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.1', work_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.1', load_path='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets/step200000', load_strategy='if_available', checkpointer=CheckpointerConfig(work_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.1', save_overwrite=None, pre_download=False, save_thread_count=None, load_thread_count=None, throttle_uploads=False), device=None, save_overwrite=False, max_duration=Duration(value=300, unit='epochs'), cancel_check_interval=1, hard_stop=None, metrics_collect_interval=10, callbacks={'wandb': HeliosWandBCallback(enabled=True, name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.1', project='2025_08_17_contrastive_eval', entity='eai-ai2', group=None, tags=None, notes=None, config=None, cancel_tags=['cancel', 'canceled', 'cancelled'], cancel_check_interval=None, upload_dataset_distribution_pre_train=True, upload_modality_data_band_distribution_pre_train=False, restart_on_same_run=True), 'speed_monitor': HeliosSpeedMonitorCallback(num_flops_per_token=None, device_peak_flops=None, _total_steps=0, _total_tokens=0, _start_time=0.0, _first_step=True, _step_last_logged=0.0, _batch_load_start=0.0, _batch_load_time=0.0, _step_tokens=0, _step_seq_len=0, _parallel_degree=1, _bps_avg=None), 'gpu_memory_monitor': GPUMemoryMonitorCallback(device_id=None, _num_alloc_retries=0), 'config_saver': ConfigSaverCallback(config=None, fname='config.json', save_data_paths=None, data_paths_fname=None), 'downstream_evaluator': DownstreamEvaluatorCallbackConfig(tasks={'m-eurosat': DownstreamTaskConfig(dataset='m-eurosat', embedding_batch_size=128, num_workers=0, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm-bigearthnet': DownstreamTaskConfig(dataset='m-bigearthnet', embedding_batch_size=64, num_workers=4, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm-so2sat': DownstreamTaskConfig(dataset='m-so2sat', embedding_batch_size=128, num_workers=4, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm-brick-kiln': DownstreamTaskConfig(dataset='m-brick-kiln', embedding_batch_size=128, num_workers=4, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'mados': DownstreamTaskConfig(dataset='mados', embedding_batch_size=128, num_workers=8, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=False, input_modalities=[], probe_lr=0.1, patch_size=4, probe_batch_size=128, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sen1floods11': DownstreamTaskConfig(dataset='sen1floods11', embedding_batch_size=128, num_workers=8, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.1, patch_size=4, probe_batch_size=128, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sickle_sentinel1': DownstreamTaskConfig(dataset='sickle', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1'], probe_lr=0.1, patch_size=4, probe_batch_size=16, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sickle_landsat': DownstreamTaskConfig(dataset='sickle', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['landsat'], probe_lr=0.1, patch_size=4, probe_batch_size=16, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sickle_sentinel1_landsat': DownstreamTaskConfig(dataset='sickle', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1', 'landsat'], probe_lr=0.1, patch_size=4, probe_batch_size=16, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm_sa_crop_type': DownstreamTaskConfig(dataset='m-sa-crop-type', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.1, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm_cashew_plant': DownstreamTaskConfig(dataset='m-cashew-plant', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.1, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'pastis_sentinel2': DownstreamTaskConfig(dataset='pastis', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel2_l2a'], probe_lr=0.1, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=50, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'pastis_sentinel1': DownstreamTaskConfig(dataset='pastis', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1'], probe_lr=0.1, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=50, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'pastis_sentinel1_sentinel2': DownstreamTaskConfig(dataset='pastis', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1', 'sentinel2_l2a'], probe_lr=0.1, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=20, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'breizhcrops': DownstreamTaskConfig(dataset='breizhcrops', embedding_batch_size=128, num_workers=8, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.1, patch_size=1, probe_batch_size=128, epochs=50, eval_interval=Duration(value=50, unit='epochs'), eval_mode='linear_probe', probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP')}, enabled=True, eval_on_startup=True, cancel_after_first_eval=True), 'garbage_collector': GarbageCollectorCallback(gc_interval=1, enabled=True, _start_state=None), 'beaker': BeakerCallback(experiment_id=None, update_interval=None, description=None, enabled=None, _last_update=None), 'checkpointer': CheckpointerCallback(save_interval=5000, ephemeral_save_interval=250, pre_train_checkpoint=None, save_async=None, remove='ephemeral_only', enabled=True, _latest_checkpoint_step=-1, _latest_checkpoint_path='', _checkpoints=[], _ephemeral_checkpoints=[], _checkpoints_to_remove=[])}, async_bookkeeping=None, no_checkpoints=False, no_evals=False), visualize=HeliosVisualizeConfig(output_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.1/visualizations', num_samples=None, global_step=None, std_multiplier=2.0), init_seed=12536)
2025-08-17 13:31:07.359	saturn-cs-aus-233.reviz.ai2.in:0	helios.internal.experiment:210	INFO	Launching the experiment
2025-08-17 13:31:07.359	saturn-cs-aus-233.reviz.ai2.in:0	helios.internal.experiment:211	INFO	HeliosExperimentConfig(run_name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.1', launch=HeliosBeakerLaunchConfig(name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.1-train-cba97838', cmd=['scripts/2025_07_21_add_era5/eval.py', 'train', 'latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.1', 'ai2/saturn-cirrascale', '--launch.priority=high', '--trainer.callbacks.downstream_evaluator.tasks.m-cashew-plant.probe_lr=0.1', '--trainer.callbacks.downstream_evaluator.tasks.mados.probe_lr=0.1', '--trainer.callbacks.downstream_evaluator.tasks.sen1floods11.probe_lr=0.1', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel2.probe_lr=0.1', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1.probe_lr=0.1', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1_sentinel2.probe_lr=0.1', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1.probe_lr=0.1', '--trainer.callbacks.downstream_evaluator.tasks.sickle_landsat.probe_lr=0.1', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1_landsat.probe_lr=0.1', '--trainer.callbacks.downstream_evaluator.tasks.breizhcrops.probe_lr=0.1', '--trainer.load_path=/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets/step200000', '--launch.task_name=eval'], budget='ai2/es-platform', task_name='eval', workspace='ai2/earth-systems', description=None, setup_steps=['echo "$GCP_CREDENTIALS" > $GOOGLE_APPLICATION_CREDENTIALS', 'conda install gh --channel conda-forge', 'gh auth status', 'gh repo clone $REPO_URL .', 'git checkout "$GIT_REF"', 'git submodule update --init --recursive', 'conda shell.bash activate base', "pip install -e '.[all]'", '', 'pip freeze'], beaker_image='petew/olmo-core-tch270cu128', num_nodes=1, num_gpus=1, shared_memory='256GiB', clusters=['ai2/saturn-cirrascale'], shared_filesystem=True, priority=<Priority.high: 'high'>, preemptible=True, retries=None, env_vars=[BeakerEnvVar(name='NCCL_DEBUG', value='WARN'), BeakerEnvVar(name='TORCH_NCCL_TRACE_BUFFER_SIZE', value='0'), BeakerEnvVar(name='NCCL_BLOCKING_WAIT', value='0'), BeakerEnvVar(name='GOOGLE_APPLICATION_CREDENTIALS', value='/etc/gcp_credentials.json')], env_secrets=[BeakerEnvSecret(name='BEAKER_TOKEN', secret='yawenzzzz_BEAKER_TOKEN'), BeakerEnvSecret(name='WANDB_API_KEY', secret='yawenzzzz_WANDB_API_KEY'), BeakerEnvSecret(name='GITHUB_TOKEN', secret='yawenzzzz_GITHUB_TOKEN'), BeakerEnvSecret(name='GCP_CREDENTIALS', secret='HELIOS_GCP_CREDENTIALS')], nfs=False, weka_buckets=[BeakerWekaBucket(bucket='dfive-default', mount='/weka/dfive-default')], allow_dirty=False, host_networking=None, git=GitConfig(repo_url='https://github.com/allenai/helios', ref='ad34f8d9cc3af2794e41b5c6cdddefdba216e57d', branch=None), hostnames=None), model=LatentMIMConfig(encoder_config=EncoderConfig(supported_modality_names=['sentinel2_l2a', 'sentinel1', 'landsat'], embedding_size=768, max_patch_size=8, min_patch_size=1, num_heads=12, mlp_ratio=4.0, depth=12, drop_path=0.1, max_sequence_length=12, learnable_channel_embeddings=True, random_channel_embeddings=False, num_projection_layers=1, aggregate_then_project=True, use_flash_attn=False, frozen_patch_embeddings=False, qk_norm=False), decoder_config=PredictorConfig(supported_modality_names=['sentinel2_l2a', 'sentinel1', 'landsat'], encoder_embedding_size=768, decoder_embedding_size=768, depth=4, mlp_ratio=4.0, num_heads=12, max_sequence_length=12, drop_path=0.0, learnable_channel_embeddings=True, random_channel_embeddings=False, output_embedding_size=None, use_flash_attn=False, qk_norm=False), reconstructor_config=None), dataset=HeliosConcatDatasetConfig(dataset_configs=[HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/presto/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/469728', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/osm_sampling/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/1138828', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/osmbig/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/1291656', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/presto_neighbor/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/3507008', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/worldcover_sampling/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/5662848', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0)]), data_loader=HeliosDataLoaderConfig(work_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.1', global_batch_size=512, min_patch_size=1, max_patch_size=8, sampled_hw_p_list=[5, 6, 7, 8, 9, 10, 11, 12], seed=3622, token_budget=1500, shuffle=True, num_workers=16, prefetch_factor=4, target_device_type=None, drop_last=True, num_dataset_repeats_per_epoch=1), train_module=ContrastiveLatentMIMTrainModuleConfig(optim_config=AdamWConfig(group_overrides=None, compile=False, fixed_fields=['initial_lr'], lr=0.0001, betas=[0.9, 0.999], eps=1e-08, weight_decay=0.02, foreach=None, fused=True), rank_microbatch_size=64, transform_config=TransformConfig(transform_type='flip_and_rotate', transform_kwargs={}), compile_model=False, dp_config=DataParallelConfig(name='fsdp', param_dtype='bfloat16', reduce_dtype='float32', num_replicas=None, shard_degree=None), compile_loss=False, autocast_precision=None, max_grad_norm=1.0, scheduler=CosWithWarmup(lr_field='lr', initial_lr_field='initial_lr', warmup_steps=8000, warmup_fraction=None, alpha_f=0.1, t_max=None, warmup_min_lr=0.0), find_unused_parameters=True, state_dict_save_opts=None, state_dict_load_opts=None, regularizer_config=None, loss_config=LossConfig(loss_config={'type': 'modality_patch_discrimination_new', 'tau': 0.1}), mae_loss_config=None, masking_config=MaskingConfig(strategy_config={'type': 'modality_cross_random', 'encode_ratio': 0.5, 'decode_ratio': 0.5, 'allow_encoding_decoding_same_bandset': True}), token_exit_cfg={'sentinel2_l2a': 0, 'sentinel1': 0, 'landsat': 0}, ema_decay=[1.0, 1.0], contrastive_config=LossConfig(loss_config={'type': 'InfoNCE', 'weight': 0.1})), trainer=TrainerConfig(save_folder='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.1', work_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.1', load_path='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets/step200000', load_strategy='if_available', checkpointer=CheckpointerConfig(work_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.1', save_overwrite=None, pre_download=False, save_thread_count=None, load_thread_count=None, throttle_uploads=False), device=None, save_overwrite=False, max_duration=Duration(value=300, unit='epochs'), cancel_check_interval=1, hard_stop=None, metrics_collect_interval=10, callbacks={'wandb': HeliosWandBCallback(enabled=True, name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.1', project='2025_08_17_contrastive_eval', entity='eai-ai2', group=None, tags=None, notes=None, config=None, cancel_tags=['cancel', 'canceled', 'cancelled'], cancel_check_interval=None, upload_dataset_distribution_pre_train=True, upload_modality_data_band_distribution_pre_train=False, restart_on_same_run=True), 'speed_monitor': HeliosSpeedMonitorCallback(num_flops_per_token=None, device_peak_flops=None, _total_steps=0, _total_tokens=0, _start_time=0.0, _first_step=True, _step_last_logged=0.0, _batch_load_start=0.0, _batch_load_time=0.0, _step_tokens=0, _step_seq_len=0, _parallel_degree=1, _bps_avg=None), 'gpu_memory_monitor': GPUMemoryMonitorCallback(device_id=None, _num_alloc_retries=0), 'config_saver': ConfigSaverCallback(config=None, fname='config.json', save_data_paths=None, data_paths_fname=None), 'downstream_evaluator': DownstreamEvaluatorCallbackConfig(tasks={'m-eurosat': DownstreamTaskConfig(dataset='m-eurosat', embedding_batch_size=128, num_workers=0, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm-bigearthnet': DownstreamTaskConfig(dataset='m-bigearthnet', embedding_batch_size=64, num_workers=4, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm-so2sat': DownstreamTaskConfig(dataset='m-so2sat', embedding_batch_size=128, num_workers=4, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm-brick-kiln': DownstreamTaskConfig(dataset='m-brick-kiln', embedding_batch_size=128, num_workers=4, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'mados': DownstreamTaskConfig(dataset='mados', embedding_batch_size=128, num_workers=8, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=False, input_modalities=[], probe_lr=0.1, patch_size=4, probe_batch_size=128, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sen1floods11': DownstreamTaskConfig(dataset='sen1floods11', embedding_batch_size=128, num_workers=8, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.1, patch_size=4, probe_batch_size=128, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sickle_sentinel1': DownstreamTaskConfig(dataset='sickle', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1'], probe_lr=0.1, patch_size=4, probe_batch_size=16, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sickle_landsat': DownstreamTaskConfig(dataset='sickle', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['landsat'], probe_lr=0.1, patch_size=4, probe_batch_size=16, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sickle_sentinel1_landsat': DownstreamTaskConfig(dataset='sickle', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1', 'landsat'], probe_lr=0.1, patch_size=4, probe_batch_size=16, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm_sa_crop_type': DownstreamTaskConfig(dataset='m-sa-crop-type', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.1, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm_cashew_plant': DownstreamTaskConfig(dataset='m-cashew-plant', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.1, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'pastis_sentinel2': DownstreamTaskConfig(dataset='pastis', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel2_l2a'], probe_lr=0.1, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=50, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'pastis_sentinel1': DownstreamTaskConfig(dataset='pastis', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1'], probe_lr=0.1, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=50, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'pastis_sentinel1_sentinel2': DownstreamTaskConfig(dataset='pastis', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1', 'sentinel2_l2a'], probe_lr=0.1, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=20, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'breizhcrops': DownstreamTaskConfig(dataset='breizhcrops', embedding_batch_size=128, num_workers=8, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.1, patch_size=1, probe_batch_size=128, epochs=50, eval_interval=Duration(value=50, unit='epochs'), eval_mode='linear_probe', probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP')}, enabled=True, eval_on_startup=True, cancel_after_first_eval=True), 'garbage_collector': GarbageCollectorCallback(gc_interval=1, enabled=True, _start_state=None), 'beaker': BeakerCallback(experiment_id=None, update_interval=None, description=None, enabled=None, _last_update=None), 'checkpointer': CheckpointerCallback(save_interval=5000, ephemeral_save_interval=250, pre_train_checkpoint=None, save_async=None, remove='ephemeral_only', enabled=True, _latest_checkpoint_step=-1, _latest_checkpoint_path='', _checkpoints=[], _ephemeral_checkpoints=[], _checkpoints_to_remove=[])}, async_bookkeeping=None, no_checkpoints=False, no_evals=False), visualize=HeliosVisualizeConfig(output_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.1/visualizations', num_samples=None, global_step=None, std_multiplier=2.0), init_seed=12536)
2025-08-17 13:31:08.312	saturn-cs-aus-233.reviz.ai2.in:0	py.warnings:109	WARNING	/weka/dfive-default/yawenz/.venv-helios-py310/lib/python3.10/site-packages/beaker/util.py:25: RuntimeWarning: Found unknown field 'budget: 01HPM52AQC6C0TZV32E7WDDGDJ' for data model 'Workspace'. This may be a newly added field that hasn't been defined in beaker-py yet. Please submit an issue report about this here:
https://github.com/allenai/beaker-py/issues/new?assignees=&labels=bug&template=bug_report.yml
  warnings.warn(

2025-08-17 13:31:12.338	saturn-cs-aus-233.reviz.ai2.in:0	olmo_core.launch.beaker:513	INFO	Experiment submitted, see progress at https://beaker.org/ex/01K2WVN7J7DQ6V9K0A6307XDJ3
2025-08-17 13:31:23.276	saturn-cs-aus-233.reviz.ai2.in:0	olmo_core.utils:200	INFO	Setting env var 'OMP_NUM_THREADS' to '8'
2025-08-17 13:31:23.276	saturn-cs-aus-233.reviz.ai2.in:0	olmo_core.utils:200	INFO	Setting env var 'TOKENIZERS_PARALLELISM' to 'false'
2025-08-17 13:31:23.276	saturn-cs-aus-233.reviz.ai2.in:0	helios.internal.experiment:135	INFO	Common overrides: []
2025-08-17 13:31:23.294	saturn-cs-aus-233.reviz.ai2.in:0	helios.internal.experiment:137	INFO	Common: CommonComponents(run_name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.5', save_folder='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.5', launch=HeliosBeakerLaunchConfig(name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.5-train-d921376b', cmd=['scripts/2025_07_21_add_era5/eval.py', 'train', 'latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.5', 'ai2/saturn-cirrascale', '--launch.priority=high', '--trainer.callbacks.downstream_evaluator.tasks.m-cashew-plant.probe_lr=0.5', '--trainer.callbacks.downstream_evaluator.tasks.mados.probe_lr=0.5', '--trainer.callbacks.downstream_evaluator.tasks.sen1floods11.probe_lr=0.5', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel2.probe_lr=0.5', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1.probe_lr=0.5', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1_sentinel2.probe_lr=0.5', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1.probe_lr=0.5', '--trainer.callbacks.downstream_evaluator.tasks.sickle_landsat.probe_lr=0.5', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1_landsat.probe_lr=0.5', '--trainer.callbacks.downstream_evaluator.tasks.breizhcrops.probe_lr=0.5', '--trainer.load_path=/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets/step200000', '--launch.task_name=eval'], budget='ai2/es-platform', task_name='train', workspace='ai2/earth-systems', description=None, setup_steps=['echo "$GCP_CREDENTIALS" > $GOOGLE_APPLICATION_CREDENTIALS', 'conda install gh --channel conda-forge', 'gh auth status', 'gh repo clone $REPO_URL .', 'git checkout "$GIT_REF"', 'git submodule update --init --recursive', 'conda shell.bash activate base', "pip install -e '.[all]'", '', 'pip freeze'], beaker_image='petew/olmo-core-tch270cu128', num_nodes=1, num_gpus=1, shared_memory='256GiB', clusters=['ai2/saturn-cirrascale'], shared_filesystem=True, priority=<Priority.high: 'high'>, preemptible=True, retries=None, env_vars=[BeakerEnvVar(name='NCCL_DEBUG', value='WARN'), BeakerEnvVar(name='TORCH_NCCL_TRACE_BUFFER_SIZE', value='0'), BeakerEnvVar(name='NCCL_BLOCKING_WAIT', value='0'), BeakerEnvVar(name='GOOGLE_APPLICATION_CREDENTIALS', value='/etc/gcp_credentials.json')], env_secrets=[BeakerEnvSecret(name='BEAKER_TOKEN', secret='yawenzzzz_BEAKER_TOKEN'), BeakerEnvSecret(name='WANDB_API_KEY', secret='yawenzzzz_WANDB_API_KEY'), BeakerEnvSecret(name='GITHUB_TOKEN', secret='yawenzzzz_GITHUB_TOKEN'), BeakerEnvSecret(name='GCP_CREDENTIALS', secret='HELIOS_GCP_CREDENTIALS')], nfs=False, weka_buckets=[BeakerWekaBucket(bucket='dfive-default', mount='/weka/dfive-default')], allow_dirty=False, host_networking=None, git=GitConfig(repo_url='https://github.com/allenai/helios', ref='ad34f8d9cc3af2794e41b5c6cdddefdba216e57d', branch=None), hostnames=None), training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dataset_percentage=1.0, nccl_debug=False)
2025-08-17 13:31:23.300	saturn-cs-aus-233.reviz.ai2.in:0	helios.internal.experiment:156	INFO	Overrides: ['--launch.priority=high', '--trainer.callbacks.downstream_evaluator.tasks.m-cashew-plant.probe_lr=0.5', '--trainer.callbacks.downstream_evaluator.tasks.mados.probe_lr=0.5', '--trainer.callbacks.downstream_evaluator.tasks.sen1floods11.probe_lr=0.5', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel2.probe_lr=0.5', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1.probe_lr=0.5', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1_sentinel2.probe_lr=0.5', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1.probe_lr=0.5', '--trainer.callbacks.downstream_evaluator.tasks.sickle_landsat.probe_lr=0.5', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1_landsat.probe_lr=0.5', '--trainer.callbacks.downstream_evaluator.tasks.breizhcrops.probe_lr=0.5', '--trainer.load_path=/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets/step200000', '--launch.task_name=eval']
HeliosExperimentConfig(run_name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.5', launch=HeliosBeakerLaunchConfig(name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.5-train-d921376b', cmd=['scripts/2025_07_21_add_era5/eval.py', 'train', 'latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.5', 'ai2/saturn-cirrascale', '--launch.priority=high', '--trainer.callbacks.downstream_evaluator.tasks.m-cashew-plant.probe_lr=0.5', '--trainer.callbacks.downstream_evaluator.tasks.mados.probe_lr=0.5', '--trainer.callbacks.downstream_evaluator.tasks.sen1floods11.probe_lr=0.5', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel2.probe_lr=0.5', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1.probe_lr=0.5', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1_sentinel2.probe_lr=0.5', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1.probe_lr=0.5', '--trainer.callbacks.downstream_evaluator.tasks.sickle_landsat.probe_lr=0.5', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1_landsat.probe_lr=0.5', '--trainer.callbacks.downstream_evaluator.tasks.breizhcrops.probe_lr=0.5', '--trainer.load_path=/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets/step200000', '--launch.task_name=eval'], budget='ai2/es-platform', task_name='eval', workspace='ai2/earth-systems', description=None, setup_steps=['echo "$GCP_CREDENTIALS" > $GOOGLE_APPLICATION_CREDENTIALS', 'conda install gh --channel conda-forge', 'gh auth status', 'gh repo clone $REPO_URL .', 'git checkout "$GIT_REF"', 'git submodule update --init --recursive', 'conda shell.bash activate base', "pip install -e '.[all]'", '', 'pip freeze'], beaker_image='petew/olmo-core-tch270cu128', num_nodes=1, num_gpus=1, shared_memory='256GiB', clusters=['ai2/saturn-cirrascale'], shared_filesystem=True, priority=<Priority.high: 'high'>, preemptible=True, retries=None, env_vars=[BeakerEnvVar(name='NCCL_DEBUG', value='WARN'), BeakerEnvVar(name='TORCH_NCCL_TRACE_BUFFER_SIZE', value='0'), BeakerEnvVar(name='NCCL_BLOCKING_WAIT', value='0'), BeakerEnvVar(name='GOOGLE_APPLICATION_CREDENTIALS', value='/etc/gcp_credentials.json')], env_secrets=[BeakerEnvSecret(name='BEAKER_TOKEN', secret='yawenzzzz_BEAKER_TOKEN'), BeakerEnvSecret(name='WANDB_API_KEY', secret='yawenzzzz_WANDB_API_KEY'), BeakerEnvSecret(name='GITHUB_TOKEN', secret='yawenzzzz_GITHUB_TOKEN'), BeakerEnvSecret(name='GCP_CREDENTIALS', secret='HELIOS_GCP_CREDENTIALS')], nfs=False, weka_buckets=[BeakerWekaBucket(bucket='dfive-default', mount='/weka/dfive-default')], allow_dirty=False, host_networking=None, git=GitConfig(repo_url='https://github.com/allenai/helios', ref='ad34f8d9cc3af2794e41b5c6cdddefdba216e57d', branch=None), hostnames=None), model=LatentMIMConfig(encoder_config=EncoderConfig(supported_modality_names=['sentinel2_l2a', 'sentinel1', 'landsat'], embedding_size=768, max_patch_size=8, min_patch_size=1, num_heads=12, mlp_ratio=4.0, depth=12, drop_path=0.1, max_sequence_length=12, learnable_channel_embeddings=True, random_channel_embeddings=False, num_projection_layers=1, aggregate_then_project=True, use_flash_attn=False, frozen_patch_embeddings=False, qk_norm=False), decoder_config=PredictorConfig(supported_modality_names=['sentinel2_l2a', 'sentinel1', 'landsat'], encoder_embedding_size=768, decoder_embedding_size=768, depth=4, mlp_ratio=4.0, num_heads=12, max_sequence_length=12, drop_path=0.0, learnable_channel_embeddings=True, random_channel_embeddings=False, output_embedding_size=None, use_flash_attn=False, qk_norm=False), reconstructor_config=None), dataset=HeliosConcatDatasetConfig(dataset_configs=[HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/presto/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/469728', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/osm_sampling/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/1138828', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/osmbig/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/1291656', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/presto_neighbor/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/3507008', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/worldcover_sampling/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/5662848', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0)]), data_loader=HeliosDataLoaderConfig(work_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.5', global_batch_size=512, min_patch_size=1, max_patch_size=8, sampled_hw_p_list=[5, 6, 7, 8, 9, 10, 11, 12], seed=3622, token_budget=1500, shuffle=True, num_workers=16, prefetch_factor=4, target_device_type=None, drop_last=True, num_dataset_repeats_per_epoch=1), train_module=ContrastiveLatentMIMTrainModuleConfig(optim_config=AdamWConfig(group_overrides=None, compile=False, fixed_fields=['initial_lr'], lr=0.0001, betas=[0.9, 0.999], eps=1e-08, weight_decay=0.02, foreach=None, fused=True), rank_microbatch_size=64, transform_config=TransformConfig(transform_type='flip_and_rotate', transform_kwargs={}), compile_model=False, dp_config=DataParallelConfig(name='fsdp', param_dtype='bfloat16', reduce_dtype='float32', num_replicas=None, shard_degree=None), compile_loss=False, autocast_precision=None, max_grad_norm=1.0, scheduler=CosWithWarmup(lr_field='lr', initial_lr_field='initial_lr', warmup_steps=8000, warmup_fraction=None, alpha_f=0.1, t_max=None, warmup_min_lr=0.0), find_unused_parameters=True, state_dict_save_opts=None, state_dict_load_opts=None, regularizer_config=None, loss_config=LossConfig(loss_config={'type': 'modality_patch_discrimination_new', 'tau': 0.1}), mae_loss_config=None, masking_config=MaskingConfig(strategy_config={'type': 'modality_cross_random', 'encode_ratio': 0.5, 'decode_ratio': 0.5, 'allow_encoding_decoding_same_bandset': True}), token_exit_cfg={'sentinel2_l2a': 0, 'sentinel1': 0, 'landsat': 0}, ema_decay=[1.0, 1.0], contrastive_config=LossConfig(loss_config={'type': 'InfoNCE', 'weight': 0.1})), trainer=TrainerConfig(save_folder='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.5', work_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.5', load_path='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets/step200000', load_strategy='if_available', checkpointer=CheckpointerConfig(work_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.5', save_overwrite=None, pre_download=False, save_thread_count=None, load_thread_count=None, throttle_uploads=False), device=None, save_overwrite=False, max_duration=Duration(value=300, unit='epochs'), cancel_check_interval=1, hard_stop=None, metrics_collect_interval=10, callbacks={'wandb': HeliosWandBCallback(enabled=True, name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.5', project='2025_08_17_contrastive_eval', entity='eai-ai2', group=None, tags=None, notes=None, config=None, cancel_tags=['cancel', 'canceled', 'cancelled'], cancel_check_interval=None, upload_dataset_distribution_pre_train=True, upload_modality_data_band_distribution_pre_train=False, restart_on_same_run=True), 'speed_monitor': HeliosSpeedMonitorCallback(num_flops_per_token=None, device_peak_flops=None, _total_steps=0, _total_tokens=0, _start_time=0.0, _first_step=True, _step_last_logged=0.0, _batch_load_start=0.0, _batch_load_time=0.0, _step_tokens=0, _step_seq_len=0, _parallel_degree=1, _bps_avg=None), 'gpu_memory_monitor': GPUMemoryMonitorCallback(device_id=None, _num_alloc_retries=0), 'config_saver': ConfigSaverCallback(config=None, fname='config.json', save_data_paths=None, data_paths_fname=None), 'downstream_evaluator': DownstreamEvaluatorCallbackConfig(tasks={'m-eurosat': DownstreamTaskConfig(dataset='m-eurosat', embedding_batch_size=128, num_workers=0, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm-bigearthnet': DownstreamTaskConfig(dataset='m-bigearthnet', embedding_batch_size=64, num_workers=4, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm-so2sat': DownstreamTaskConfig(dataset='m-so2sat', embedding_batch_size=128, num_workers=4, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm-brick-kiln': DownstreamTaskConfig(dataset='m-brick-kiln', embedding_batch_size=128, num_workers=4, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'mados': DownstreamTaskConfig(dataset='mados', embedding_batch_size=128, num_workers=8, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=False, input_modalities=[], probe_lr=0.5, patch_size=4, probe_batch_size=128, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sen1floods11': DownstreamTaskConfig(dataset='sen1floods11', embedding_batch_size=128, num_workers=8, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.5, patch_size=4, probe_batch_size=128, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sickle_sentinel1': DownstreamTaskConfig(dataset='sickle', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1'], probe_lr=0.5, patch_size=4, probe_batch_size=16, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sickle_landsat': DownstreamTaskConfig(dataset='sickle', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['landsat'], probe_lr=0.5, patch_size=4, probe_batch_size=16, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sickle_sentinel1_landsat': DownstreamTaskConfig(dataset='sickle', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1', 'landsat'], probe_lr=0.5, patch_size=4, probe_batch_size=16, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm_sa_crop_type': DownstreamTaskConfig(dataset='m-sa-crop-type', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.1, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm_cashew_plant': DownstreamTaskConfig(dataset='m-cashew-plant', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.5, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'pastis_sentinel2': DownstreamTaskConfig(dataset='pastis', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel2_l2a'], probe_lr=0.5, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=50, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'pastis_sentinel1': DownstreamTaskConfig(dataset='pastis', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1'], probe_lr=0.5, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=50, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'pastis_sentinel1_sentinel2': DownstreamTaskConfig(dataset='pastis', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1', 'sentinel2_l2a'], probe_lr=0.5, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=20, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'breizhcrops': DownstreamTaskConfig(dataset='breizhcrops', embedding_batch_size=128, num_workers=8, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.5, patch_size=1, probe_batch_size=128, epochs=50, eval_interval=Duration(value=50, unit='epochs'), eval_mode='linear_probe', probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP')}, enabled=True, eval_on_startup=True, cancel_after_first_eval=True), 'garbage_collector': GarbageCollectorCallback(gc_interval=1, enabled=True, _start_state=None), 'beaker': BeakerCallback(experiment_id=None, update_interval=None, description=None, enabled=None, _last_update=None), 'checkpointer': CheckpointerCallback(save_interval=5000, ephemeral_save_interval=250, pre_train_checkpoint=None, save_async=None, remove='ephemeral_only', enabled=True, _latest_checkpoint_step=-1, _latest_checkpoint_path='', _checkpoints=[], _ephemeral_checkpoints=[], _checkpoints_to_remove=[])}, async_bookkeeping=None, no_checkpoints=False, no_evals=False), visualize=HeliosVisualizeConfig(output_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.5/visualizations', num_samples=None, global_step=None, std_multiplier=2.0), init_seed=12536)
2025-08-17 13:31:23.438	saturn-cs-aus-233.reviz.ai2.in:0	helios.internal.experiment:210	INFO	Launching the experiment
2025-08-17 13:31:23.438	saturn-cs-aus-233.reviz.ai2.in:0	helios.internal.experiment:211	INFO	HeliosExperimentConfig(run_name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.5', launch=HeliosBeakerLaunchConfig(name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.5-train-d921376b', cmd=['scripts/2025_07_21_add_era5/eval.py', 'train', 'latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.5', 'ai2/saturn-cirrascale', '--launch.priority=high', '--trainer.callbacks.downstream_evaluator.tasks.m-cashew-plant.probe_lr=0.5', '--trainer.callbacks.downstream_evaluator.tasks.mados.probe_lr=0.5', '--trainer.callbacks.downstream_evaluator.tasks.sen1floods11.probe_lr=0.5', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel2.probe_lr=0.5', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1.probe_lr=0.5', '--trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1_sentinel2.probe_lr=0.5', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1.probe_lr=0.5', '--trainer.callbacks.downstream_evaluator.tasks.sickle_landsat.probe_lr=0.5', '--trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1_landsat.probe_lr=0.5', '--trainer.callbacks.downstream_evaluator.tasks.breizhcrops.probe_lr=0.5', '--trainer.load_path=/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets/step200000', '--launch.task_name=eval'], budget='ai2/es-platform', task_name='eval', workspace='ai2/earth-systems', description=None, setup_steps=['echo "$GCP_CREDENTIALS" > $GOOGLE_APPLICATION_CREDENTIALS', 'conda install gh --channel conda-forge', 'gh auth status', 'gh repo clone $REPO_URL .', 'git checkout "$GIT_REF"', 'git submodule update --init --recursive', 'conda shell.bash activate base', "pip install -e '.[all]'", '', 'pip freeze'], beaker_image='petew/olmo-core-tch270cu128', num_nodes=1, num_gpus=1, shared_memory='256GiB', clusters=['ai2/saturn-cirrascale'], shared_filesystem=True, priority=<Priority.high: 'high'>, preemptible=True, retries=None, env_vars=[BeakerEnvVar(name='NCCL_DEBUG', value='WARN'), BeakerEnvVar(name='TORCH_NCCL_TRACE_BUFFER_SIZE', value='0'), BeakerEnvVar(name='NCCL_BLOCKING_WAIT', value='0'), BeakerEnvVar(name='GOOGLE_APPLICATION_CREDENTIALS', value='/etc/gcp_credentials.json')], env_secrets=[BeakerEnvSecret(name='BEAKER_TOKEN', secret='yawenzzzz_BEAKER_TOKEN'), BeakerEnvSecret(name='WANDB_API_KEY', secret='yawenzzzz_WANDB_API_KEY'), BeakerEnvSecret(name='GITHUB_TOKEN', secret='yawenzzzz_GITHUB_TOKEN'), BeakerEnvSecret(name='GCP_CREDENTIALS', secret='HELIOS_GCP_CREDENTIALS')], nfs=False, weka_buckets=[BeakerWekaBucket(bucket='dfive-default', mount='/weka/dfive-default')], allow_dirty=False, host_networking=None, git=GitConfig(repo_url='https://github.com/allenai/helios', ref='ad34f8d9cc3af2794e41b5c6cdddefdba216e57d', branch=None), hostnames=None), model=LatentMIMConfig(encoder_config=EncoderConfig(supported_modality_names=['sentinel2_l2a', 'sentinel1', 'landsat'], embedding_size=768, max_patch_size=8, min_patch_size=1, num_heads=12, mlp_ratio=4.0, depth=12, drop_path=0.1, max_sequence_length=12, learnable_channel_embeddings=True, random_channel_embeddings=False, num_projection_layers=1, aggregate_then_project=True, use_flash_attn=False, frozen_patch_embeddings=False, qk_norm=False), decoder_config=PredictorConfig(supported_modality_names=['sentinel2_l2a', 'sentinel1', 'landsat'], encoder_embedding_size=768, decoder_embedding_size=768, depth=4, mlp_ratio=4.0, num_heads=12, max_sequence_length=12, drop_path=0.0, learnable_channel_embeddings=True, random_channel_embeddings=False, output_embedding_size=None, use_flash_attn=False, qk_norm=False), reconstructor_config=None), dataset=HeliosConcatDatasetConfig(dataset_configs=[HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/presto/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/469728', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/osm_sampling/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/1138828', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/osmbig/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/1291656', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/presto_neighbor/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/3507008', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0), HeliosDatasetConfig(h5py_dir='/weka/dfive-default/helios/dataset/worldcover_sampling/h5py_data_w_missing_timesteps_zstd_3_128_x_4/era5_10_landsat_naip_10_openstreetmap_raster_sentinel1_sentinel2_l2a_srtm_worldcover/5662848', training_modalities=['sentinel2_l2a', 'sentinel1', 'landsat'], dtype='float32', normalize=True, cache_dir=None, samples_per_sec=None, dataset_percentage=1.0)]), data_loader=HeliosDataLoaderConfig(work_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.5', global_batch_size=512, min_patch_size=1, max_patch_size=8, sampled_hw_p_list=[5, 6, 7, 8, 9, 10, 11, 12], seed=3622, token_budget=1500, shuffle=True, num_workers=16, prefetch_factor=4, target_device_type=None, drop_last=True, num_dataset_repeats_per_epoch=1), train_module=ContrastiveLatentMIMTrainModuleConfig(optim_config=AdamWConfig(group_overrides=None, compile=False, fixed_fields=['initial_lr'], lr=0.0001, betas=[0.9, 0.999], eps=1e-08, weight_decay=0.02, foreach=None, fused=True), rank_microbatch_size=64, transform_config=TransformConfig(transform_type='flip_and_rotate', transform_kwargs={}), compile_model=False, dp_config=DataParallelConfig(name='fsdp', param_dtype='bfloat16', reduce_dtype='float32', num_replicas=None, shard_degree=None), compile_loss=False, autocast_precision=None, max_grad_norm=1.0, scheduler=CosWithWarmup(lr_field='lr', initial_lr_field='initial_lr', warmup_steps=8000, warmup_fraction=None, alpha_f=0.1, t_max=None, warmup_min_lr=0.0), find_unused_parameters=True, state_dict_save_opts=None, state_dict_load_opts=None, regularizer_config=None, loss_config=LossConfig(loss_config={'type': 'modality_patch_discrimination_new', 'tau': 0.1}), mae_loss_config=None, masking_config=MaskingConfig(strategy_config={'type': 'modality_cross_random', 'encode_ratio': 0.5, 'decode_ratio': 0.5, 'allow_encoding_decoding_same_bandset': True}), token_exit_cfg={'sentinel2_l2a': 0, 'sentinel1': 0, 'landsat': 0}, ema_decay=[1.0, 1.0], contrastive_config=LossConfig(loss_config={'type': 'InfoNCE', 'weight': 0.1})), trainer=TrainerConfig(save_folder='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.5', work_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.5', load_path='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets/step200000', load_strategy='if_available', checkpointer=CheckpointerConfig(work_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.5', save_overwrite=None, pre_download=False, save_thread_count=None, load_thread_count=None, throttle_uploads=False), device=None, save_overwrite=False, max_duration=Duration(value=300, unit='epochs'), cancel_check_interval=1, hard_stop=None, metrics_collect_interval=10, callbacks={'wandb': HeliosWandBCallback(enabled=True, name='latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.5', project='2025_08_17_contrastive_eval', entity='eai-ai2', group=None, tags=None, notes=None, config=None, cancel_tags=['cancel', 'canceled', 'cancelled'], cancel_check_interval=None, upload_dataset_distribution_pre_train=True, upload_modality_data_band_distribution_pre_train=False, restart_on_same_run=True), 'speed_monitor': HeliosSpeedMonitorCallback(num_flops_per_token=None, device_peak_flops=None, _total_steps=0, _total_tokens=0, _start_time=0.0, _first_step=True, _step_last_logged=0.0, _batch_load_start=0.0, _batch_load_time=0.0, _step_tokens=0, _step_seq_len=0, _parallel_degree=1, _bps_avg=None), 'gpu_memory_monitor': GPUMemoryMonitorCallback(device_id=None, _num_alloc_retries=0), 'config_saver': ConfigSaverCallback(config=None, fname='config.json', save_data_paths=None, data_paths_fname=None), 'downstream_evaluator': DownstreamEvaluatorCallbackConfig(tasks={'m-eurosat': DownstreamTaskConfig(dataset='m-eurosat', embedding_batch_size=128, num_workers=0, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm-bigearthnet': DownstreamTaskConfig(dataset='m-bigearthnet', embedding_batch_size=64, num_workers=4, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm-so2sat': DownstreamTaskConfig(dataset='m-so2sat', embedding_batch_size=128, num_workers=4, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm-brick-kiln': DownstreamTaskConfig(dataset='m-brick-kiln', embedding_batch_size=128, num_workers=4, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=None, patch_size=4, probe_batch_size=32, epochs=50, eval_interval=Duration(value=5, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'mados': DownstreamTaskConfig(dataset='mados', embedding_batch_size=128, num_workers=8, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=False, input_modalities=[], probe_lr=0.5, patch_size=4, probe_batch_size=128, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sen1floods11': DownstreamTaskConfig(dataset='sen1floods11', embedding_batch_size=128, num_workers=8, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.5, patch_size=4, probe_batch_size=128, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sickle_sentinel1': DownstreamTaskConfig(dataset='sickle', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1'], probe_lr=0.5, patch_size=4, probe_batch_size=16, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sickle_landsat': DownstreamTaskConfig(dataset='sickle', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['landsat'], probe_lr=0.5, patch_size=4, probe_batch_size=16, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'sickle_sentinel1_landsat': DownstreamTaskConfig(dataset='sickle', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1', 'landsat'], probe_lr=0.5, patch_size=4, probe_batch_size=16, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm_sa_crop_type': DownstreamTaskConfig(dataset='m-sa-crop-type', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.1, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'm_cashew_plant': DownstreamTaskConfig(dataset='m-cashew-plant', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.5, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=10, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'pastis_sentinel2': DownstreamTaskConfig(dataset='pastis', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel2_l2a'], probe_lr=0.5, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=50, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'pastis_sentinel1': DownstreamTaskConfig(dataset='pastis', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1'], probe_lr=0.5, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=50, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'pastis_sentinel1_sentinel2': DownstreamTaskConfig(dataset='pastis', embedding_batch_size=32, num_workers=2, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=['sentinel1', 'sentinel2_l2a'], probe_lr=0.5, patch_size=4, probe_batch_size=8, epochs=50, eval_interval=Duration(value=20, unit='epochs'), eval_mode=None, probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP'), 'breizhcrops': DownstreamTaskConfig(dataset='breizhcrops', embedding_batch_size=128, num_workers=8, pooling_type=<PoolingType.MEAN: 'mean'>, norm_stats_from_pretrained=True, input_modalities=[], probe_lr=0.5, patch_size=1, probe_batch_size=128, epochs=50, eval_interval=Duration(value=50, unit='epochs'), eval_mode='linear_probe', probe_type=<ProbeType.LINEAR: 'linear'>, partition='default', norm_method='NormMethod.NORM_NO_CLIP')}, enabled=True, eval_on_startup=True, cancel_after_first_eval=True), 'garbage_collector': GarbageCollectorCallback(gc_interval=1, enabled=True, _start_state=None), 'beaker': BeakerCallback(experiment_id=None, update_interval=None, description=None, enabled=None, _last_update=None), 'checkpointer': CheckpointerCallback(save_interval=5000, ephemeral_save_interval=250, pre_train_checkpoint=None, save_async=None, remove='ephemeral_only', enabled=True, _latest_checkpoint_step=-1, _latest_checkpoint_path='', _checkpoints=[], _ephemeral_checkpoints=[], _checkpoints_to_remove=[])}, async_bookkeeping=None, no_checkpoints=False, no_evals=False), visualize=HeliosVisualizeConfig(output_dir='/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.5/visualizations', num_samples=None, global_step=None, std_multiplier=2.0), init_seed=12536)
2025-08-17 13:31:24.455	saturn-cs-aus-233.reviz.ai2.in:0	py.warnings:109	WARNING	/weka/dfive-default/yawenz/.venv-helios-py310/lib/python3.10/site-packages/beaker/util.py:25: RuntimeWarning: Found unknown field 'budget: 01HPM52AQC6C0TZV32E7WDDGDJ' for data model 'Workspace'. This may be a newly added field that hasn't been defined in beaker-py yet. Please submit an issue report about this here:
https://github.com/allenai/beaker-py/issues/new?assignees=&labels=bug&template=bug_report.yml
  warnings.warn(

2025-08-17 13:31:28.465	saturn-cs-aus-233.reviz.ai2.in:0	olmo_core.launch.beaker:513	INFO	Experiment submitted, see progress at https://beaker.org/ex/01K2WVNQBHY828VXAFWK1B8MB9
--trainer.callbacks.downstream_evaluator.tasks.m-cashew-plant.probe_lr=0.01 --trainer.callbacks.downstream_evaluator.tasks.mados.probe_lr=0.01 --trainer.callbacks.downstream_evaluator.tasks.sen1floods11.probe_lr=0.01 --trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel2.probe_lr=0.01 --trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1.probe_lr=0.01 --trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1_sentinel2.probe_lr=0.01 --trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1.probe_lr=0.01 --trainer.callbacks.downstream_evaluator.tasks.sickle_landsat.probe_lr=0.01 --trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1_landsat.probe_lr=0.01 --trainer.callbacks.downstream_evaluator.tasks.breizhcrops.probe_lr=0.01
python3 scripts/2025_07_21_add_era5/eval.py launch latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.01 ai2/saturn-cirrascale --launch.priority=high --trainer.callbacks.downstream_evaluator.tasks.m-cashew-plant.probe_lr=0.01 --trainer.callbacks.downstream_evaluator.tasks.mados.probe_lr=0.01 --trainer.callbacks.downstream_evaluator.tasks.sen1floods11.probe_lr=0.01 --trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel2.probe_lr=0.01 --trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1.probe_lr=0.01 --trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1_sentinel2.probe_lr=0.01 --trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1.probe_lr=0.01 --trainer.callbacks.downstream_evaluator.tasks.sickle_landsat.probe_lr=0.01 --trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1_landsat.probe_lr=0.01 --trainer.callbacks.downstream_evaluator.tasks.breizhcrops.probe_lr=0.01 --trainer.load_path=/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets/step200000 --launch.task_name=eval
--trainer.callbacks.downstream_evaluator.tasks.m-cashew-plant.probe_lr=0.05 --trainer.callbacks.downstream_evaluator.tasks.mados.probe_lr=0.05 --trainer.callbacks.downstream_evaluator.tasks.sen1floods11.probe_lr=0.05 --trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel2.probe_lr=0.05 --trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1.probe_lr=0.05 --trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1_sentinel2.probe_lr=0.05 --trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1.probe_lr=0.05 --trainer.callbacks.downstream_evaluator.tasks.sickle_landsat.probe_lr=0.05 --trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1_landsat.probe_lr=0.05 --trainer.callbacks.downstream_evaluator.tasks.breizhcrops.probe_lr=0.05
python3 scripts/2025_07_21_add_era5/eval.py launch latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.05 ai2/saturn-cirrascale --launch.priority=high --trainer.callbacks.downstream_evaluator.tasks.m-cashew-plant.probe_lr=0.05 --trainer.callbacks.downstream_evaluator.tasks.mados.probe_lr=0.05 --trainer.callbacks.downstream_evaluator.tasks.sen1floods11.probe_lr=0.05 --trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel2.probe_lr=0.05 --trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1.probe_lr=0.05 --trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1_sentinel2.probe_lr=0.05 --trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1.probe_lr=0.05 --trainer.callbacks.downstream_evaluator.tasks.sickle_landsat.probe_lr=0.05 --trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1_landsat.probe_lr=0.05 --trainer.callbacks.downstream_evaluator.tasks.breizhcrops.probe_lr=0.05 --trainer.load_path=/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets/step200000 --launch.task_name=eval
--trainer.callbacks.downstream_evaluator.tasks.m-cashew-plant.probe_lr=0.1 --trainer.callbacks.downstream_evaluator.tasks.mados.probe_lr=0.1 --trainer.callbacks.downstream_evaluator.tasks.sen1floods11.probe_lr=0.1 --trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel2.probe_lr=0.1 --trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1.probe_lr=0.1 --trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1_sentinel2.probe_lr=0.1 --trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1.probe_lr=0.1 --trainer.callbacks.downstream_evaluator.tasks.sickle_landsat.probe_lr=0.1 --trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1_landsat.probe_lr=0.1 --trainer.callbacks.downstream_evaluator.tasks.breizhcrops.probe_lr=0.1
python3 scripts/2025_07_21_add_era5/eval.py launch latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.1 ai2/saturn-cirrascale --launch.priority=high --trainer.callbacks.downstream_evaluator.tasks.m-cashew-plant.probe_lr=0.1 --trainer.callbacks.downstream_evaluator.tasks.mados.probe_lr=0.1 --trainer.callbacks.downstream_evaluator.tasks.sen1floods11.probe_lr=0.1 --trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel2.probe_lr=0.1 --trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1.probe_lr=0.1 --trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1_sentinel2.probe_lr=0.1 --trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1.probe_lr=0.1 --trainer.callbacks.downstream_evaluator.tasks.sickle_landsat.probe_lr=0.1 --trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1_landsat.probe_lr=0.1 --trainer.callbacks.downstream_evaluator.tasks.breizhcrops.probe_lr=0.1 --trainer.load_path=/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets/step200000 --launch.task_name=eval
--trainer.callbacks.downstream_evaluator.tasks.m-cashew-plant.probe_lr=0.5 --trainer.callbacks.downstream_evaluator.tasks.mados.probe_lr=0.5 --trainer.callbacks.downstream_evaluator.tasks.sen1floods11.probe_lr=0.5 --trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel2.probe_lr=0.5 --trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1.probe_lr=0.5 --trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1_sentinel2.probe_lr=0.5 --trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1.probe_lr=0.5 --trainer.callbacks.downstream_evaluator.tasks.sickle_landsat.probe_lr=0.5 --trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1_landsat.probe_lr=0.5 --trainer.callbacks.downstream_evaluator.tasks.breizhcrops.probe_lr=0.5
python3 scripts/2025_07_21_add_era5/eval.py launch latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets_eval_0.5 ai2/saturn-cirrascale --launch.priority=high --trainer.callbacks.downstream_evaluator.tasks.m-cashew-plant.probe_lr=0.5 --trainer.callbacks.downstream_evaluator.tasks.mados.probe_lr=0.5 --trainer.callbacks.downstream_evaluator.tasks.sen1floods11.probe_lr=0.5 --trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel2.probe_lr=0.5 --trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1.probe_lr=0.5 --trainer.callbacks.downstream_evaluator.tasks.pastis_sentinel1_sentinel2.probe_lr=0.5 --trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1.probe_lr=0.5 --trainer.callbacks.downstream_evaluator.tasks.sickle_landsat.probe_lr=0.5 --trainer.callbacks.downstream_evaluator.tasks.sickle_sentinel1_landsat.probe_lr=0.5 --trainer.callbacks.downstream_evaluator.tasks.breizhcrops.probe_lr=0.5 --trainer.load_path=/weka/dfive-default/helios/checkpoints/yawenzzzz/latent_mim_cross_random_per_modality_patchdisc_add_contrastive_0.1_all_datasets/step200000 --launch.task_name=eval
